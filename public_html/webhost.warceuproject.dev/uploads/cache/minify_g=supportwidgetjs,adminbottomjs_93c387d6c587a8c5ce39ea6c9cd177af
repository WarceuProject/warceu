/* Minify: at least one missing file. See http://code.google.com/p/minify/wiki/Debugging */

;;(function(window){var document=window.document,urlWithScheme=/^([a-zA-Z]+:)?\/\//,settings={url:null,tabId:"ask-us",tabText:"Support",tabColor:"#000000",tabImageURL:null,tabPosition:'Left',forceSuggestions:false,hide_tab:false,request_subject:null,request_description:null,requester_name:null,requester_email:null,ticketTypeId:0},tab,overlay,container,closeButton,iframe,scrim;function attempt(fn){try{return fn();}catch(e){if(window.console&&window.console.log&&window.console.log.apply){window.console.log("Feedback Error: ",e);}}}
function bindEvent(element,eventName,callback){if(element&&element.addEventListener){element.addEventListener(eventName,callback,false);}else if(element&&element.attachEvent){element.attachEvent('on'+eventName,callback);}}
function prependSchemeIfNecessary(url){if(url&&!(urlWithScheme.test(url))){return document.location.protocol+'//'+url;}else{return url;}}
function createElements(){tab=document.createElement('div');tab.setAttribute('id','feedback_tab');tab.setAttribute('href','#');tab.style.display='none';document.body.appendChild(tab);overlay=document.createElement('div');overlay.setAttribute('id','feedback_overlay');overlay.style.display='none';overlay.innerHTML='<div id="feedback_container">'+'  <div class="header" id="feedback_close"></div>'+'  <iframe id="feedback_body" frameborder="0" scrolling="auto" allowTransparency="true"></iframe>'+'</div>'+'<div id="feedback_scrim">&nbsp;</div>';document.body.appendChild(overlay);container=document.getElementById('feedback_container');closeButton=document.getElementById('feedback_close');iframe=document.getElementById('feedback_body');scrim=document.getElementById('feedback_scrim');bindEvent(tab,'click',function(){window.CESupportWidget.show();});bindEvent(closeButton,'click',function(){window.CESupportWidget.hide();});bindEvent(scrim,'click',function(){window.CESupportWidget.hide();});}
function configure(options){var prop;for(prop in options){if(options.hasOwnProperty(prop)){if(prop==='url'){settings[prop]=prependSchemeIfNecessary(options[prop]);}else{settings[prop]=options[prop];}}}}
function tabImageURL(){if(settings.tabImageURL){return settings.tabImageURL;}else{var url=settings.url+'/javascript/external/images/tab_'+settings.tabId;if(settings.tabPosition==='right'){url+='_right';}
url+='.png';return url;}}
function updateTabImage(){var url=tabImageURL();var arVersion=window.navigator&&window.navigator.appVersion.split("MSIE");var version=parseFloat(arVersion[1]);if((version>=5.5)&&(version<7)&&(document.body.filters)){tab.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+url+"', sizingMethod='crop')";}else{tab.style.backgroundImage='url('+url+')';}}
function updateTab(){if(settings.hide_tab){tab.style.display='none';}else{updateTabImage();tab.setAttribute('title',settings.tabText);tab.setAttribute('class','FeedbackTab'+settings.tabPosition);tab.setAttribute('className','FeedbackTab'+settings.tabPosition);tab.innerHTML=settings.tabText;tab.style.backgroundColor=settings.tabColor;tab.style.borderColor=settings.tabColor;tab.style.display='block';}}
function cancelEvent(e){var event=e||window.event||{};event.cancelBubble=true;event.returnValue=false;event.stopPropagation&&event.stopPropagation();event.preventDefault&&event.preventDefault();return false;}
function getDocHeight(){return Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight));}
function getScrollOffsets(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop};}
function loadingURL(){return settings.url+'/javascript/external/loading.html';}
function dropboxURL(){var url=settings.url+"/index.php?fuse=support&view=supportwidgetform&controller=index";if(settings.request_subject){url+='&subject='+settings.request_subject;}
if(settings.request_description){url+='&description='+settings.request_description;}
if(settings.requester_name){url+='&name='+settings.requester_name;}
if(settings.requester_email){url+='&email='+settings.requester_email;}
if(settings.forceSuggestions){url+='&forceSuggestions='+settings.forceSuggestions;}
if(settings.ticketTypeId){url+='&ticketTypeId='+settings.ticketTypeId;}
return url;}
function initialize(options){if(!tab){createElements();}
configure(options);updateTab();iframe.src=loadingURL();window.addEventListener('message',function(e){if(e.data==='hideSupportWidget'){hide();}},false);}
function show(evt){iframe.src=dropboxURL();overlay.style.height=scrim.style.height=getDocHeight()+'px';container.style.top=getScrollOffsets().top+50+'px';overlay.style.display="block";return cancelEvent(evt);}
function hide(evt){overlay.style.display='none';iframe.src=loadingURL();return cancelEvent(evt);}
var CESupportWidget={init:function(options){attempt(function(){return initialize(options);});},update:function(options){attempt(function(){return initialize(options);});},render:function(evt){attempt(function(){return show(evt);});},show:function(evt){attempt(function(){return show(evt);});},hide:function(evt){attempt(function(){return hide(evt);});}};bindEvent(window,'load',function(){if(window.supportwidget_params){CESupportWidget.init(window.supportwidget_params);}});window.CESupportWidget=CESupportWidget;}(this.window||this));
;/*!
 * Bootstrap v3.4.1 (https://getbootstrap.com/)
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under the MIT license
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(t){"use strict";var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||3<e[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(n){"use strict";n.fn.emulateTransitionEnd=function(t){var e=!1,i=this;n(this).one("bsTransitionEnd",function(){e=!0});return setTimeout(function(){e||n(i).trigger(n.support.transition.end)},t),this},n(function(){n.support.transition=function o(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(t.style[i]!==undefined)return{end:e[i]};return!1}(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(s){"use strict";var e='[data-dismiss="alert"]',a=function(t){s(t).on("click",e,this.close)};a.VERSION="3.4.1",a.TRANSITION_DURATION=150,a.prototype.close=function(t){var e=s(this),i=e.attr("data-target");i||(i=(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),i="#"===i?[]:i;var o=s(document).find(i);function n(){o.detach().trigger("closed.bs.alert").remove()}t&&t.preventDefault(),o.length||(o=e.closest(".alert")),o.trigger(t=s.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),s.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",n).emulateTransitionEnd(a.TRANSITION_DURATION):n())};var t=s.fn.alert;s.fn.alert=function o(i){return this.each(function(){var t=s(this),e=t.data("bs.alert");e||t.data("bs.alert",e=new a(this)),"string"==typeof i&&e[i].call(t)})},s.fn.alert.Constructor=a,s.fn.alert.noConflict=function(){return s.fn.alert=t,this},s(document).on("click.bs.alert.data-api",e,a.prototype.close)}(jQuery),function(s){"use strict";var n=function(t,e){this.$element=s(t),this.options=s.extend({},n.DEFAULTS,e),this.isLoading=!1};function i(o){return this.each(function(){var t=s(this),e=t.data("bs.button"),i="object"==typeof o&&o;e||t.data("bs.button",e=new n(this,i)),"toggle"==o?e.toggle():o&&e.setState(o)})}n.VERSION="3.4.1",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var e="disabled",i=this.$element,o=i.is("input")?"val":"html",n=i.data();t+="Text",null==n.resetText&&i.data("resetText",i[o]()),setTimeout(s.proxy(function(){i[o](null==n[t]?this.options[t]:n[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(e).attr(e,e).prop(e,!0)):this.isLoading&&(this.isLoading=!1,i.removeClass(e).removeAttr(e).prop(e,!1))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var t=s.fn.button;s.fn.button=i,s.fn.button.Constructor=n,s.fn.button.noConflict=function(){return s.fn.button=t,this},s(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var e=s(t.target).closest(".btn");i.call(e,"toggle"),s(t.target).is('input[type="radio"], input[type="checkbox"]')||(t.preventDefault(),e.is("input,button")?e.trigger("focus"):e.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){s(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),function(p){"use strict";var c=function(t,e){this.$element=p(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",p.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",p.proxy(this.pause,this)).on("mouseleave.bs.carousel",p.proxy(this.cycle,this))};function r(n){return this.each(function(){var t=p(this),e=t.data("bs.carousel"),i=p.extend({},c.DEFAULTS,t.data(),"object"==typeof n&&n),o="string"==typeof n?n:i.slide;e||t.data("bs.carousel",e=new c(this,i)),"number"==typeof n?e.to(n):o?e[o]():i.interval&&e.pause().cycle()})}c.VERSION="3.4.1",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},c.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(p.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},c.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);if(("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap)return e;var o=(i+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(o)},c.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(i<t?"next":"prev",this.$items.eq(t))},c.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&p.support.transition&&(this.$element.trigger(p.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){if(!this.sliding)return this.slide("next")},c.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},c.prototype.slide=function(t,e){var i=this.$element.find(".item.active"),o=e||this.getItemForDirection(t,i),n=this.interval,s="next"==t?"left":"right",a=this;if(o.hasClass("active"))return this.sliding=!1;var r=o[0],l=p.Event("slide.bs.carousel",{relatedTarget:r,direction:s});if(this.$element.trigger(l),!l.isDefaultPrevented()){if(this.sliding=!0,n&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=p(this.$indicators.children()[this.getItemIndex(o)]);h&&h.addClass("active")}var d=p.Event("slid.bs.carousel",{relatedTarget:r,direction:s});return p.support.transition&&this.$element.hasClass("slide")?(o.addClass(t),"object"==typeof o&&o.length&&o[0].offsetWidth,i.addClass(s),o.addClass(s),i.one("bsTransitionEnd",function(){o.removeClass([t,s].join(" ")).addClass("active"),i.removeClass(["active",s].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(d)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(i.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(d)),n&&this.cycle(),this}};var t=p.fn.carousel;p.fn.carousel=r,p.fn.carousel.Constructor=c,p.fn.carousel.noConflict=function(){return p.fn.carousel=t,this};var e=function(t){var e=p(this),i=e.attr("href");i&&(i=i.replace(/.*(?=#[^\s]+$)/,""));var o=e.attr("data-target")||i,n=p(document).find(o);if(n.hasClass("carousel")){var s=p.extend({},n.data(),e.data()),a=e.attr("data-slide-to");a&&(s.interval=!1),r.call(n,s),a&&n.data("bs.carousel").to(a),t.preventDefault()}};p(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),p(window).on("load",function(){p('[data-ride="carousel"]').each(function(){var t=p(this);r.call(t,t.data())})})}(jQuery),function(a){"use strict";var r=function(t,e){this.$element=a(t),this.options=a.extend({},r.DEFAULTS,e),this.$trigger=a('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function n(t){var e,i=t.attr("data-target")||(e=t.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"");return a(document).find(i)}function l(o){return this.each(function(){var t=a(this),e=t.data("bs.collapse"),i=a.extend({},r.DEFAULTS,t.data(),"object"==typeof o&&o);!e&&i.toggle&&/show|hide/.test(o)&&(i.toggle=!1),e||t.data("bs.collapse",e=new r(this,i)),"string"==typeof o&&e[o]()})}r.VERSION="3.4.1",r.TRANSITION_DURATION=350,r.DEFAULTS={toggle:!0},r.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},r.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(t=e.data("bs.collapse"))&&t.transitioning)){var i=a.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){e&&e.length&&(l.call(e,"hide"),t||e.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var n=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return n.call(this);var s=a.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",a.proxy(n,this)).emulateTransitionEnd(r.TRANSITION_DURATION)[o](this.$element[0][s])}}}},r.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=a.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var e=this.dimension();this.$element[e](this.$element[e]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!a.support.transition)return i.call(this);this.$element[e](0).one("bsTransitionEnd",a.proxy(i,this)).emulateTransitionEnd(r.TRANSITION_DURATION)}}},r.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},r.prototype.getParent=function(){return a(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(t,e){var i=a(e);this.addAriaAndCollapsedClass(n(i),i)},this)).end()},r.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var t=a.fn.collapse;a.fn.collapse=l,a.fn.collapse.Constructor=r,a.fn.collapse.noConflict=function(){return a.fn.collapse=t,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var e=a(this);e.attr("data-target")||t.preventDefault();var i=n(e),o=i.data("bs.collapse")?"toggle":e.data();l.call(i,o)})}(jQuery),function(a){"use strict";var r='[data-toggle="dropdown"]',o=function(t){a(t).on("click.bs.dropdown",this.toggle)};function l(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var i="#"!==e?a(document).find(e):null;return i&&i.length?i:t.parent()}function s(o){o&&3===o.which||(a(".dropdown-backdrop").remove(),a(r).each(function(){var t=a(this),e=l(t),i={relatedTarget:this};e.hasClass("open")&&(o&&"click"==o.type&&/input|textarea/i.test(o.target.tagName)&&a.contains(e[0],o.target)||(e.trigger(o=a.Event("hide.bs.dropdown",i)),o.isDefaultPrevented()||(t.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",i)))))}))}o.VERSION="3.4.1",o.prototype.toggle=function(t){var e=a(this);if(!e.is(".disabled, :disabled")){var i=l(e),o=i.hasClass("open");if(s(),!o){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",s);var n={relatedTarget:this};if(i.trigger(t=a.Event("show.bs.dropdown",n)),t.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(a.Event("shown.bs.dropdown",n))}return!1}},o.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var e=a(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=l(e),o=i.hasClass("open");if(!o&&27!=t.which||o&&27==t.which)return 27==t.which&&i.find(r).trigger("focus"),e.trigger("click");var n=i.find(".dropdown-menu li:not(.disabled):visible a");if(n.length){var s=n.index(t.target);38==t.which&&0<s&&s--,40==t.which&&s<n.length-1&&s++,~s||(s=0),n.eq(s).trigger("focus")}}}};var t=a.fn.dropdown;a.fn.dropdown=function e(i){return this.each(function(){var t=a(this),e=t.data("bs.dropdown");e||t.data("bs.dropdown",e=new o(this)),"string"==typeof i&&e[i].call(t)})},a.fn.dropdown.Constructor=o,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=t,this},a(document).on("click.bs.dropdown.data-api",s).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r,o.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",o.prototype.keydown)}(jQuery),function(a){"use strict";var s=function(t,e){this.options=e,this.$body=a(document.body),this.$element=a(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};function r(o,n){return this.each(function(){var t=a(this),e=t.data("bs.modal"),i=a.extend({},s.DEFAULTS,t.data(),"object"==typeof o&&o);e||t.data("bs.modal",e=new s(this,i)),"string"==typeof o?e[o](n):i.show&&e.show(n)})}s.VERSION="3.4.1",s.TRANSITION_DURATION=300,s.BACKDROP_TRANSITION_DURATION=150,s.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},s.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},s.prototype.show=function(i){var o=this,t=a.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(t),this.isShown||t.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){o.$element.one("mouseup.dismiss.bs.modal",function(t){a(t.target).is(o.$element)&&(o.ignoreBackdropClick=!0)})}),this.backdrop(function(){var t=a.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(o.$body),o.$element.show().scrollTop(0),o.adjustDialog(),t&&o.$element[0].offsetWidth,o.$element.addClass("in"),o.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:i});t?o.$dialog.one("bsTransitionEnd",function(){o.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(s.TRANSITION_DURATION):o.$element.trigger("focus").trigger(e)}))},s.prototype.hide=function(t){t&&t.preventDefault(),t=a.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(s.TRANSITION_DURATION):this.hideModal())},s.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},s.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},s.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},s.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},s.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},s.prototype.backdrop=function(t){var e=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=a.support.transition&&i;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+i).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;o?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(s.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var n=function(){e.removeBackdrop(),t&&t()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(s.BACKDROP_TRANSITION_DURATION):n()}else t&&t()},s.prototype.handleUpdate=function(){this.adjustDialog()},s.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},s.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},s.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},s.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var n=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",t+n),a(this.fixedContent).each(function(t,e){var i=e.style.paddingRight,o=a(e).css("padding-right");a(e).data("padding-right",i).css("padding-right",parseFloat(o)+n+"px")}))},s.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),a(this.fixedContent).each(function(t,e){var i=a(e).data("padding-right");a(e).removeData("padding-right"),e.style.paddingRight=i||""})},s.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var t=a.fn.modal;a.fn.modal=r,a.fn.modal.Constructor=s,a.fn.modal.noConflict=function(){return a.fn.modal=t,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e=a(this),i=e.attr("href"),o=e.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,""),n=a(document).find(o),s=n.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(i)&&i},n.data(),e.data());e.is("a")&&t.preventDefault(),n.one("show.bs.modal",function(t){t.isDefaultPrevented()||n.one("hidden.bs.modal",function(){e.is(":visible")&&e.trigger("focus")})}),r.call(n,s,this)})}(jQuery),function(g){"use strict";var o=["sanitize","whiteList","sanitizeFn"],a=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],t={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},r=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,l=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function u(t,e){var i=t.nodeName.toLowerCase();if(-1!==g.inArray(i,e))return-1===g.inArray(i,a)||Boolean(t.nodeValue.match(r)||t.nodeValue.match(l));for(var o=g(e).filter(function(t,e){return e instanceof RegExp}),n=0,s=o.length;n<s;n++)if(i.match(o[n]))return!0;return!1}function n(t,e,i){if(0===t.length)return t;if(i&&"function"==typeof i)return i(t);if(!document.implementation||!document.implementation.createHTMLDocument)return t;var o=document.implementation.createHTMLDocument("sanitization");o.body.innerHTML=t;for(var n=g.map(e,function(t,e){return e}),s=g(o.body).find("*"),a=0,r=s.length;a<r;a++){var l=s[a],h=l.nodeName.toLowerCase();if(-1!==g.inArray(h,n))for(var d=g.map(l.attributes,function(t){return t}),p=[].concat(e["*"]||[],e[h]||[]),c=0,f=d.length;c<f;c++)u(d[c],p)||l.removeAttribute(d[c].nodeName);else l.parentNode.removeChild(l)}return o.body.innerHTML}var m=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};m.VERSION="3.4.1",m.TRANSITION_DURATION=150,m.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:t},m.prototype.init=function(t,e,i){if(this.enabled=!0,this.type=t,this.$element=g(e),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&g(document).find(g.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),n=o.length;n--;){var s=o[n];if("click"==s)this.$element.on("click."+this.type,this.options.selector,g.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",r="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,g.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,g.proxy(this.leave,this))}}this.options.selector?this._options=g.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},m.prototype.getDefaults=function(){return m.DEFAULTS},m.prototype.getOptions=function(t){var e=this.$element.data();for(var i in e)e.hasOwnProperty(i)&&-1!==g.inArray(i,o)&&delete e[i];return(t=g.extend({},this.getDefaults(),e,t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t.sanitize&&(t.template=n(t.template,t.whiteList,t.sanitizeFn)),t},m.prototype.getDelegateOptions=function(){var i={},o=this.getDefaults();return this._options&&g.each(this._options,function(t,e){o[t]!=e&&(i[t]=e)}),i},m.prototype.enter=function(t){var e=t instanceof this.constructor?t:g(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e)),t instanceof g.Event&&(e.inState["focusin"==t.type?"focus":"hover"]=!0),e.tip().hasClass("in")||"in"==e.hoverState)e.hoverState="in";else{if(clearTimeout(e.timeout),e.hoverState="in",!e.options.delay||!e.options.delay.show)return e.show();e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)}},m.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},m.prototype.leave=function(t){var e=t instanceof this.constructor?t:g(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e)),t instanceof g.Event&&(e.inState["focusout"==t.type?"focus":"hover"]=!1),!e.isInStateTrue()){if(clearTimeout(e.timeout),e.hoverState="out",!e.options.delay||!e.options.delay.hide)return e.hide();e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)}},m.prototype.show=function(){var t=g.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var e=g.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!e)return;var i=this,o=this.tip(),n=this.getUID(this.type);this.setContent(),o.attr("id",n),this.$element.attr("aria-describedby",n),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,r=a.test(s);r&&(s=s.replace(a,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(g(document).find(this.options.container)):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var l=this.getPosition(),h=o[0].offsetWidth,d=o[0].offsetHeight;if(r){var p=s,c=this.getPosition(this.$viewport);s="bottom"==s&&l.bottom+d>c.bottom?"top":"top"==s&&l.top-d<c.top?"bottom":"right"==s&&l.right+h>c.width?"left":"left"==s&&l.left-h<c.left?"right":s,o.removeClass(p).addClass(s)}var f=this.getCalculatedOffset(s,l,h,d);this.applyPlacement(f,s);var u=function(){var t=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,"out"==t&&i.leave(i)};g.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",u).emulateTransitionEnd(m.TRANSITION_DURATION):u()}},m.prototype.applyPlacement=function(t,e){var i=this.tip(),o=i[0].offsetWidth,n=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top+=s,t.left+=a,g.offset.setOffset(i[0],g.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),i.addClass("in");var r=i[0].offsetWidth,l=i[0].offsetHeight;"top"==e&&l!=n&&(t.top=t.top+n-l);var h=this.getViewportAdjustedDelta(e,t,r,l);h.left?t.left+=h.left:t.top+=h.top;var d=/top|bottom/.test(e),p=d?2*h.left-o+r:2*h.top-n+l,c=d?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(p,i[0][c],d)},m.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},m.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=n(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},m.prototype.hide=function(t){var e=this,i=g(this.$tip),o=g.Event("hide.bs."+this.type);function n(){"in"!=e.hoverState&&i.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),t&&t()}if(this.$element.trigger(o),!o.isDefaultPrevented())return i.removeClass("in"),g.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",n).emulateTransitionEnd(m.TRANSITION_DURATION):n(),this.hoverState=null,this},m.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},m.prototype.hasContent=function(){return this.getTitle()},m.prototype.getPosition=function(t){var e=(t=t||this.$element)[0],i="BODY"==e.tagName,o=e.getBoundingClientRect();null==o.width&&(o=g.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var n=window.SVGElement&&e instanceof window.SVGElement,s=i?{top:0,left:0}:n?null:t.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},r=i?{width:g(window).width(),height:g(window).height()}:null;return g.extend({},o,a,r,s)},m.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},m.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+o;r<a.top?n.top=a.top-r:l>a.top+a.height&&(n.top=a.top+a.height-l)}else{var h=e.left-s,d=e.left+s+i;h<a.left?n.left=a.left-h:d>a.right&&(n.left=a.left+a.width-d)}return n},m.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},m.prototype.getUID=function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},m.prototype.tip=function(){if(!this.$tip&&(this.$tip=g(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},m.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},m.prototype.enable=function(){this.enabled=!0},m.prototype.disable=function(){this.enabled=!1},m.prototype.toggleEnabled=function(){this.enabled=!this.enabled},m.prototype.toggle=function(t){var e=this;t&&((e=g(t.currentTarget).data("bs."+this.type))||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e))),t?(e.inState.click=!e.inState.click,e.isInStateTrue()?e.enter(e):e.leave(e)):e.tip().hasClass("in")?e.leave(e):e.enter(e)},m.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})},m.prototype.sanitizeHtml=function(t){return n(t,this.options.whiteList,this.options.sanitizeFn)};var e=g.fn.tooltip;g.fn.tooltip=function i(o){return this.each(function(){var t=g(this),e=t.data("bs.tooltip"),i="object"==typeof o&&o;!e&&/destroy|hide/.test(o)||(e||t.data("bs.tooltip",e=new m(this,i)),"string"==typeof o&&e[o]())})},g.fn.tooltip.Constructor=m,g.fn.tooltip.noConflict=function(){return g.fn.tooltip=e,this}}(jQuery),function(n){"use strict";var s=function(t,e){this.init("popover",t,e)};if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");s.VERSION="3.4.1",s.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((s.prototype=n.extend({},n.fn.tooltip.Constructor.prototype)).constructor=s).prototype.getDefaults=function(){return s.DEFAULTS},s.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();if(this.options.html){var o=typeof i;this.options.sanitize&&(e=this.sanitizeHtml(e),"string"===o&&(i=this.sanitizeHtml(i))),t.find(".popover-title").html(e),t.find(".popover-content").children().detach().end()["string"===o?"html":"append"](i)}else t.find(".popover-title").text(e),t.find(".popover-content").children().detach().end().text(i);t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},s.prototype.hasContent=function(){return this.getTitle()||this.getContent()},s.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},s.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var t=n.fn.popover;n.fn.popover=function e(o){return this.each(function(){var t=n(this),e=t.data("bs.popover"),i="object"==typeof o&&o;!e&&/destroy|hide/.test(o)||(e||t.data("bs.popover",e=new s(this,i)),"string"==typeof o&&e[o]())})},n.fn.popover.Constructor=s,n.fn.popover.noConflict=function(){return n.fn.popover=t,this}}(jQuery),function(s){"use strict";function n(t,e){this.$body=s(document.body),this.$scrollElement=s(t).is(document.body)?s(window):s(t),this.options=s.extend({},n.DEFAULTS,e),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",s.proxy(this.process,this)),this.refresh(),this.process()}function e(o){return this.each(function(){var t=s(this),e=t.data("bs.scrollspy"),i="object"==typeof o&&o;e||t.data("bs.scrollspy",e=new n(this,i)),"string"==typeof o&&e[o]()})}n.VERSION="3.4.1",n.DEFAULTS={offset:10},n.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},n.prototype.refresh=function(){var t=this,o="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),s.isWindow(this.$scrollElement[0])||(o="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=s(this),e=t.data("target")||t.attr("href"),i=/^#./.test(e)&&s(e);return i&&i.length&&i.is(":visible")&&[[i[o]().top+n,e]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},n.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),o=this.options.offset+i-this.$scrollElement.height(),n=this.offsets,s=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),o<=e)return a!=(t=s[s.length-1])&&this.activate(t);if(a&&e<n[0])return this.activeTarget=null,this.clear();for(t=n.length;t--;)a!=s[t]&&e>=n[t]&&(n[t+1]===undefined||e<n[t+1])&&this.activate(s[t])},n.prototype.activate=function(t){this.activeTarget=t,this.clear();var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=s(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},n.prototype.clear=function(){s(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var t=s.fn.scrollspy;s.fn.scrollspy=e,s.fn.scrollspy.Constructor=n,s.fn.scrollspy.noConflict=function(){return s.fn.scrollspy=t,this},s(window).on("load.bs.scrollspy.data-api",function(){s('[data-spy="scroll"]').each(function(){var t=s(this);e.call(t,t.data())})})}(jQuery),function(r){"use strict";var a=function(t){this.element=r(t)};function e(i){return this.each(function(){var t=r(this),e=t.data("bs.tab");e||t.data("bs.tab",e=new a(this)),"string"==typeof i&&e[i]()})}a.VERSION="3.4.1",a.TRANSITION_DURATION=150,a.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var o=e.find(".active:last a"),n=r.Event("hide.bs.tab",{relatedTarget:t[0]}),s=r.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(n),t.trigger(s),!s.isDefaultPrevented()&&!n.isDefaultPrevented()){var a=r(document).find(i);this.activate(t.closest("li"),e),this.activate(a,a.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},a.prototype.activate=function(t,e,i){var o=e.find("> .active"),n=i&&r.support.transition&&(o.length&&o.hasClass("fade")||!!e.find("> .fade").length);function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),n?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}o.length&&n?o.one("bsTransitionEnd",s).emulateTransitionEnd(a.TRANSITION_DURATION):s(),o.removeClass("in")};var t=r.fn.tab;r.fn.tab=e,r.fn.tab.Constructor=a,r.fn.tab.noConflict=function(){return r.fn.tab=t,this};var i=function(t){t.preventDefault(),e.call(r(this),"show")};r(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),function(l){"use strict";var h=function(t,e){this.options=l.extend({},h.DEFAULTS,e);var i=this.options.target===h.DEFAULTS.target?l(this.options.target):l(document).find(this.options.target);this.$target=i.on("scroll.bs.affix.data-api",l.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",l.proxy(this.checkPositionWithEventLoop,this)),this.$element=l(t),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function i(o){return this.each(function(){var t=l(this),e=t.data("bs.affix"),i="object"==typeof o&&o;e||t.data("bs.affix",e=new h(this,i)),"string"==typeof o&&e[o]()})}h.VERSION="3.4.1",h.RESET="affix affix-top affix-bottom",h.DEFAULTS={offset:0,target:window},h.prototype.getState=function(t,e,i,o){var n=this.$target.scrollTop(),s=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return n<i&&"top";if("bottom"==this.affixed)return null!=i?!(n+this.unpin<=s.top)&&"bottom":!(n+a<=t-o)&&"bottom";var r=null==this.affixed,l=r?n:s.top;return null!=i&&n<=i?"top":null!=o&&t-o<=l+(r?a:e)&&"bottom"},h.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(h.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},h.prototype.checkPositionWithEventLoop=function(){setTimeout(l.proxy(this.checkPosition,this),1)},h.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,o=e.bottom,n=Math.max(l(document).height(),l(document.body).height());"object"!=typeof e&&(o=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof o&&(o=e.bottom(this.$element));var s=this.getState(n,t,i,o);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var a="affix"+(s?"-"+s:""),r=l.Event(a+".bs.affix");if(this.$element.trigger(r),r.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(h.RESET).addClass(a).trigger(a.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:n-t-o})}};var t=l.fn.affix;l.fn.affix=i,l.fn.affix.Constructor=h,l.fn.affix.noConflict=function(){return l.fn.affix=t,this},l(window).on("load",function(){l('[data-spy="affix"]').each(function(){var t=l(this),e=t.data();e.offset=e.offset||{},null!=e.offsetBottom&&(e.offset.bottom=e.offsetBottom),null!=e.offsetTop&&(e.offset.top=e.offsetTop),i.call(t,e)})})}(jQuery);
;/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){var pluses=/\+/g;function raw(s){return s;}
function decoded(s){return decodeURIComponent(s.replace(pluses,' '));}
function converted(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}
try{return config.json?JSON.parse(s):s;}catch(er){}}
var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=config.json?JSON.stringify(value):String(value);return(document.cookie=[config.raw?key:encodeURIComponent(key),'=',config.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var decode=config.raw?raw:decoded;var cookies=document.cookie.split('; ');var result=key?undefined:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=decode(parts.join('='));if(key&&key===name){result=converted(cookie);break;}
if(!key){result[name]=converted(cookie);}}
return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,'',$.extend({},options,{expires:-1}));return true;}
return false;};}));;(function($){if(typeof $.fn.each2=="undefined"){$.fn.extend({each2:function(c){var j=$([0]),i=-1,l=this.length;while(++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==false);return this;}});}})(jQuery);(function($,undefined){"use strict";if(window.Select2!==undefined){return;}
var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer,lastMousePosition,$document;KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){k=k.which?k.which:k;switch(k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return true;}
return false;},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return true;}
if(e.metaKey)return true;return false;},isFunctionKey:function(k){k=k.which?k.which:k;return k>=112&&k<=123;}};$document=$(document);nextUid=(function(){var counter=1;return function(){return counter++;};}());function indexOf(value,array){var i=0,l=array.length,v;if(typeof value==="undefined"){return-1;}
if(value.constructor===String){for(;i<l;i=i+1)if(value.localeCompare(array[i])===0)return i;}else{for(;i<l;i=i+1){v=array[i];if(v.constructor===String){if(v.localeCompare(value)===0)return i;}else{if(v===value)return i;}}}
return-1;}
function equal(a,b){if(a===b)return true;if(a===undefined||b===undefined)return false;if(a===null||b===null)return false;if(a.constructor===String)return a.localeCompare(b)===0;if(b.constructor===String)return b.localeCompare(a)===0;return false;}
function splitVal(string,separator){var val,i,l;if(string===null||string.length<1)return[];val=string.split(separator);for(i=0,l=val.length;i<l;i=i+1)val[i]=$.trim(val[i]);return val;}
function getSideBorderPadding(element){return element.outerWidth()-element.width();}
function installKeyUpChangeEvent(element){var key="keyup-change-value";element.bind("keydown",function(){if($.data(element,key)===undefined){$.data(element,key,element.val());}});element.bind("keyup",function(){var val=$.data(element,key);if(val!==undefined&&element.val()!==val){$.removeData(element,key);element.trigger("keyup-change");}});}
$document.bind("mousemove",function(e){lastMousePosition={x:e.pageX,y:e.pageY};});function installFilteredMouseMove(element){element.bind("mousemove",function(e){var lastpos=lastMousePosition;if(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY){$(e.target).trigger("mousemove-filtered",e);}});}
function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(ctx,args);},quietMillis);};}
function thunk(formula){var evaluated=false,value;return function(){if(evaluated===false){value=formula();evaluated=true;}
return value;};};function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger("scroll-debounced",e);});element.bind("scroll",function(e){if(indexOf(e.target,element.get())>=0)notify(e);});}
function killEvent(event){event.preventDefault();event.stopPropagation();}
function killEventImmediately(event){event.preventDefault();event.stopImmediatePropagation();}
function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:"nowrap"});$("body").append(sizer);}
sizer.text(e.val());return sizer.width();}
function markMatch(text,term,markup){var match=text.toUpperCase().indexOf(term.toUpperCase()),tl=term.length;if(match<0){markup.push(text);return;}
markup.push(text.substring(0,match));markup.push("<span class='select2-match'>");markup.push(text.substring(match,match+tl));markup.push("</span>");markup.push(text.substring(match+tl,text.length));}
function ajax(options){var timeout,requestSequence=0,handler=null,quietMillis=options.quietMillis||100;return function(query){window.clearTimeout(timeout);timeout=window.setTimeout(function(){requestSequence+=1;var requestNumber=requestSequence,data=options.data,transport=options.transport||$.ajax,traditional=options.traditional||false,type=options.type||'GET';data=data.call(this,query.term,query.page,query.context);if(null!==handler){handler.abort();}
handler=transport.call(null,{url:options.url,dataType:options.dataType,data:data,type:type,traditional:traditional,success:function(data){if(requestNumber<requestSequence){return;}
var results=options.results(data,query.page);query.callback(results);}});},quietMillis);};}
function local(options){var data=options,dataText,text=function(item){return""+item.text;};if(!$.isArray(data)){text=data.text;if(!$.isFunction(text)){dataText=data.text;text=function(item){return item[dataText];};}
data=data.results;}
return function(query){var t=query.term,filtered={results:[]},process;if(t===""){query.callback({results:data});return;}
process=function(datum,collection){var group,attr;datum=datum[0];if(datum.children){group={};for(attr in datum){if(datum.hasOwnProperty(attr))group[attr]=datum[attr];}
group.children=[];$(datum.children).each2(function(i,childDatum){process(childDatum,group.children);});if(group.children.length){collection.push(group);}}else{if(query.matcher(t,text(datum))){collection.push(datum);}}};$(data).each2(function(i,datum){process(datum,filtered.results);});query.callback(filtered);};}
function tags(data){if($.isFunction(data)){return data;}
return function(query){var t=query.term,filtered={results:[]};$(data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;if(t===""||query.matcher(t,text)){filtered.results.push(isObject?this:{id:this,text:this});}});query.callback(filtered);};}
function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return true;if(!formatter)return false;throw new Error("formatterName must be a function or a falsy value");}
function evaluate(val){return $.isFunction(val)?val():val;}
function countResults(results){var count=0;$.each(results,function(i,item){if(item.children){count+=countResults(item.children);}else{count++;}});return count;}
function defaultTokenizer(input,selection,selectCallback,opts){var original=input,dupe=false,token,index,i,l,separator;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;while(true){index=-1;for(i=0,l=opts.tokenSeparators.length;i<l;i++){separator=opts.tokenSeparators[i];index=input.indexOf(separator);if(index>=0)break;}
if(index<0)break;token=input.substring(0,index);input=input.substring(index+separator.length);if(token.length>0){token=opts.createSearchChoice(token,selection);if(token!==undefined&&token!==null&&opts.id(token)!==undefined&&opts.id(token)!==null){dupe=false;for(i=0,l=selection.length;i<l;i++){if(equal(opts.id(token),opts.id(selection[i]))){dupe=true;break;}}
if(!dupe)selectCallback(token);}}}
if(original.localeCompare(input)!=0)return input;}
$document.ready(function(){$document.bind("mousedown touchend",function(e){var target=$(e.target).closest("div.select2-container").get(0),attr;if(target){$document.find("div.select2-container-active").each(function(){if(this!==target)$(this).data("select2").blur();});}else{target=$(e.target).closest("div.select2-drop").get(0);$document.find("div.select2-drop-active").each(function(){if(this!==target)$(this).data("select2").blur();});}
target=$(e.target);attr=target.attr("for");if("LABEL"===e.target.tagName&&attr&&attr.length>0){target=$("#"+attr);target=target.data("select2");if(target!==undefined){target.focus();e.preventDefault();}}});});function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor;}
AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments);};},init:function(opts){var results,search,resultsSelector=".select2-results";this.opts=opts=this.prepareOpts(opts);this.id=opts.id;if(opts.element.data("select2")!==undefined&&opts.element.data("select2")!==null){this.destroy();}
this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(opts.element.attr("id")||"autogen"+nextUid());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,'\\$1');this.container.attr("id",this.containerId);this.body=thunk(function(){return opts.element.closest("body");});if(opts.element.attr("class")!==undefined){this.container.addClass(opts.element.attr("class").replace(/validate\[[\S ]+] ?/,''));}
this.container.css(evaluate(opts.containerCss));this.container.addClass(evaluate(opts.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(evaluate(opts.dropdownCssClass));this.dropdown.data("select2",this);this.results=results=this.container.find(resultsSelector);this.search=search=this.container.find("input.select2-input");search.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();installFilteredMouseMove(this.results);this.dropdown.delegate(resultsSelector,"mousemove-filtered",this.bind(this.highlightUnderEvent));installDebouncedScroll(80,this.results);this.dropdown.delegate(resultsSelector,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if($.fn.mousewheel){results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop(),height;if(deltaY>0&&top-deltaY<=0){results.scrollTop(0);killEvent(e);}else if(deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()){results.scrollTop(results.get(0).scrollHeight-results.height());killEvent(e);}});}
installKeyUpChangeEvent(search);search.bind("keyup-change",this.bind(this.updateResults));search.bind("focus",function(){search.addClass("select2-focused");if(search.val()===" ")search.val("");});search.bind("blur",function(){search.removeClass("select2-focused");});this.dropdown.delegate(resultsSelector,"mouseup",this.bind(function(e){if($(e.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0){this.highlightUnderEvent(e);this.selectHighlighted(e);}else{this.focusSearch();}
killEvent(e);}));this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation();});if($.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource();}
if(opts.element.is(":disabled")||opts.element.is("[readonly='readonly']"))this.disable();},destroy:function(){var select2=this.opts.element.data("select2");if(select2!==undefined){select2.container.remove();select2.dropdown.remove();select2.opts.element.removeData("select2").unbind(".select2").show();}},prepareOpts:function(opts){var element,select,idKey,ajaxUrl;element=opts.element;if(element.get(0).tagName.toLowerCase()==="select"){this.select=select=opts.element;}
if(select){$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in opts){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.");}});}
opts=$.extend({},{populateResults:function(container,results,query){var populate,data,result,children,id=this.opts.id,self=this;populate=function(results,container,depth){var i,l,result,selectable,compound,node,label,innerContainer,formatted;for(i=0,l=results.length;i<l;i=i+1){result=results[i];selectable=id(result)!==undefined;compound=result.children&&result.children.length>0;node=$("<li></li>");node.addClass("select2-results-dept-"+depth);node.addClass("select2-result");node.attr("data-id",result.id);node.addClass(selectable?"select2-result-selectable":"select2-result-unselectable");if(compound){node.addClass("select2-result-with-children");}
node.addClass(self.opts.formatResultCssClass(result));label=$("<div></div>");label.addClass("select2-result-label");formatted=opts.formatResult(result,label,query);if(formatted!==undefined){label.html(self.opts.escapeMarkup(formatted));}
node.append(label);if(compound){innerContainer=$("<ul></ul>");innerContainer.addClass("select2-result-sub");populate(result.children,innerContainer,depth+1);node.append(innerContainer);}
node.data("select2-data",result);container.append(node);}};populate(results,container,0);}},$.fn.select2.defaults,opts);if(typeof(opts.id)!=="function"){idKey=opts.id;opts.id=function(e){return e[idKey];};}
if(select){opts.query=this.bind(function(query){var data={results:[],more:false},term=query.term,children,firstChild,process;process=function(element,collection){var group;if(element.is("option")){if(query.matcher(term,element.text(),element)){collection.push({id:element.attr("value"),text:element.text(),element:element.get(),css:element.attr("class")});}}else if(element.is("optgroup")){group={text:element.attr("label"),children:[],element:element.get(),css:element.attr("class")};element.children().each2(function(i,elm){process(elm,group.children);});if(group.children.length>0){collection.push(group);}}};children=element.children();if(this.getPlaceholder()!==undefined&&children.length>0){firstChild=children[0];if($(firstChild).text()===""){children=children.not(firstChild);}}
children.each2(function(i,elm){process(elm,data.results);});query.callback(data);});opts.id=function(e){return e.id;};opts.formatResultCssClass=function(data){return data.css;}}else{if(!("query"in opts)){if("ajax"in opts){ajaxUrl=opts.element.data("ajax-url");if(ajaxUrl&&ajaxUrl.length>0){opts.ajax.url=ajaxUrl;}
opts.query=ajax(opts.ajax);}else if("data"in opts){opts.query=local(opts.data);}else if("tags"in opts){opts.query=tags(opts.tags);opts.createSearchChoice=function(term){return{id:term,text:term};};opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var id=this,text=this,tags=opts.tags;if($.isFunction(tags))tags=tags();$(tags).each(function(){if(equal(this.id,id)){text=this.text;return false;}});data.push({id:id,text:text});});callback(data);};}}}
if(typeof(opts.query)!=="function"){throw"query function not defined for Select2 "+opts.element.attr("id");}
return opts;},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection();}}));},triggerChange:function(details){details=details||{};details=$.extend({},details,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(details);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)
this.opts.element.blur();},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass("select2-container-disabled");},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass("select2-container-disabled");},opened:function(){return this.container.hasClass("select2-dropdown-open");},positionDropdown:function(){var offset=this.container.offset(),height=this.container.outerHeight(),width=this.container.outerWidth(),dropHeight=this.dropdown.outerHeight(),viewportBottom=$(window).scrollTop()+document.documentElement.clientHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=(offset.top-dropHeight)>=this.body().scrollTop(),aboveNow=this.dropdown.hasClass("select2-drop-above"),bodyOffset,above,css;if(this.body().css('position')!=='static'){bodyOffset=this.body().offset();dropTop-=bodyOffset.top;dropLeft-=bodyOffset.left;}
if(aboveNow){above=true;if(!enoughRoomAbove&&enoughRoomBelow)above=false;}else{above=false;if(!enoughRoomBelow&&enoughRoomAbove)above=true;}
if(above){dropTop=offset.top-dropHeight;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above");}
else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above");}
css=$.extend({top:dropTop,left:dropLeft,width:width},evaluate(this.opts.dropdownCss));this.dropdown.css(css);this.opts.element.trigger($.Event("resizeddropdown"));},shouldOpen:function(){var event;if(this.opened())return false;event=$.Event("open");this.opts.element.trigger(event);return!event.isDefaultPrevented();},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above");},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true;},opening:function(){var cid=this.containerId,selector=this.containerSelector,scroll="scroll."+cid,resize="resize."+cid;this.container.parents().each(function(){$(this).bind(scroll,function(){var s2=$(selector);if(s2.length==0){$(this).unbind(scroll);}
s2.select2("close");});});window.setTimeout(function(){$(window).bind(resize,function(){var s2=$(selector);if(s2.length==0){$(window).unbind(resize);}
s2.select2("close");})},10);this.clearDropdownAlignmentPreference();if(this.search.val()===" "){this.search.val("");}
this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body());}
this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.focusSearch();},close:function(){if(!this.opened())return;var self=this;this.container.parents().each(function(){$(this).unbind("scroll."+self.containerId);});$(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger($.Event("close"));},clearSearch:function(){},ensureHighlightVisible:function(){var results=this.results,children,index,child,hb,rb,y,more;index=this.highlight();if(index<0)return;if(index==0){results.scrollTop(0);return;}
children=results.find(".select2-result-selectable");child=$(children[index]);hb=child.offset().top+child.outerHeight();if(index===children.length-1){more=results.find("li.select2-more-results");if(more.length>0){hb=more.offset().top+more.outerHeight();}}
rb=results.offset().top+results.outerHeight();if(hb>rb){results.scrollTop(results.scrollTop()+(hb-rb));}
y=child.offset().top-results.offset().top;if(y<0){results.scrollTop(results.scrollTop()+y);}},moveHighlight:function(delta){var choices=this.results.find(".select2-result-selectable"),index=this.highlight();while(index>-1&&index<choices.length){index+=delta;var choice=$(choices[index]);if(choice.hasClass("select2-result-selectable")&&!choice.hasClass("select2-disabled")){this.highlight(index);break;}}},highlight:function(index){var choices=this.results.find(".select2-result-selectable").not(".select2-disabled");if(arguments.length===0){return indexOf(choices.filter(".select2-highlighted")[0],choices.get());}
if(index>=choices.length)index=choices.length-1;if(index<0)index=0;choices.removeClass("select2-highlighted");$(choices[index]).addClass("select2-highlighted");this.ensureHighlightVisible();},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length;},highlightUnderEvent:function(event){var el=$(event.target).closest(".select2-result-selectable");if(el.length>0&&!el.is(".select2-highlighted")){var choices=this.results.find('.select2-result-selectable');this.highlight(choices.index(el));}else if(el.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted");}},loadMoreIfNeeded:function(){var results=this.results,more=results.find("li.select2-more-results"),below,offset=-1,page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;if(more.length===0){return;}
below=more.offset().top-results.offset().top-results.height();if(below<=0){more.addClass("select2-active");this.opts.query({term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){if(!self.opened())return;self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context});if(data.more===true){more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1));window.setTimeout(function(){self.loadMoreIfNeeded();},10);}else{more.remove();}
self.positionDropdown();self.resultsPage=page;})});}},tokenize:function(){},updateResults:function(initial){var search=this.search,results=this.results,opts=this.opts,data,self=this,input;if(initial!==true&&(this.showSearchInput===false||!this.opened())){return;}
search.addClass("select2-active");function postRender(){results.scrollTop(0);search.removeClass("select2-active");self.positionDropdown();}
function render(html){results.html(self.opts.escapeMarkup(html));postRender();}
if(opts.maximumSelectionSize>=1){data=this.data();if($.isArray(data)&&data.length>=opts.maximumSelectionSize&&checkFormatter(opts.formatSelectionTooBig,"formatSelectionTooBig")){render("<li class='select2-selection-limit'>"+opts.formatSelectionTooBig(opts.maximumSelectionSize)+"</li>");return;}}
if(search.val().length<opts.minimumInputLength&&checkFormatter(opts.formatInputTooShort,"formatInputTooShort")){render("<li class='select2-no-results'>"+opts.formatInputTooShort(search.val(),opts.minimumInputLength)+"</li>");return;}
else{render("<li class='select2-searching'>"+opts.formatSearching()+"</li>");}
input=this.tokenize();if(input!=undefined&&input!=null){search.val(input);}
this.resultsPage=1;opts.query({term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(!this.opened())return;this.context=(data.context===undefined)?null:data.context;if(this.opts.createSearchChoice&&search.val()!==""){def=this.opts.createSearchChoice.call(null,search.val(),data.results);if(def!==undefined&&def!==null&&self.id(def)!==undefined&&self.id(def)!==null){if($(data.results).filter(function(){return equal(self.id(this),self.id(def));}).length===0){data.results.unshift(def);}}}
if(data.results.length===0&&checkFormatter(opts.formatNoMatches,"formatNoMatches")){render("<li class='select2-no-results'>"+opts.formatNoMatches(search.val())+"</li>");return;}
results.empty();self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null});if(data.more===true&&checkFormatter(opts.formatLoadMore,"formatLoadMore")){results.append("<li class='select2-more-results'>"+self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){self.loadMoreIfNeeded();},10);}
this.postprocessResults(data,initial);postRender();})});},cancel:function(){this.close();},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");if(this.search[0]===document.activeElement){this.search.blur();}
this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.opts.element.triggerHandler("blur");},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val());}),10);this.opts.element.triggerHandler("focus");},selectHighlighted:function(){var index=this.highlight(),highlighted=this.results.find(".select2-highlighted").not(".select2-disabled"),data=highlighted.closest('.select2-result-selectable').data("select2-data");if(data){highlighted.addClass("select2-disabled");this.highlight(index);this.onSelect(data);}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder;},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l;if(this.opts.width==="off"){return null;}else if(this.opts.width==="element"){return this.opts.element.outerWidth()===0?'auto':this.opts.element.outerWidth()+'px';}else if(this.opts.width==="copy"||this.opts.width==="resolve"){style=this.opts.element.attr('style');if(style!==undefined){attrs=style.split(';');for(i=0,l=attrs.length;i<l;i=i+1){matches=attrs[i].replace(/\s/g,'').match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(matches!==null&&matches.length>=1)
return matches[1];}}
if(this.opts.width==="resolve"){style=this.opts.element.css('width');if(style.indexOf("%")>0)return style;return(this.opts.element.outerWidth()===0?'auto':this.opts.element.outerWidth()+'px');}
return null;}else if($.isFunction(this.opts.width)){return this.opts.width();}else{return this.opts.width;}};var width=resolveContainerWidth.call(this);if(width!==null){this.container.attr("style","width: "+width);}}});SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$("<div></div>",{"class":"select2-container"}).html(["    <a href='#' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container;},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen");},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show();},focus:function(){this.close();this.selection.focus();},isFocused:function(){return this.selection[0]===document.activeElement;},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus();},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown,clickingInside=false;this.selection=selection=container.find(".select2-choice");this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return;}
if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight((e.which===KEY.UP)?-1:1);killEvent(e);return;case KEY.TAB:case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return;}}else{if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return;}
if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return;}
this.open();if(e.which===KEY.ENTER){return;}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1");}));this.search.bind("blur",this.bind(function(){if(!this.opened())this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"));}),10);}));selection.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear();killEventImmediately(e);this.close();this.triggerChange();this.selection.focus();}));selection.bind("mousedown",this.bind(function(e){clickingInside=true;if(this.opened()){this.close();this.selection.focus();}else if(this.enabled){this.open();}
clickingInside=false;}));dropdown.bind("mousedown",this.bind(function(){this.search.focus();}));selection.bind("focus",this.bind(function(){if(this.container.hasClass("select2-container-disabled"))return false;this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1");}));selection.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");}
window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"));}),10);}));selection.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which==KEY.DOWN||e.which==KEY.UP||(e.which==KEY.ENTER&&this.opts.openOnEnter)){this.open();killEvent(e);return;}
if(e.which==KEY.DELETE||e.which==KEY.BACKSPACE){if(this.opts.allowClear){this.clear();}
killEvent(e);return;}}));selection.bind("keypress",this.bind(function(e){var key=String.fromCharCode(e.which);this.search.val(key);this.open();}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");}));},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder();},initSelection:function(){var selected;if(this.opts.element.val()===""){this.close();this.setPlaceholder();}else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){if(selected!==undefined&&selected!==null){self.updateSelection(selected);self.close();self.setPlaceholder();}});}},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()==="select"){opts.initSelection=function(element,callback){var selected=element.find(":selected");if($.isFunction(callback))
callback({id:selected.attr("value"),text:selected.text()});};}
return opts;},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.opts.element.val()===""&&placeholder!==undefined){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(placeholder));this.selection.addClass("select2-default");this.selection.find("abbr").hide();}},postprocessResults:function(data,initial){var selected=0,self=this,showSearchInput=true;this.results.find(".select2-result-selectable").each2(function(i,elm){if(equal(self.id(elm.data("select2-data")),self.opts.element.val())){selected=i;return false;}});this.highlight(selected);if(initial===true){showSearchInput=this.showSearchInput=countResults(data.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[showSearchInput?"removeClass":"addClass"]("select2-search-hidden");$(this.dropdown,this.container)[showSearchInput?"addClass":"removeClass"]("select2-with-searchbox");}},onSelect:function(data){var old=this.opts.element.val();this.opts.element.val(this.id(data));this.updateSelection(data);this.close();this.selection.focus();if(!equal(old,this.id(data))){this.triggerChange();}},updateSelection:function(data){var container=this.selection.find("span"),formatted;this.selection.data("select2-data",data);container.empty();formatted=this.opts.formatSelection(data,container);if(formatted!==undefined){container.append(this.opts.escapeMarkup(formatted));}
this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==undefined){this.selection.find("abbr").show();}},val:function(){var val,data=null,self=this;if(arguments.length===0){return this.opts.element.val();}
val=arguments[0];if(this.select){this.select.val(val).find(":selected").each2(function(i,elm){data={id:elm.attr("value"),text:elm.text()};return false;});this.updateSelection(data);this.setPlaceholder();}else{if(this.opts.initSelection===undefined){throw new Error("cannot call val() if initSelection() is not defined");}
if(!val){this.clear();return;}
this.opts.element.val(val);this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(!data?"":self.id(data));self.updateSelection(data);self.setPlaceholder();});}},clearSearch:function(){this.search.val("");},data:function(value){var data;if(arguments.length===0){data=this.selection.data("select2-data");if(data==undefined)data=null;return data;}else{if(!value||value===""){this.clear();}else{this.opts.element.val(!value?"":this.id(value));this.updateSelection(value);}}}});MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container;},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()==="select"){opts.initSelection=function(element,callback){var data=[];element.find(":selected").each2(function(i,elm){data.push({id:elm.attr("value"),text:elm.text()});});if($.isFunction(callback))
callback(data);};}
return opts;},initContainer:function(){var selector=".select2-choices",selection;this.searchContainer=this.container.find(".select2-search-field");this.selection=selection=this.container.find(selector);this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.BACKSPACE&&this.search.val()===""){this.close();var choices,selected=selection.find(".select2-search-choice-focus");if(selected.length>0){this.unselect(selected.first());this.search.width(10);killEvent(e);return;}
choices=selection.find(".select2-search-choice");if(choices.length>0){choices.last().addClass("select2-search-choice-focus");}}else{selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");}
if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight((e.which===KEY.UP)?-1:1);killEvent(e);return;case KEY.ENTER:case KEY.TAB:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return;}}
if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.BACKSPACE||e.which===KEY.ESC){return;}
if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return;}
this.open();if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.clearSearch();e.stopImmediatePropagation();}));this.container.delegate(selector,"mousedown",this.bind(function(e){if(!this.enabled)return;if($(e.target).closest(".select2-search-choice").length>0){return;}
this.clearPlaceholder();this.open();this.focusSearch();e.preventDefault();}));this.container.delegate(selector,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder();}));this.clearSearch();},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled");},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr("disabled",true);},initSelection:function(){var data;if(this.opts.element.val()===""){this.updateSelection([]);this.close();this.clearSearch();}
if(this.select||this.opts.element.val()!==""){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){if(data!==undefined&&data!==null){self.updateSelection(data);self.close();self.clearSearch();}});}},clearSearch:function(){var placeholder=this.getPlaceholder();if(placeholder!==undefined&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(placeholder).addClass("select2-default");this.resizeSearch();}else{this.search.val(" ").width(10);}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default");}else{if(this.search.val()===" ")this.search.val("");}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch();},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);},focus:function(){this.close();this.search.focus();},isFocused:function(){return this.search.hasClass("select2-focused");},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){if(indexOf(self.id(this),ids)<0){ids.push(self.id(this));filtered.push(this);}});data=filtered;this.selection.find(".select2-search-choice").remove();$(data).each(function(){self.addSelectedChoice(this);});self.postprocessResults();},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer(input,this.data(),this.bind(this.onSelect),this.opts);if(input!=null&&input!=undefined){this.search.val(input);if(input.length>0){this.open();}}},add:function(data){if(data instanceof Array){for(var i=0;i<data.length;i++){this.addSelectedChoice(data[i]);this.postprocessResults();this.clearSearch();this.search.width(10);this.triggerChange({added:data[i]});}}else{this.addSelectedChoice(data);this.postprocessResults();this.clearSearch();this.search.width(10);this.triggerChange({added:data});}},onSelect:function(data){this.addSelectedChoice(data);if(this.select){this.postprocessResults();}
if(this.opts.closeOnSelect){this.close();this.search.width(10);}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown();}else{this.close();}}
this.triggerChange({added:data});this.focusSearch();},cancel:function(){this.close();this.focusSearch();},addSelectedChoice:function(data){data.disabled=data.disabled||false;var choice=$("<li class='select2-search-choice"+(data.disabled?" select2-search-choice-disabled":"")+"'>"+"    <div></div>"+
(data.disabled?"":"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>")+"</li>"),id=this.id(data),val=this.getVal(),formatted;formatted=this.opts.formatSelection(data,choice);choice.find("div").replaceWith("<div>"+this.opts.escapeMarkup(formatted)+"</div>");if(!data.disabled){choice.find(".select2-search-choice-close").bind("mousedown",killEvent).bind("click dblclick",this.bind(function(e){if(!this.enabled)return;$(e.target).closest(".select2-search-choice").fadeOut('fast',this.bind(function(){this.unselect($(e.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch();})).dequeue();killEvent(e);})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");}));}
choice.data("select2-data",data);choice.insertBefore(this.searchContainer);val.push(id);this.setVal(val);},unselect:function(selected){var val=this.getVal(),data,index;selected=selected.closest(".select2-search-choice");if(selected.length===0){throw"Invalid argument: "+selected+". Must be .select2-search-choice";}
data=selected.data("select2-data");index=indexOf(this.id(data),val);if(index>=0){val.splice(index,1);this.setVal(val);if(this.select)this.postprocessResults();}
selected.remove();this.triggerChange({removed:data});},postprocessResults:function(){var val=this.getVal(),choices=this.results.find(".select2-result-selectable"),compound=this.results.find(".select2-result-with-children"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data("select2-data"));if(indexOf(id,val)>=0){choice.addClass("select2-disabled").removeClass("select2-result-selectable");}else{choice.removeClass("select2-disabled").addClass("select2-result-selectable");}});compound.each2(function(i,e){if(e.find(".select2-result-selectable").length==0){e.addClass("select2-disabled");}else{e.removeClass("select2-disabled");}});choices.each2(function(i,choice){if(!choice.hasClass("select2-disabled")&&choice.hasClass("select2-result-selectable")){self.highlight(0);return false;}});},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10;left=this.search.offset().left;maxWidth=this.selection.width();containerLeft=this.selection.offset().left;searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding;if(searchWidth<minimumWidth){searchWidth=maxWidth-sideBorderPadding;}
if(searchWidth<40){searchWidth=maxWidth-sideBorderPadding;}
this.search.width(searchWidth);},getVal:function(){var val;if(this.select){val=this.select.val();return val===null?[]:val;}else{val=this.opts.element.val();return splitVal(val,this.opts.separator);}},setVal:function(val){var unique;if(this.select){this.select.val(val);}else{unique=[];$(val).each(function(){if(indexOf(this,unique)<0)unique.push(this);});this.opts.element.val(unique.length===0?"":unique.join(this.opts.separator));}},val:function(){var val,data=[],self=this;if(arguments.length===0){return this.getVal();}
val=arguments[0];if(!val){this.opts.element.val("");this.updateSelection([]);this.clearSearch();return;}
this.setVal(val);if(this.select){this.select.find(":selected").each(function(){data.push({id:$(this).attr("value"),text:$(this).text()});});this.updateSelection(data);}else{if(this.opts.initSelection===undefined){throw new Error("val() cannot be called if initSelection() is not defined")}
this.opts.initSelection(this.opts.element,function(data){var ids=$(data).map(self.id);self.setVal(ids);self.updateSelection(data);self.clearSearch();});}
this.clearSearch();},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");}
this.search.width(0);this.searchContainer.hide();},onSortEnd:function(){var val=[],self=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){val.push(self.opts.id($(this).data("select2-data")));});this.setVal(val);this.triggerChange();},data:function(values){var self=this,ids;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return $(this).data("select2-data");}).get();}else{if(!values){values=[];}
ids=$.map(values,function(e){return self.opts.id(e)});this.setVal(ids);this.updateSelection(values);this.clearSearch();}}});$.fn.select2=function(){var args=Array.prototype.slice.call(arguments,0),opts,select2,value,multiple,allowedMethods=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data","add"];this.each(function(){if(args.length===0||typeof(args[0])==="object"){opts=args.length===0?{}:$.extend({},args[0]);opts.element=$(this);if(opts.element.get(0).tagName.toLowerCase()==="select"){multiple=opts.element.attr("multiple");}else{multiple=opts.multiple||false;if("tags"in opts){opts.multiple=multiple=true;}}
select2=multiple?new MultiSelect2():new SingleSelect2();select2.init(opts);}else if(typeof(args[0])==="string"){if(indexOf(args[0],allowedMethods)<0){throw"Unknown method: "+args[0];}
value=undefined;select2=$(this).data("select2");if(select2===undefined)return;if(args[0]==="container"){value=select2.container;}else{value=select2[args[0]].apply(select2,args.slice(1));}
if(value!==undefined){return false;}}else{throw"Invalid arguments to select2 plugin: "+args;}});return(value===undefined)?this:value;};$.fn.select2.defaults={width:"copy",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(result,container,query){var markup=[];markMatch(result.text,query.term,markup);return markup.join("");},formatSelection:function(data,container){return data?data.text:undefined;},formatResultCssClass:function(data){return undefined;},formatNoMatches:function(){return"No matches found";},formatInputTooShort:function(input,min){return"Please enter "+(min-input.length)+" more characters";},formatSelectionTooBig:function(limit){return"You can only select "+limit+" item"+(limit==1?"":"s");},formatLoadMore:function(pageNumber){return"Loading more results...";},formatSearching:function(){return"Searching...";},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id;},matcher:function(term,text){return text.toUpperCase().indexOf(term.toUpperCase())>=0;},separator:",",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:function(markup){if(markup&&typeof(markup)==="string"){return markup.replace(/&/g,"&amp;");}
return markup;},blurOnChange:false};window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch},"class":{"abstract":AbstractSelect2,"single":SingleSelect2,"multi":MultiSelect2}};}(jQuery));;(function($){var $window=$(window);function UTCDate(){return new Date(Date.UTC.apply(Date,arguments));}
function UTCToday(){var today=new Date();return UTCDate(today.getUTCFullYear(),today.getUTCMonth(),today.getUTCDate());}
var Datepicker=function(element,options){var that=this;this._process_options(options);this.element=$(element);this.isInline=false;this.isInput=this.element.is('input');this.component=this.element.is('.date')?this.element.find('.add-on, .btn'):false;this.hasInput=this.component&&this.element.find('input').length;if(this.component&&this.component.length===0)
this.component=false;this.picker=$(DPGlobal.template);this._buildEvents();this._attachEvents();if(this.isInline){this.picker.addClass('datepicker-inline').appendTo(this.element);}else{this.picker.addClass('datepicker-dropdown dropdown-menu');}
if(this.o.rtl){this.picker.addClass('datepicker-rtl');this.picker.find('.prev i, .next i').toggleClass('icon-arrow-left icon-arrow-right');}
this.viewMode=this.o.startView;if(this.o.calendarWeeks)
this.picker.find('tfoot th.today').attr('colspan',function(i,val){return parseInt(val)+1;});this._allow_update=false;this.setStartDate(this._o.startDate);this.setEndDate(this._o.endDate);this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);this.fillDow();this.fillMonths();this._allow_update=true;this.update();this.showMode();if(this.isInline){this.show();}};Datepicker.prototype={constructor:Datepicker,_process_options:function(opts){this._o=$.extend({},this._o,opts);var o=this.o=$.extend({},this._o);var lang=o.language;if(!dates[lang]){lang=lang.split('-')[0];if(!dates[lang])
lang=defaults.language;}
o.language=lang;switch(o.startView){case 2:case'decade':o.startView=2;break;case 1:case'year':o.startView=1;break;default:o.startView=0;}
switch(o.minViewMode){case 1:case'months':o.minViewMode=1;break;case 2:case'years':o.minViewMode=2;break;default:o.minViewMode=0;}
o.startView=Math.max(o.startView,o.minViewMode);o.weekStart%=7;o.weekEnd=((o.weekStart+6)%7);var format=DPGlobal.parseFormat(o.format);if(o.startDate!==-Infinity){if(!!o.startDate){if(o.startDate instanceof Date)
o.startDate=this._local_to_utc(this._zero_time(o.startDate));else
o.startDate=DPGlobal.parseDate(o.startDate,format,o.language);}else{o.startDate=-Infinity;}}
if(o.endDate!==Infinity){if(!!o.endDate){if(o.endDate instanceof Date)
o.endDate=this._local_to_utc(this._zero_time(o.endDate));else
o.endDate=DPGlobal.parseDate(o.endDate,format,o.language);}else{o.endDate=Infinity;}}
o.daysOfWeekDisabled=o.daysOfWeekDisabled||[];if(!$.isArray(o.daysOfWeekDisabled))
o.daysOfWeekDisabled=o.daysOfWeekDisabled.split(/[,\s]*/);o.daysOfWeekDisabled=$.map(o.daysOfWeekDisabled,function(d){return parseInt(d,10);});var plc=String(o.orientation).toLowerCase().split(/\s+/g),_plc=o.orientation.toLowerCase();plc=$.grep(plc,function(word){return(/^auto|left|right|top|bottom$/).test(word);});o.orientation={x:'auto',y:'auto'};if(!_plc||_plc==='auto');else if(plc.length===1){switch(plc[0]){case'top':case'bottom':o.orientation.y=plc[0];break;case'left':case'right':o.orientation.x=plc[0];break;}}
else{_plc=$.grep(plc,function(word){return(/^left|right$/).test(word);});o.orientation.x=_plc[0]||'auto';_plc=$.grep(plc,function(word){return(/^top|bottom$/).test(word);});o.orientation.y=_plc[0]||'auto';}},_events:[],_secondaryEvents:[],_applyEvents:function(evs){for(var i=0,el,ev;i<evs.length;i++){el=evs[i][0];ev=evs[i][1];el.on(ev);}},_unapplyEvents:function(evs){for(var i=0,el,ev;i<evs.length;i++){el=evs[i][0];ev=evs[i][1];el.off(ev);}},_buildEvents:function(){if(this.isInput){this._events=[[this.element,{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}]];}
else if(this.component&&this.hasInput){this._events=[[this.element.find('input'),{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}],[this.component,{click:$.proxy(this.show,this)}]];}
else if(this.element.is('div')){this.isInline=true;}
else{this._events=[[this.element,{click:$.proxy(this.show,this)}]];}
this._secondaryEvents=[[this.picker,{click:$.proxy(this.click,this)}],[$(window),{resize:$.proxy(this.place,this)}],[$(document),{mousedown:$.proxy(function(e){if(!(this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length)){this.hide();}},this)}]];},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events);},_detachEvents:function(){this._unapplyEvents(this._events);},_attachSecondaryEvents:function(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents);},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents);},_trigger:function(event,altdate){var date=altdate||this.date,local_date=this._utc_to_local(date);this.element.trigger({type:event,date:local_date,format:$.proxy(function(altformat){var format=altformat||this.o.format;return DPGlobal.formatDate(date,format,this.o.language);},this)});},show:function(e){if(!this.isInline)
this.picker.appendTo('body');this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();this._attachSecondaryEvents();if(e){e.preventDefault();}
this._trigger('show');},hide:function(e){if(this.isInline)return;if(!this.picker.is(':visible'))return;this.picker.hide().detach();this._detachSecondaryEvents();this.viewMode=this.o.startView;this.showMode();if(this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find('input').val()))
this.setValue();this._trigger('hide');},remove:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;if(!this.isInput){delete this.element.data().date;}},_utc_to_local:function(utc){return new Date(utc.getTime()+(utc.getTimezoneOffset()*60000));},_local_to_utc:function(local){return new Date(local.getTime()-(local.getTimezoneOffset()*60000));},_zero_time:function(local){return new Date(local.getFullYear(),local.getMonth(),local.getDate());},_zero_utc_time:function(utc){return new Date(Date.UTC(utc.getUTCFullYear(),utc.getUTCMonth(),utc.getUTCDate()));},getDate:function(){return this._utc_to_local(this.getUTCDate());},getUTCDate:function(){return this.date;},setDate:function(d){this.setUTCDate(this._local_to_utc(d));},setUTCDate:function(d){this.date=d;this.setValue();},setValue:function(){var formatted=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find('input').val(formatted).change();}}else{this.element.val(formatted).change();}},getFormattedDate:function(format){if(format===undefined)
format=this.o.format;return DPGlobal.formatDate(this.date,format,this.o.language);},setStartDate:function(startDate){this._process_options({startDate:startDate});this.update();this.updateNavArrows();},setEndDate:function(endDate){this._process_options({endDate:endDate});this.update();this.updateNavArrows();},setDaysOfWeekDisabled:function(daysOfWeekDisabled){this._process_options({daysOfWeekDisabled:daysOfWeekDisabled});this.update();this.updateNavArrows();},place:function(){if(this.isInline)return;var calendarWidth=this.picker.outerWidth(),calendarHeight=this.picker.outerHeight(),visualPadding=10,windowWidth=$window.width(),windowHeight=$window.height(),scrollTop=$window.scrollTop();var zIndex=parseInt(this.element.parents().filter(function(){return $(this).css('z-index')!='auto';}).first().css('z-index'))+10;var offset=this.component?this.component.parent().offset():this.element.offset();var height=this.component?this.component.outerHeight(true):this.element.outerHeight(false);var width=this.component?this.component.outerWidth(true):this.element.outerWidth(false);var left=offset.left,top=offset.top;this.picker.removeClass('datepicker-orient-top datepicker-orient-bottom '+'datepicker-orient-right datepicker-orient-left');if(this.o.orientation.x!=='auto'){this.picker.addClass('datepicker-orient-'+this.o.orientation.x);if(this.o.orientation.x==='right')
left-=calendarWidth-width;}
else{this.picker.addClass('datepicker-orient-left');if(offset.left<0)
left-=offset.left-visualPadding;else if(offset.left+calendarWidth>windowWidth)
left=windowWidth-calendarWidth-visualPadding;}
var yorient=this.o.orientation.y,top_overflow,bottom_overflow;if(yorient==='auto'){top_overflow=-scrollTop+offset.top-calendarHeight;bottom_overflow=scrollTop+windowHeight-(offset.top+height+calendarHeight);if(Math.max(top_overflow,bottom_overflow)===bottom_overflow)
yorient='top';else
yorient='bottom';}
this.picker.addClass('datepicker-orient-'+yorient);if(yorient==='top')
top+=height;else
top-=calendarHeight+parseInt(this.picker.css('padding-top'));this.picker.css({top:top,left:left,zIndex:zIndex});},_allow_update:true,update:function(){if(!this._allow_update)return;var oldDate=new Date(this.date),date,fromArgs=false;if(arguments&&arguments.length&&(typeof arguments[0]==='string'||arguments[0]instanceof Date)){date=arguments[0];if(date instanceof Date)
date=this._local_to_utc(date);fromArgs=true;}else{date=this.isInput?this.element.val():this.element.data('date')||this.element.find('input').val();delete this.element.data().date;}
this.date=DPGlobal.parseDate(date,this.o.format,this.o.language);if(fromArgs){this.setValue();}else if(date){if(oldDate.getTime()!==this.date.getTime())
this._trigger('changeDate');}else{this._trigger('clearDate');}
if(this.date<this.o.startDate){this.viewDate=new Date(this.o.startDate);this.date=new Date(this.o.startDate);}else if(this.date>this.o.endDate){this.viewDate=new Date(this.o.endDate);this.date=new Date(this.o.endDate);}else{this.viewDate=new Date(this.date);this.date=new Date(this.date);}
this.fill();},fillDow:function(){var dowCnt=this.o.weekStart,html='<tr>';if(this.o.calendarWeeks){var cell='<th class="cw">&nbsp;</th>';html+=cell;this.picker.find('.datepicker-days thead tr:first-child').prepend(cell);}
while(dowCnt<this.o.weekStart+7){html+='<th class="dow">'+dates[this.o.language].daysMin[(dowCnt++)%7]+'</th>';}
html+='</tr>';this.picker.find('.datepicker-days thead').append(html);},fillMonths:function(){var html='',i=0;while(i<12){html+='<span class="month">'+dates[this.o.language].monthsShort[i++]+'</span>';}
this.picker.find('.datepicker-months td').html(html);},setRange:function(range){if(!range||!range.length)
delete this.range;else
this.range=$.map(range,function(d){return d.valueOf();});this.fill();},getClassNames:function(date){var cls=[],year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth(),currentDate=this.date.valueOf(),today=new Date();if(date.getUTCFullYear()<year||(date.getUTCFullYear()==year&&date.getUTCMonth()<month)){cls.push('old');}else if(date.getUTCFullYear()>year||(date.getUTCFullYear()==year&&date.getUTCMonth()>month)){cls.push('new');}
if(this.o.todayHighlight&&date.getUTCFullYear()==today.getFullYear()&&date.getUTCMonth()==today.getMonth()&&date.getUTCDate()==today.getDate()){cls.push('today');}
if(currentDate&&date.valueOf()==currentDate){cls.push('active');}
if(date.valueOf()<this.o.startDate||date.valueOf()>this.o.endDate||$.inArray(date.getUTCDay(),this.o.daysOfWeekDisabled)!==-1){cls.push('disabled');}
if(this.range){if(date>this.range[0]&&date<this.range[this.range.length-1]){cls.push('range');}
if($.inArray(date.valueOf(),this.range)!=-1){cls.push('selected');}}
return cls;},fill:function(){var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth(),startYear=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,startMonth=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,endYear=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,endMonth=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,currentDate=this.date&&this.date.valueOf(),tooltip;this.picker.find('.datepicker-days thead th.datepicker-switch').text(dates[this.o.language].months[month]+' '+year);this.picker.find('tfoot th.today').text(dates[this.o.language].today).toggle(this.o.todayBtn!==false);this.picker.find('tfoot th.clear').text(dates[this.o.language].clear).toggle(this.o.clearBtn!==false);this.updateNavArrows();this.fillMonths();var prevMonth=UTCDate(year,month-1,28,0,0,0,0),day=DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(),prevMonth.getUTCMonth());prevMonth.setUTCDate(day);prevMonth.setUTCDate(day-(prevMonth.getUTCDay()-this.o.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setUTCDate(nextMonth.getUTCDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getUTCDay()==this.o.weekStart){html.push('<tr>');if(this.o.calendarWeeks){var
ws=new Date(+prevMonth+(this.o.weekStart-prevMonth.getUTCDay()-7)%7*864e5),th=new Date(+ws+(7+4-ws.getUTCDay())%7*864e5),yth=new Date(+(yth=UTCDate(th.getUTCFullYear(),0,1))+(7+4-yth.getUTCDay())%7*864e5),calWeek=(th-yth)/864e5/7+1;html.push('<td class="cw">'+calWeek+'</td>');}}
clsName=this.getClassNames(prevMonth);clsName.push('day');if(this.o.beforeShowDay!==$.noop){var before=this.o.beforeShowDay(this._utc_to_local(prevMonth));if(before===undefined)
before={};else if(typeof(before)==='boolean')
before={enabled:before};else if(typeof(before)==='string')
before={classes:before};if(before.enabled===false)
clsName.push('disabled');if(before.classes)
clsName=clsName.concat(before.classes.split(/\s+/));if(before.tooltip)
tooltip=before.tooltip;}
clsName=$.unique(clsName);html.push('<td class="'+clsName.join(' ')+'"'+(tooltip?' title="'+tooltip+'"':'')+'>'+prevMonth.getUTCDate()+'</td>');if(prevMonth.getUTCDay()==this.o.weekEnd){html.push('</tr>');}
prevMonth.setUTCDate(prevMonth.getUTCDate()+1);}
this.picker.find('.datepicker-days tbody').empty().append(html.join(''));var currentYear=this.date&&this.date.getUTCFullYear();var months=this.picker.find('.datepicker-months').find('th:eq(1)').text(year).end().find('span').removeClass('active');if(currentYear&&currentYear==year){months.eq(this.date.getUTCMonth()).addClass('active');}
if(year<startYear||year>endYear){months.addClass('disabled');}
if(year==startYear){months.slice(0,startMonth).addClass('disabled');}
if(year==endYear){months.slice(endMonth+1).addClass('disabled');}
html='';year=parseInt(year/10,10)*10;var yearCont=this.picker.find('.datepicker-years').find('th:eq(1)').text(year+'-'+(year+9)).end().find('td');year-=1;for(var i=-1;i<11;i++){html+='<span class="year'+(i==-1?' old':i==10?' new':'')+(currentYear==year?' active':'')+(year<startYear||year>endYear?' disabled':'')+'">'+year+'</span>';year+=1;}
yearCont.html(html);},updateNavArrows:function(){if(!this._allow_update)return;var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth();switch(this.viewMode){case 0:if(this.o.startDate!==-Infinity&&year<=this.o.startDate.getUTCFullYear()&&month<=this.o.startDate.getUTCMonth()){this.picker.find('.prev').css({visibility:'hidden'});}else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.o.endDate!==Infinity&&year>=this.o.endDate.getUTCFullYear()&&month>=this.o.endDate.getUTCMonth()){this.picker.find('.next').css({visibility:'hidden'});}else{this.picker.find('.next').css({visibility:'visible'});}
break;case 1:case 2:if(this.o.startDate!==-Infinity&&year<=this.o.startDate.getUTCFullYear()){this.picker.find('.prev').css({visibility:'hidden'});}else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.o.endDate!==Infinity&&year>=this.o.endDate.getUTCFullYear()){this.picker.find('.next').css({visibility:'hidden'});}else{this.picker.find('.next').css({visibility:'visible'});}
break;}},click:function(e){e.preventDefault();var target=$(e.target).closest('span, td, th');if(target.length==1){switch(target[0].nodeName.toLowerCase()){case'th':switch(target[0].className){case'datepicker-switch':this.showMode(1);break;case'prev':case'next':var dir=DPGlobal.modes[this.viewMode].navStep*(target[0].className=='prev'?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,dir);this._trigger('changeMonth',this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,dir);if(this.viewMode===1)
this._trigger('changeYear',this.viewDate);break;}
this.fill();break;case'today':var date=new Date();date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);this.showMode(-2);var which=this.o.todayBtn=='linked'?null:'view';this._setDate(date,which);break;case'clear':var element;if(this.isInput)
element=this.element;else if(this.component)
element=this.element.find('input');if(element)
element.val("").change();this._trigger('clearDate');this.update();if(this.o.autoclose)
this.hide();break;}
break;case'span':if(!target.is('.disabled')){this.viewDate.setUTCDate(1);if(target.is('.month')){var day=1;var month=target.parent().find('span').index(target);var year=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(month);this._trigger('changeMonth',this.viewDate);if(this.o.minViewMode===1){this._setDate(UTCDate(year,month,day,0,0,0,0));}}else{var year=parseInt(target.text(),10)||0;var day=1;var month=0;this.viewDate.setUTCFullYear(year);this._trigger('changeYear',this.viewDate);if(this.o.minViewMode===2){this._setDate(UTCDate(year,month,day,0,0,0,0));}}
this.showMode(-1);this.fill();}
break;case'td':if(target.is('.day')&&!target.is('.disabled')){var day=parseInt(target.text(),10)||1;var year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth();if(target.is('.old')){if(month===0){month=11;year-=1;}else{month-=1;}}else if(target.is('.new')){if(month==11){month=0;year+=1;}else{month+=1;}}
this._setDate(UTCDate(year,month,day,0,0,0,0));}
break;}}},_setDate:function(date,which){if(!which||which=='date')
this.date=new Date(date);if(!which||which=='view')
this.viewDate=new Date(date);this.fill();this.setValue();this._trigger('changeDate');var element;if(this.isInput){element=this.element;}else if(this.component){element=this.element.find('input');}
if(element){element.change();}
if(this.o.autoclose&&(!which||which=='date')){this.hide();}},moveMonth:function(date,dir){if(!dir)return date;var new_date=new Date(date.valueOf()),day=new_date.getUTCDate(),month=new_date.getUTCMonth(),mag=Math.abs(dir),new_month,test;dir=dir>0?1:-1;if(mag==1){test=dir==-1?function(){return new_date.getUTCMonth()==month;}:function(){return new_date.getUTCMonth()!=new_month;};new_month=month+dir;new_date.setUTCMonth(new_month);if(new_month<0||new_month>11)
new_month=(new_month+12)%12;}else{for(var i=0;i<mag;i++)
new_date=this.moveMonth(new_date,dir);new_month=new_date.getUTCMonth();new_date.setUTCDate(day);test=function(){return new_month!=new_date.getUTCMonth();};}
while(test()){new_date.setUTCDate(--day);new_date.setUTCMonth(new_month);}
return new_date;},moveYear:function(date,dir){return this.moveMonth(date,dir*12);},dateWithinRange:function(date){return date>=this.o.startDate&&date<=this.o.endDate;},keydown:function(e){if(this.picker.is(':not(:visible)')){if(e.keyCode==27)
this.show();return;}
var dateChanged=false,dir,day,month,newDate,newViewDate;switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;dir=e.keyCode==37?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir);this._trigger('changeYear',this.viewDate);}else if(e.shiftKey){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir);this._trigger('changeMonth',this.viewDate);}else{newDate=new Date(this.date);newDate.setUTCDate(this.date.getUTCDate()+dir);newViewDate=new Date(this.viewDate);newViewDate.setUTCDate(this.viewDate.getUTCDate()+dir);}
if(this.dateWithinRange(newDate)){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();e.preventDefault();dateChanged=true;}
break;case 38:case 40:if(!this.o.keyboardNavigation)break;dir=e.keyCode==38?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir);this._trigger('changeYear',this.viewDate);}else if(e.shiftKey){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir);this._trigger('changeMonth',this.viewDate);}else{newDate=new Date(this.date);newDate.setUTCDate(this.date.getUTCDate()+dir*7);newViewDate=new Date(this.viewDate);newViewDate.setUTCDate(this.viewDate.getUTCDate()+dir*7);}
if(this.dateWithinRange(newDate)){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();e.preventDefault();dateChanged=true;}
break;case 13:this.hide();e.preventDefault();break;case 9:this.hide();break;}
if(dateChanged){this._trigger('changeDate');var element;if(this.isInput){element=this.element;}else if(this.component){element=this.element.find('input');}
if(element){element.change();}}},showMode:function(dir){if(dir){this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+dir));}
this.picker.find('>div').hide().filter('.datepicker-'+DPGlobal.modes[this.viewMode].clsName).css('display','block');this.updateNavArrows();}};var DateRangePicker=function(element,options){this.element=$(element);this.inputs=$.map(options.inputs,function(i){return i.jquery?i[0]:i;});delete options.inputs;$(this.inputs).datepicker(options).bind('changeDate',$.proxy(this.dateUpdated,this));this.pickers=$.map(this.inputs,function(i){return $(i).data('datepicker');});this.updateDates();};DateRangePicker.prototype={updateDates:function(){this.dates=$.map(this.pickers,function(i){return i.date;});this.updateRanges();},updateRanges:function(){var range=$.map(this.dates,function(d){return d.valueOf();});$.each(this.pickers,function(i,p){p.setRange(range);});},dateUpdated:function(e){var dp=$(e.target).data('datepicker'),new_date=dp.getUTCDate(),i=$.inArray(e.target,this.inputs),l=this.inputs.length;if(i==-1)return;if(new_date<this.dates[i]){while(i>=0&&new_date<this.dates[i]){this.pickers[i--].setUTCDate(new_date);}}
else if(new_date>this.dates[i]){while(i<l&&new_date>this.dates[i]){this.pickers[i++].setUTCDate(new_date);}}
this.updateDates();},remove:function(){$.map(this.pickers,function(p){p.remove();});delete this.element.data().datepicker;}};function opts_from_el(el,prefix){var data=$(el).data(),out={},inkey,replace=new RegExp('^'+prefix.toLowerCase()+'([A-Z])'),prefix=new RegExp('^'+prefix.toLowerCase());for(var key in data)
if(prefix.test(key)){inkey=key.replace(replace,function(_,a){return a.toLowerCase();});out[inkey]=data[key];}
return out;}
function opts_from_locale(lang){var out={};if(!dates[lang]){lang=lang.split('-')[0]
if(!dates[lang])
return;}
var d=dates[lang];$.each(locale_opts,function(i,k){if(k in d)
out[k]=d[k];});return out;}
var old=$.fn.datepicker;$.fn.datepicker=function(option){var args=Array.apply(null,arguments);args.shift();var internal_return,this_return;this.each(function(){var $this=$(this),data=$this.data('datepicker'),options=typeof option=='object'&&option;if(!data){var elopts=opts_from_el(this,'date'),xopts=$.extend({},defaults,elopts,options),locopts=opts_from_locale(xopts.language),opts=$.extend({},defaults,locopts,elopts,options);if($this.is('.input-daterange')||opts.inputs){var ropts={inputs:opts.inputs||$this.find('input').toArray()};$this.data('datepicker',(data=new DateRangePicker(this,$.extend(opts,ropts))));}
else{$this.data('datepicker',(data=new Datepicker(this,opts)));}}
if(typeof option=='string'&&typeof data[option]=='function'){internal_return=data[option].apply(data,args);if(internal_return!==undefined)
return false;}});if(internal_return!==undefined)
return internal_return;else
return this;};var defaults=$.fn.datepicker.defaults={autoclose:false,beforeShowDay:$.noop,calendarWeeks:false,clearBtn:false,daysOfWeekDisabled:[],endDate:Infinity,forceParse:true,format:'mm/dd/yyyy',keyboardNavigation:true,language:'en',minViewMode:0,orientation:"auto",rtl:false,startDate:-Infinity,startView:0,todayBtn:false,todayHighlight:false,weekStart:0};var locale_opts=$.fn.datepicker.locale_opts=['format','rtl','weekStart'];$.fn.datepicker.Constructor=Datepicker;var dates=$.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}};var DPGlobal={modes:[{clsName:'days',navFnc:'Month',navStep:1},{clsName:'months',navFnc:'FullYear',navStep:1},{clsName:'years',navFnc:'FullYear',navStep:10}],isLeapYear:function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0));},getDaysInMonth:function(year,month){return[31,(DPGlobal.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(format){var separators=format.replace(this.validParts,'\0').split('\0'),parts=format.match(this.validParts);if(!separators||!separators.length||!parts||parts.length===0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};},parseDate:function(date,format,language){if(date instanceof Date)return date;if(typeof format==='string')
format=DPGlobal.parseFormat(format);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(date)){var part_re=/([\-+]\d+)([dmwy])/,parts=date.match(/([\-+]\d+)([dmwy])/g),part,dir;date=new Date();for(var i=0;i<parts.length;i++){part=part_re.exec(parts[i]);dir=parseInt(part[1]);switch(part[2]){case'd':date.setUTCDate(date.getUTCDate()+dir);break;case'm':date=Datepicker.prototype.moveMonth.call(Datepicker.prototype,date,dir);break;case'w':date.setUTCDate(date.getUTCDate()+dir*7);break;case'y':date=Datepicker.prototype.moveYear.call(Datepicker.prototype,date,dir);break;}}
return UTCDate(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),0,0,0);}
var parts=date&&date.match(this.nonpunctuation)||[],date=new Date(),parsed={},setters_order=['yyyy','yy','M','MM','m','mm','d','dd'],setters_map={yyyy:function(d,v){return d.setUTCFullYear(v);},yy:function(d,v){return d.setUTCFullYear(2000+v);},m:function(d,v){if(isNaN(d))
return d;v-=1;while(v<0)v+=12;v%=12;d.setUTCMonth(v);while(d.getUTCMonth()!=v)
d.setUTCDate(d.getUTCDate()-1);return d;},d:function(d,v){return d.setUTCDate(v);}},val,filtered,part;setters_map['M']=setters_map['MM']=setters_map['mm']=setters_map['m'];setters_map['dd']=setters_map['d'];date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);var fparts=format.parts.slice();if(parts.length!=fparts.length){fparts=$(fparts).filter(function(i,p){return $.inArray(p,setters_order)!==-1;}).toArray();}
if(parts.length==fparts.length){for(var i=0,cnt=fparts.length;i<cnt;i++){val=parseInt(parts[i],10);part=fparts[i];if(isNaN(val)){switch(part){case'MM':filtered=$(dates[language].months).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p;});val=$.inArray(filtered[0],dates[language].months)+1;break;case'M':filtered=$(dates[language].monthsShort).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p;});val=$.inArray(filtered[0],dates[language].monthsShort)+1;break;}}
parsed[part]=val;}
for(var i=0,_date,s;i<setters_order.length;i++){s=setters_order[i];if(s in parsed&&!isNaN(parsed[s])){_date=new Date(date);setters_map[s](_date,parsed[s]);if(!isNaN(_date))
date=_date;}}}
return date;},formatDate:function(date,format,language){if(typeof format==='string')
format=DPGlobal.parseFormat(format);var val={d:date.getUTCDate(),D:dates[language].daysShort[date.getUTCDay()],DD:dates[language].days[date.getUTCDay()],m:date.getUTCMonth()+1,M:dates[language].monthsShort[date.getUTCMonth()],MM:dates[language].months[date.getUTCMonth()],yy:date.getUTCFullYear().toString().substring(2),yyyy:date.getUTCFullYear()};val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;var date=[],seps=$.extend([],format.separators);for(var i=0,cnt=format.parts.length;i<=cnt;i++){if(seps.length)
date.push(seps.shift());date.push(val[format.parts[i]]);}
return date.join('');},headTemplate:'<thead>'+'<tr>'+'<th class="prev">&laquo;</th>'+'<th colspan="5" class="datepicker-switch"></th>'+'<th class="next">&raquo;</th>'+'</tr>'+'</thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};DPGlobal.template='<div class="datepicker">'+'<div class="datepicker-days">'+'<table class=" table-condensed">'+
DPGlobal.headTemplate+'<tbody></tbody>'+
DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datepicker-months">'+'<table class="table-condensed">'+
DPGlobal.headTemplate+
DPGlobal.contTemplate+
DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datepicker-years">'+'<table class="table-condensed">'+
DPGlobal.headTemplate+
DPGlobal.contTemplate+
DPGlobal.footTemplate+'</table>'+'</div>'+'</div>';$.fn.datepicker.DPGlobal=DPGlobal;$.fn.datepicker.noConflict=function(){$.fn.datepicker=old;return this;};$(document).on('focus.datepicker.data-api click.datepicker.data-api','[data-provide="datepicker"]',function(e){var $this=$(this);if($this.data('datepicker'))return;e.preventDefault();$this.datepicker('show');});$(function(){$('[data-provide="datepicker-inline"]').datepicker();});}(window.jQuery));;!function($){"use strict";var Timepicker=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.timepicker.defaults,options,this.$element.data());this.minuteStep=this.options.minuteStep||this.minuteStep;this.secondStep=this.options.secondStep||this.secondStep;this.showMeridian=this.options.showMeridian||this.showMeridian;this.showSeconds=this.options.showSeconds||this.showSeconds;this.showInputs=this.options.showInputs||this.showInputs;this.disableFocus=this.options.disableFocus||this.disableFocus;this.template=this.options.template||this.template;this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop;this.defaultTime=this.options.defaultTime||this.defaultTime;this.open=false;this.init();};Timepicker.prototype={constructor:Timepicker,init:function(){if(this.$element.parent().hasClass('input-append')){this.$element.parent('.input-append').find('.add-on').on('click',$.proxy(this.showWidget,this));this.$element.on({focus:$.proxy(this.highlightUnit,this),click:$.proxy(this.highlightUnit,this),keypress:$.proxy(this.elementKeypress,this),blur:$.proxy(this.blurElement,this)});}else{if(this.template){this.$element.on({focus:$.proxy(this.showWidget,this),click:$.proxy(this.showWidget,this),blur:$.proxy(this.blurElement,this)});}else{this.$element.on({focus:$.proxy(this.highlightUnit,this),click:$.proxy(this.highlightUnit,this),keypress:$.proxy(this.elementKeypress,this),blur:$.proxy(this.blurElement,this)});}}
this.$widget=$(this.getTemplate()).appendTo('body');this.$widget.on('click',$.proxy(this.widgetClick,this));if(this.showInputs){this.$widget.find('input').on({click:function(){this.select();},keypress:$.proxy(this.widgetKeypress,this),change:$.proxy(this.updateFromWidgetInputs,this)});}
this.setDefaultTime(this.defaultTime);},showWidget:function(e){e.stopPropagation();e.preventDefault();if(this.open){return;}
this.$element.trigger('show');if(this.disableFocus){this.$element.blur();}
var pos=$.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.updateFromElementVal();$('html').trigger('click.timepicker.data-api').one('click.timepicker.data-api',$.proxy(this.hideWidget,this));if(this.template==='modal'){this.$widget.modal('show').on('hidden',$.proxy(this.hideWidget,this));}else{this.$widget.css({top:pos.top+pos.height,left:pos.left})
if(!this.open){this.$widget.addClass('open');}}
this.open=true;this.$element.trigger('shown');},hideWidget:function(){this.$element.trigger('hide');if(this.template==='modal'){this.$widget.modal('hide');}else{this.$widget.removeClass('open');}
this.open=false;this.$element.trigger('hidden');},widgetClick:function(e){e.stopPropagation();e.preventDefault();var action=$(e.target).closest('a').data('action');if(action){this[action]();this.update();}},widgetKeypress:function(e){var input=$(e.target).closest('input').attr('name');switch(e.keyCode){case 9:if(this.showMeridian){if(input=='meridian'){this.hideWidget();}}else{if(this.showSeconds){if(input=='second'){this.hideWidget();}}else{if(input=='minute'){this.hideWidget();}}}
break;case 27:this.hideWidget();break;case 38:switch(input){case'hour':this.incrementHour();break;case'minute':this.incrementMinute();break;case'second':this.incrementSecond();break;case'meridian':this.toggleMeridian();break;}
this.update();break;case 40:switch(input){case'hour':this.decrementHour();break;case'minute':this.decrementMinute();break;case'second':this.decrementSecond();break;case'meridian':this.toggleMeridian();break;}
this.update();break;}},elementKeypress:function(e){var input=this.$element.get(0);switch(e.keyCode){case 0:break;case 9:this.updateFromElementVal();if(this.showMeridian){if(this.highlightedUnit!='meridian'){e.preventDefault();this.highlightNextUnit();}}else{if(this.showSeconds){if(this.highlightedUnit!='second'){e.preventDefault();this.highlightNextUnit();}}else{if(this.highlightedUnit!='minute'){e.preventDefault();this.highlightNextUnit();}}}
break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal();this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case'hour':this.incrementHour();break;case'minute':this.incrementMinute();break;case'second':this.incrementSecond();break;case'meridian':this.toggleMeridian();break;}
this.updateElement();break;case 39:this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case'hour':this.decrementHour();break;case'minute':this.decrementMinute();break;case'second':this.decrementSecond();break;case'meridian':this.toggleMeridian();break;}
this.updateElement();break;}
if(e.keyCode!==0&&e.keyCode!==8&&e.keyCode!==9&&e.keyCode!==46){e.preventDefault();}},setValues:function(time){if(this.showMeridian){var arr=time.split(' ');var timeArray=arr[0].split(':');this.meridian=arr[1];}else{var timeArray=time.split(':');}
this.hour=parseInt(timeArray[0],10);this.minute=parseInt(timeArray[1],10);this.second=parseInt(timeArray[2],10);if(isNaN(this.hour)){this.hour=0;}
if(isNaN(this.minute)){this.minute=0;}
if(this.showMeridian){if(this.hour>12){this.hour=12;}else if(this.hour<1){this.hour=1;}
if(this.meridian=='am'||this.meridian=='a'){this.meridian='AM';}else if(this.meridian=='pm'||this.meridian=='p'){this.meridian='PM';}
if(this.meridian!='AM'&&this.meridian!='PM'){this.meridian='AM';}}else{if(this.hour>=24){this.hour=23;}else if(this.hour<0){this.hour=0;}}
if(this.minute<0){this.minute=0;}else if(this.minute>=60){this.minute=59;}
if(this.showSeconds){if(isNaN(this.second)){this.second=0;}else if(this.second<0){this.second=0;}else if(this.second>=60){this.second=59;}}
this.updateElement();this.updateWidget();},setMeridian:function(meridian){if(meridian=='a'||meridian=='am'||meridian=='AM'){this.meridian='AM';}else if(meridian=='p'||meridian=='pm'||meridian=='PM'){this.meridian='PM';}else{this.updateWidget();}
this.updateElement();},setDefaultTime:function(defaultTime){if(defaultTime){if(defaultTime==='current'){var dTime=new Date();var hours=dTime.getHours();var minutes=Math.floor(dTime.getMinutes()/this.minuteStep)*this.minuteStep;var seconds=Math.floor(dTime.getSeconds()/this.secondStep)*this.secondStep;var meridian="AM";if(this.showMeridian){if(hours===0){hours=12;}else if(hours>=12){if(hours>12){hours=hours-12;}
meridian="PM";}else{meridian="AM";}}
this.hour=hours;this.minute=minutes;this.second=seconds;this.meridian=meridian;}else if(defaultTime==='value'){this.setValues(this.$element.val());}else{this.setValues(defaultTime);}
this.update();}else{this.hour=0;this.minute=0;this.second=0;}},formatTime:function(hour,minute,second,meridian){hour=hour<10?'0'+hour:hour;minute=minute<10?'0'+minute:minute;second=second<10?'0'+second:second;return hour+':'+minute+(this.showSeconds?':'+second:'')+(this.showMeridian?' '+meridian:'');},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian);},setTime:function(time){this.setValues(time);this.update();},update:function(){this.updateElement();this.updateWidget();},blurElement:function(){this.highlightedUnit=undefined;this.updateFromElementVal();},updateElement:function(){var time=this.getTime();this.$element.val(time).change();switch(this.highlightedUnit){case'hour':this.highlightHour();break;case'minute':this.highlightMinute();break;case'second':this.highlightSecond();break;case'meridian':this.highlightMeridian();break;}},updateWidget:function(){if(this.showInputs){this.$widget.find('input.bootstrap-timepicker-hour').val(this.hour<10?'0'+this.hour:this.hour);this.$widget.find('input.bootstrap-timepicker-minute').val(this.minute<10?'0'+this.minute:this.minute);if(this.showSeconds){this.$widget.find('input.bootstrap-timepicker-second').val(this.second<10?'0'+this.second:this.second);}
if(this.showMeridian){this.$widget.find('input.bootstrap-timepicker-meridian').val(this.meridian);}}else{this.$widget.find('span.bootstrap-timepicker-hour').text(this.hour);this.$widget.find('span.bootstrap-timepicker-minute').text(this.minute<10?'0'+this.minute:this.minute);if(this.showSeconds){this.$widget.find('span.bootstrap-timepicker-second').text(this.second<10?'0'+this.second:this.second);}
if(this.showMeridian){this.$widget.find('span.bootstrap-timepicker-meridian').text(this.meridian);}}},updateFromElementVal:function(e){var time=this.$element.val();if(time){this.setValues(time);this.updateWidget();}},updateFromWidgetInputs:function(){var time=$('input.bootstrap-timepicker-hour',this.$widget).val()+':'+
$('input.bootstrap-timepicker-minute',this.$widget).val()+
(this.showSeconds?':'+$('input.bootstrap-timepicker-second',this.$widget).val():'')+
(this.showMeridian?' '+$('input.bootstrap-timepicker-meridian',this.$widget).val():'');this.setValues(time);},getCursorPosition:function(){var input=this.$element.get(0);if('selectionStart'in input){return input.selectionStart;}else if(document.selection){input.focus();var sel=document.selection.createRange();var selLen=document.selection.createRange().text.length;sel.moveStart('character',-input.value.length);return sel.text.length-selLen;}},highlightUnit:function(){var input=this.$element.get(0);this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour();}else if(this.position>=3&&this.position<=5){this.highlightMinute();}else if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond();}else{this.highlightMeridian();}}else if(this.position>=9&&this.position<=11){this.highlightMeridian();}},highlightNextUnit:function(){switch(this.highlightedUnit){case'hour':this.highlightMinute();break;case'minute':if(this.showSeconds){this.highlightSecond();}else{this.highlightMeridian();}
break;case'second':this.highlightMeridian();break;case'meridian':this.highlightHour();break;}},highlightPrevUnit:function(){switch(this.highlightedUnit){case'hour':this.highlightMeridian();break;case'minute':this.highlightHour();break;case'second':this.highlightMinute();break;case'meridian':if(this.showSeconds){this.highlightSecond();}else{this.highlightMinute();}
break;}},highlightHour:function(){this.highlightedUnit='hour';this.$element.get(0).setSelectionRange(0,2);},highlightMinute:function(){this.highlightedUnit='minute';this.$element.get(0).setSelectionRange(3,5);},highlightSecond:function(){this.highlightedUnit='second';this.$element.get(0).setSelectionRange(6,8);},highlightMeridian:function(){this.highlightedUnit='meridian';if(this.showSeconds){this.$element.get(0).setSelectionRange(9,11);}else{this.$element.get(0).setSelectionRange(6,8);}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.toggleMeridian();}else if(this.hour===12){return this.hour=1;}}
if(this.hour===23){return this.hour=0;}
this.hour=this.hour+1;},decrementHour:function(){if(this.showMeridian){if(this.hour===1){return this.hour=12;}
else if(this.hour===12){this.toggleMeridian();}}
if(this.hour===0){return this.hour=23;}
this.hour=this.hour-1;},incrementMinute:function(){var newVal=this.minute+this.minuteStep-(this.minute%this.minuteStep);if(newVal>59){this.incrementHour();this.minute=newVal-60;}else{this.minute=newVal;}},decrementMinute:function(){var newVal=this.minute-this.minuteStep;if(newVal<0){this.decrementHour();this.minute=newVal+60;}else{this.minute=newVal;}},incrementSecond:function(){var newVal=this.second+this.secondStep-(this.second%this.secondStep);if(newVal>59){this.incrementMinute();this.second=newVal-60;}else{this.second=newVal;}},decrementSecond:function(){var newVal=this.second-this.secondStep;if(newVal<0){this.decrementMinute();this.second=newVal+60;}else{this.second=newVal;}},toggleMeridian:function(){this.meridian=this.meridian==='AM'?'PM':'AM';this.update();},getTemplate:function(){if(this.options.templates[this.options.template]){return this.options.templates[this.options.template];}
if(this.showInputs){var hourTemplate='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';var minuteTemplate='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';var secondTemplate='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';var meridianTemplate='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>';}else{var hourTemplate='<span class="bootstrap-timepicker-hour"></span>';var minuteTemplate='<span class="bootstrap-timepicker-minute"></span>';var secondTemplate='<span class="bootstrap-timepicker-second"></span>';var meridianTemplate='<span class="bootstrap-timepicker-meridian"></span>';}
var templateContent='<table class="'+(this.showSeconds?'show-seconds':'')+' '+(this.showMeridian?'show-meridian':'')+'">'+'<tr>'+'<td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td>'+'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+
(this.showSeconds?'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>':'')+
(this.showMeridian?'<td class="separator">&nbsp;</td>'+'<td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>':'')+'</tr>'+'<tr>'+'<td>'+hourTemplate+'</td> '+'<td class="separator">:</td>'+'<td>'+minuteTemplate+'</td> '+
(this.showSeconds?'<td class="separator">:</td>'+'<td>'+secondTemplate+'</td>':'')+
(this.showMeridian?'<td class="separator">&nbsp;</td>'+'<td>'+meridianTemplate+'</td>':'')+'</tr>'+'<tr>'+'<td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td>'+'<td class="separator"></td>'+'<td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+
(this.showSeconds?'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>':'')+
(this.showMeridian?'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>':'')+'</tr>'+'</table>';var template;switch(this.options.template){case'modal':template='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?'true':'false')+'">'+'<div class="modal-header">'+'<a href="#" class="close" data-dismiss="modal"></a>'+'<h3>Pick a Time</h3>'+'</div>'+'<div class="modal-content">'+
templateContent+'</div>'+'<div class="modal-footer">'+'<a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a>'+'</div>'+'</div>';break;case'dropdown':template='<div class="bootstrap-timepicker dropdown-menu">'+
templateContent+'</div>';break;}
return template;}};$.fn.timepicker=function(option){return this.each(function(){var $this=$(this),data=$this.data('timepicker'),options=typeof option=='object'&&option;if(!data){$this.data('timepicker',(data=new Timepicker(this,options)));}
if(typeof option=='string'){data[option]();}})}
$.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:false,defaultTime:'current',showSeconds:false,showInputs:true,showMeridian:true,template:'dropdown',modalBackdrop:false,templates:{}}
$.fn.timepicker.Constructor=Timepicker}(window.jQuery);;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(exports){exports.name="mustache.js";exports.version="0.5.0-dev";exports.tags=["{{","}}"];exports.parse=parse;exports.compile=compile;exports.render=render;exports.clearCache=clearCache;exports.to_html=function(template,view,partials,send){var result=render(template,view,partials);if(typeof send==="function"){send(result);}else{return result;}};var _toString=Object.prototype.toString;var _isArray=Array.isArray;var _forEach=Array.prototype.forEach;var _trim=String.prototype.trim;var isArray;if(_isArray){isArray=_isArray;}else{isArray=function(obj){return _toString.call(obj)==="[object Array]";};}
var forEach;if(_forEach){forEach=function(obj,callback,scope){return _forEach.call(obj,callback,scope);};}else{forEach=function(obj,callback,scope){for(var i=0,len=obj.length;i<len;++i){callback.call(scope,obj[i],i,obj);}};}
var spaceRe=/^\s*$/;function isWhitespace(string){return spaceRe.test(string);}
var trim;if(_trim){trim=function(string){return string==null?"":_trim.call(string);};}else{var trimLeft,trimRight;if(isWhitespace("\xA0")){trimLeft=/^\s+/;trimRight=/\s+$/;}else{trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/;}
trim=function(string){return string==null?"":String(string).replace(trimLeft,"").replace(trimRight,"");};}
var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;'};function escapeHTML(string){return String(string).replace(/&(?!\w+;)|[<>"']/g,function(s){return escapeMap[s]||s;});}
function debug(e,template,line,file){file=file||"<template>";var lines=template.split("\n"),start=Math.max(line-3,0),end=Math.min(lines.length,line+3),context=lines.slice(start,end);var c;for(var i=0,len=context.length;i<len;++i){c=i+start+1;context[i]=(c===line?" >> ":"    ")+context[i];}
e.template=template;e.line=line;e.file=file;e.message=[file+":"+line,context.join("\n"),"",e.message].join("\n");return e;}
function lookup(name,stack,defaultValue){if(name==="."){return stack[stack.length-1];}
var names=name.split(".");var lastIndex=names.length-1;var target=names[lastIndex];var value,context,i=stack.length,j,localStack;while(i){localStack=stack.slice(0);context=stack[--i];j=0;while(j<lastIndex){context=context[names[j++]];if(context==null){break;}
localStack.push(context);}
if(context&&typeof context==="object"&&target in context){value=context[target];break;}}
if(typeof value==="function"){value=value.call(localStack[localStack.length-1]);}
if(value==null){return defaultValue;}
return value;}
function renderSection(name,stack,callback,inverted){var buffer="";var value=lookup(name,stack);if(inverted){if(value==null||value===false||(isArray(value)&&value.length===0)){buffer+=callback();}}else if(isArray(value)){forEach(value,function(value){stack.push(value);buffer+=callback();stack.pop();});}else if(typeof value==="object"){stack.push(value);buffer+=callback();stack.pop();}else if(typeof value==="function"){var scope=stack[stack.length-1];var scopedRender=function(template){return render(template,scope);};buffer+=value.call(scope,callback(),scopedRender)||"";}else if(value){buffer+=callback();}
return buffer;}
function parse(template,options){options=options||{};var tags=options.tags||exports.tags,openTag=tags[0],closeTag=tags[tags.length-1];var code=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var spaces=[],hasTag=false,nonSpace=false;var stripSpace=function(){if(hasTag&&!nonSpace&&!options.space){while(spaces.length){code.splice(spaces.pop(),1);}}else{spaces=[];}
hasTag=false;nonSpace=false;};var sectionStack=[],updateLine,nextOpenTag,nextCloseTag;var setTags=function(source){tags=trim(source).split(/\s+/);nextOpenTag=tags[0];nextCloseTag=tags[tags.length-1];};var includePartial=function(source){code.push('";',updateLine,'\nvar partial = partials["'+trim(source)+'"];','\nif (partial) {','\n  buffer += render(partial,stack[stack.length - 1],partials);','\n}','\nbuffer += "');};var openSection=function(source,inverted){var name=trim(source);if(name===""){throw debug(new Error("Section name may not be empty"),template,line,options.file);}
sectionStack.push({name:name,inverted:inverted});code.push('";',updateLine,'\nvar name = "'+name+'";','\nvar callback = (function () {','\n  return function () {','\n    var buffer = "";','\nbuffer += "');};var openInvertedSection=function(source){openSection(source,true);};var closeSection=function(source){var name=trim(source);var openName=sectionStack.length!=0&&sectionStack[sectionStack.length-1].name;if(!openName||name!=openName){throw debug(new Error('Section named "'+name+'" was never opened'),template,line,options.file);}
var section=sectionStack.pop();code.push('";','\n    return buffer;','\n  };','\n})();');if(section.inverted){code.push("\nbuffer += renderSection(name,stack,callback,true);");}else{code.push("\nbuffer += renderSection(name,stack,callback);");}
code.push('\nbuffer += "');};var sendPlain=function(source){code.push('";',updateLine,'\nbuffer += lookup("'+trim(source)+'",stack,"");','\nbuffer += "');};var sendEscaped=function(source){code.push('";',updateLine,'\nbuffer += escapeHTML(lookup("'+trim(source)+'",stack,""));','\nbuffer += "');};var line=1,c,callback;for(var i=0,len=template.length;i<len;++i){if(template.slice(i,i+openTag.length)===openTag){i+=openTag.length;c=template.substr(i,1);updateLine='\nline = '+line+';';nextOpenTag=openTag;nextCloseTag=closeTag;hasTag=true;switch(c){case"!":i++;callback=null;break;case"=":i++;closeTag="="+closeTag;callback=setTags;break;case">":i++;callback=includePartial;break;case"#":i++;callback=openSection;break;case"^":i++;callback=openInvertedSection;break;case"/":i++;callback=closeSection;break;case"{":closeTag="}"+closeTag;case"&":i++;nonSpace=true;callback=sendPlain;break;default:nonSpace=true;callback=sendEscaped;}
var end=template.indexOf(closeTag,i);if(end===-1){throw debug(new Error('Tag "'+openTag+'" was not closed properly'),template,line,options.file);}
var source=template.substring(i,end);if(callback){callback(source);}
var n=0;while(~(n=source.indexOf("\n",n))){line++;n++;}
i=end+closeTag.length-1;openTag=nextOpenTag;closeTag=nextCloseTag;}else{c=template.substr(i,1);switch(c){case'"':case"\\":nonSpace=true;code.push("\\"+c);break;case"\r":break;case"\n":spaces.push(code.length);code.push("\\n");stripSpace();line++;break;default:if(isWhitespace(c)){spaces.push(code.length);}else{nonSpace=true;}
code.push(c);}}}
if(sectionStack.length!=0){throw debug(new Error('Section "'+sectionStack[sectionStack.length-1].name+'" was not closed properly'),template,line,options.file);}
stripSpace();code.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var body=code.join("").replace(/buffer \+= "";\n/g,"");if(options.debug){if(typeof console!="undefined"&&console.log){console.log(body);}else if(typeof print==="function"){print(body);}}
return body;}
function _compile(template,options){var args="view,partials,stack,lookup,escapeHTML,renderSection,render";var body=parse(template,options);var fn=new Function(args,body);return function(view,partials){partials=partials||{};var stack=[view];try{return fn(view,partials,stack,lookup,escapeHTML,renderSection,render);}catch(e){throw debug(e.error,template,e.line,options.file);}};}
var _cache={};function clearCache(){_cache={};}
function compile(template,options){options=options||{};if(options.cache!==false){if(!_cache[template]){_cache[template]=_compile(template,options);}
return _cache[template];}
return _compile(template,options);}
function render(template,view,partials){return compile(template)(view,partials);}})(Mustache);
;/**
 * jQuery Validation Plugin 1.9.0
 *
 * http://bassistance.de/jquery-plugins/jquery-plugin-validation/
 * http://docs.jquery.com/Plugins/Validation
 *
 * Copyright (c) 2006 - 2011 Jrn Zaefferer
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(c){c.extend(c.fn,{validate:function(a){if(this.length){var b=c.data(this[0],"validator");if(b)return b;this.attr("novalidate","novalidate");b=new c.validator(a,this[0]);c.data(this[0],"validator",b);if(b.settings.onsubmit){a=this.find("input, button");a.filter(".cancel").click(function(){b.cancelSubmit=true});b.settings.submitHandler&&a.filter(":submit").click(function(){b.submitButton=this});this.submit(function(d){function e(){if(b.settings.submitHandler){if(b.submitButton)var f=c("<input type='hidden'/>").attr("name",
b.submitButton.name).val(b.submitButton.value).appendTo(b.currentForm);b.settings.submitHandler.call(b,b.currentForm);b.submitButton&&f.remove();return false}return true}b.settings.debug&&d.preventDefault();if(b.cancelSubmit){b.cancelSubmit=false;return e()}if(b.form()){if(b.pendingRequest){b.formSubmitted=true;return false}return e()}else{b.focusInvalid();return false}})}return b}else a&&a.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(c(this[0]).is("form"))return this.validate().form();
else{var a=true,b=c(this[0].form).validate();this.each(function(){a&=b.element(this)});return a}},removeAttrs:function(a){var b={},d=this;c.each(a.split(/\s/),function(e,f){b[f]=d.attr(f);d.removeAttr(f)});return b},rules:function(a,b){var d=this[0];if(a){var e=c.data(d.form,"validator").settings,f=e.rules,g=c.validator.staticRules(d);switch(a){case "add":c.extend(g,c.validator.normalizeRule(b));f[d.name]=g;if(b.messages)e.messages[d.name]=c.extend(e.messages[d.name],b.messages);break;case "remove":if(!b){delete f[d.name];
return g}var h={};c.each(b.split(/\s/),function(j,i){h[i]=g[i];delete g[i]});return h}}d=c.validator.normalizeRules(c.extend({},c.validator.metadataRules(d),c.validator.classRules(d),c.validator.attributeRules(d),c.validator.staticRules(d)),d);if(d.required){e=d.required;delete d.required;d=c.extend({required:e},d)}return d}});c.extend(c.expr[":"],{blank:function(a){return!c.trim(""+a.value)},filled:function(a){return!!c.trim(""+a.value)},unchecked:function(a){return!a.checked}});c.validator=function(a,
b){this.settings=c.extend(true,{},c.validator.defaults,a);this.currentForm=b;this.init()};c.validator.format=function(a,b){if(arguments.length==1)return function(){var d=c.makeArray(arguments);d.unshift(a);return c.validator.format.apply(this,d)};if(arguments.length>2&&b.constructor!=Array)b=c.makeArray(arguments).slice(1);if(b.constructor!=Array)b=[b];c.each(b,function(d,e){a=a.replace(RegExp("\\{"+d+"\\}","g"),e)});return a};c.extend(c.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",
validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:c([]),errorLabelContainer:c([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(a){this.lastActive=a;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(a)).hide()}},onfocusout:function(a){if(!this.checkable(a)&&(a.name in this.submitted||!this.optional(a)))this.element(a)},
onkeyup:function(a){if(a.name in this.submitted||a==this.lastElement)this.element(a)},onclick:function(a){if(a.name in this.submitted)this.element(a);else a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(a,b,d){a.type==="radio"?this.findByName(a.name).addClass(b).removeClass(d):c(a).addClass(b).removeClass(d)},unhighlight:function(a,b,d){a.type==="radio"?this.findByName(a.name).removeClass(b).addClass(d):c(a).removeClass(b).addClass(d)}},setDefaults:function(a){c.extend(c.validator.defaults,
a)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:c.validator.format("Please enter no more than {0} characters."),
minlength:c.validator.format("Please enter at least {0} characters."),rangelength:c.validator.format("Please enter a value between {0} and {1} characters long."),range:c.validator.format("Please enter a value between {0} and {1}."),max:c.validator.format("Please enter a value less than or equal to {0}."),min:c.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){function a(e){var f=c.data(this[0].form,"validator"),g="on"+e.type.replace(/^validate/,
"");f.settings[g]&&f.settings[g].call(f,this[0],e)}this.labelContainer=c(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||c(this.currentForm);this.containers=c(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=this.groups={};c.each(this.settings.groups,function(e,f){c.each(f.split(/\s/),function(g,h){b[h]=e})});var d=
this.settings.rules;c.each(d,function(e,f){d[e]=c.validator.normalizeRule(f)});c(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",a).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",
a);this.settings.invalidHandler&&c(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){this.checkForm();c.extend(this.submitted,this.errorMap);this.invalid=c.extend({},this.errorMap);this.valid()||c(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(a){this.lastElement=
a=this.validationTargetFor(this.clean(a));this.prepareElement(a);this.currentElements=c(a);var b=this.check(a);if(b)delete this.invalid[a.name];else this.invalid[a.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return b},showErrors:function(a){if(a){c.extend(this.errorMap,a);this.errorList=[];for(var b in a)this.errorList.push({message:a[b],element:this.findByName(b)[0]});this.successList=c.grep(this.successList,function(d){return!(d.name in a)})}this.settings.showErrors?
this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){c.fn.resetForm&&c(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0,d;for(d in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==
0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{c(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(a){}},findLastActive:function(){var a=this.lastActive;return a&&c.grep(this.errorList,function(b){return b.element.name==a.name}).length==1&&a},elements:function(){var a=this,b={};return c(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&
a.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in b||!a.objectLength(c(this).rules()))return false;return b[this.name]=true})},clean:function(a){return c(a)[0]},errors:function(){return c(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=c([]);this.toHide=c([]);this.currentElements=c([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},
prepareElement:function(a){this.reset();this.toHide=this.errorsFor(a)},check:function(a){a=this.validationTargetFor(this.clean(a));var b=c(a).rules(),d=false,e;for(e in b){var f={method:e,parameters:b[e]};try{var g=c.validator.methods[e].call(this,a.value.replace(/\r/g,""),a,f.parameters);if(g=="dependency-mismatch")d=true;else{d=false;if(g=="pending"){this.toHide=this.toHide.not(this.errorsFor(a));return}if(!g){this.formatAndAdd(a,f);return false}}}catch(h){this.settings.debug&&window.console&&console.log("exception occured when checking element "+
a.id+", check the '"+f.method+"' method",h);throw h;}}if(!d){this.objectLength(b)&&this.successList.push(a);return true}},customMetaMessage:function(a,b){if(c.metadata){var d=this.settings.meta?c(a).metadata()[this.settings.meta]:c(a).metadata();return d&&d.messages&&d.messages[b]}},customMessage:function(a,b){var d=this.settings.messages[a];return d&&(d.constructor==String?d:d[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==undefined)return arguments[a]},defaultMessage:function(a,
b){return this.findDefined(this.customMessage(a.name,b),this.customMetaMessage(a,b),!this.settings.ignoreTitle&&a.title||undefined,c.validator.messages[b],"<strong>Warning: No message defined for "+a.name+"</strong>")},formatAndAdd:function(a,b){var d=this.defaultMessage(a,b.method),e=/\$?\{(\d+)\}/g;if(typeof d=="function")d=d.call(this,b.parameters,a);else if(e.test(d))d=jQuery.format(d.replace(e,"{$1}"),b.parameters);this.errorList.push({message:d,element:a});this.errorMap[a.name]=d;this.submitted[a.name]=
d},addWrapper:function(a){if(this.settings.wrapper)a=a.add(a.parent(this.settings.wrapper));return a},defaultShowErrors:function(){for(var a=0;this.errorList[a];a++){var b=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}if(this.errorList.length)this.toShow=this.toShow.add(this.containers);if(this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);
if(this.settings.unhighlight){a=0;for(b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass)}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return c(this.errorList).map(function(){return this.element})},showLabel:function(a,b){var d=this.errorsFor(a);if(d.length){d.removeClass(this.settings.validClass).addClass(this.settings.errorClass);
d.attr("generated")&&d.html(b)}else{d=c("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(a),generated:true}).addClass(this.settings.errorClass).html(b||"");if(this.settings.wrapper)d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,c(a)):d.insertAfter(a))}if(!b&&this.settings.success){d.text("");typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d)}this.toShow=
this.toShow.add(d)},errorsFor:function(a){var b=this.idOrName(a);return this.errors().filter(function(){return c(this).attr("for")==b})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){if(this.checkable(a))a=this.findByName(a.name).not(this.settings.ignore)[0];return a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(a){var b=this.currentForm;return c(document.getElementsByName(a)).map(function(d,
e){return e.form==b&&e.name==a&&e||null})},getLength:function(a,b){switch(b.nodeName.toLowerCase()){case "select":return c("option:selected",b).length;case "input":if(this.checkable(b))return this.findByName(b.name).filter(":checked").length}return a.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):true},dependTypes:{"boolean":function(a){return a},string:function(a,b){return!!c(a,b.form).length},"function":function(a,b){return a(b)}},optional:function(a){return!c.validator.methods.required.call(this,
c.trim(a.value),a)&&"dependency-mismatch"},startRequest:function(a){if(!this.pending[a.name]){this.pendingRequest++;this.pending[a.name]=true}},stopRequest:function(a,b){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[a.name];if(b&&this.pendingRequest==0&&this.formSubmitted&&this.form()){c(this.currentForm).submit();this.formSubmitted=false}else if(!b&&this.pendingRequest==0&&this.formSubmitted){c(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=
false}},previousValue:function(a){return c.data(a,"previousValue")||c.data(a,"previousValue",{old:null,valid:true,message:this.defaultMessage(a,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(a,b){a.constructor==String?this.classRuleSettings[a]=b:c.extend(this.classRuleSettings,
a)},classRules:function(a){var b={};(a=c(a).attr("class"))&&c.each(a.split(" "),function(){this in c.validator.classRuleSettings&&c.extend(b,c.validator.classRuleSettings[this])});return b},attributeRules:function(a){var b={};a=c(a);for(var d in c.validator.methods){var e;if(e=d==="required"&&typeof c.fn.prop==="function"?a.prop(d):a.attr(d))b[d]=e;else if(a[0].getAttribute("type")===d)b[d]=true}b.maxlength&&/-1|2147483647|524288/.test(b.maxlength)&&delete b.maxlength;return b},metadataRules:function(a){if(!c.metadata)return{};
var b=c.data(a.form,"validator").settings.meta;return b?c(a).metadata()[b]:c(a).metadata()},staticRules:function(a){var b={},d=c.data(a.form,"validator");if(d.settings.rules)b=c.validator.normalizeRule(d.settings.rules[a.name])||{};return b},normalizeRules:function(a,b){c.each(a,function(d,e){if(e===false)delete a[d];else if(e.param||e.depends){var f=true;switch(typeof e.depends){case "string":f=!!c(e.depends,b.form).length;break;case "function":f=e.depends.call(b,b)}if(f)a[d]=e.param!==undefined?
e.param:true;else delete a[d]}});c.each(a,function(d,e){a[d]=c.isFunction(e)?e(b):e});c.each(["minlength","maxlength","min","max"],function(){if(a[this])a[this]=Number(a[this])});c.each(["rangelength","range"],function(){if(a[this])a[this]=[Number(a[this][0]),Number(a[this][1])]});if(c.validator.autoCreateRanges){if(a.min&&a.max){a.range=[a.min,a.max];delete a.min;delete a.max}if(a.minlength&&a.maxlength){a.rangelength=[a.minlength,a.maxlength];delete a.minlength;delete a.maxlength}}a.messages&&delete a.messages;
return a},normalizeRule:function(a){if(typeof a=="string"){var b={};c.each(a.split(/\s/),function(){b[this]=true});a=b}return a},addMethod:function(a,b,d){c.validator.methods[a]=b;c.validator.messages[a]=d!=undefined?d:c.validator.messages[a];b.length<3&&c.validator.addClassRules(a,c.validator.normalizeRule(a))},methods:{required:function(a,b,d){if(!this.depend(d,b))return"dependency-mismatch";switch(b.nodeName.toLowerCase()){case "select":return(a=c(b).val())&&a.length>0;case "input":if(this.checkable(b))return this.getLength(a,
b)>0;default:return c.trim(a).length>0}},remote:function(a,b,d){if(this.optional(b))return"dependency-mismatch";var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});e.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=e.message;d=typeof d=="string"&&{url:d}||d;if(this.pending[b.name])return"pending";if(e.old===a)return e.valid;e.old=a;var f=this;this.startRequest(b);var g={};g[b.name]=a;c.ajax(c.extend(true,{url:d,
mode:"abort",port:"validate"+b.name,dataType:"json",data:g,success:function(h){f.settings.messages[b.name].remote=e.originalMessage;var j=h===true;if(j){var i=f.formSubmitted;f.prepareElement(b);f.formSubmitted=i;f.successList.push(b);f.showErrors()}else{i={};h=h||f.defaultMessage(b,"remote");i[b.name]=e.message=c.isFunction(h)?h(a):h;f.showErrors(i)}e.valid=j;f.stopRequest(b,j)}},d));return"pending"},minlength:function(a,b,d){return this.optional(b)||this.getLength(c.trim(a),b)>=d},maxlength:function(a,
b,d){return this.optional(b)||this.getLength(c.trim(a),b)<=d},rangelength:function(a,b,d){a=this.getLength(c.trim(a),b);return this.optional(b)||a>=d[0]&&a<=d[1]},min:function(a,b,d){return this.optional(b)||a>=d},max:function(a,b,d){return this.optional(b)||a<=d},range:function(a,b,d){return this.optional(b)||a>=d[0]&&a<=d[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 -]+/.test(a))return false;var d=0,e=0,f=false;a=a.replace(/\D/g,"");for(var g=a.length-1;g>=
0;g--){e=a.charAt(g);e=parseInt(e,10);if(f)if((e*=2)>9)e-=9;d+=e;f=!f}return d%10==0},accept:function(a,b,d){d=typeof d=="string"?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||a.match(RegExp(".("+d+")$","i"))},equalTo:function(a,b,d){d=c(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){c(b).valid()});return a==d.val()}}});c.format=c.validator.format})(jQuery);
(function(c){var a={};if(c.ajaxPrefilter)c.ajaxPrefilter(function(d,e,f){e=d.port;if(d.mode=="abort"){a[e]&&a[e].abort();a[e]=f}});else{var b=c.ajax;c.ajax=function(d){var e=("port"in d?d:c.ajaxSettings).port;if(("mode"in d?d:c.ajaxSettings).mode=="abort"){a[e]&&a[e].abort();return a[e]=b.apply(this,arguments)}return b.apply(this,arguments)}}})(jQuery);
(function(c){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(e){e=c.event.fix(e);e.type=b;return c.event.handle.call(this,e)}c.event.special[b]={setup:function(){this.addEventListener(a,d,true)},teardown:function(){this.removeEventListener(a,d,true)},handler:function(e){arguments[0]=c.event.fix(e);arguments[0].type=b;return c.event.handle.apply(this,arguments)}}});c.extend(c.fn,{validateDelegate:function(a,
b,d){return this.bind(b,function(e){var f=c(e.target);if(f.is(a))return d.apply(f,arguments)})}})})(jQuery);

;(function(a,b){"use strict";var c=a.History=a.History||{},d=a.jQuery;if(typeof c.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;return e},onDomLoad:function(a){d(a)}},typeof c.init!="undefined"&&c.init()})(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode;if(typeof m.init!="undefined")throw new Error("History.js Core has already been loaded...");m.init=function(){return typeof m.Adapter=="undefined"?!1:(typeof m.initCore!="undefined"&&m.initCore(),typeof m.initHtml4!="undefined"&&m.initHtml4(),!0)},m.initCore=function(){if(typeof m.initCore.initialized!="undefined")return!1;m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if(typeof b!="undefined"&&b!==null){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a=typeof c!="undefined"&&typeof c.log!="undefined"&&typeof c.log.apply!="undefined",b=d.getElementById("log"),e,f,g,h,i;a?(h=Array.prototype.slice.call(arguments),e=h.shift(),typeof c.debug!="undefined"?c.debug.apply(c,[e,h]):c.log.apply(c,[e,h])):e="\n"+arguments[0]+"\n";for(f=1,g=arguments.length;f<g;++f){i=arguments[f];if(typeof i=="object"&&typeof k!="undefined")try{i=k.stringify(i)}catch(j){}e+="\n"+i+"\n"}return b?(b.value+=e+"\n-----\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||l(e),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached=typeof m.getInternetExplorerMajorVersion.cached!="undefined"?m.getInternetExplorerMajorVersion.cached:function(){var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");while((b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0]);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached=typeof m.isInternetExplorer.cached!="undefined"?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);if(d.location.port||!1)a+=":"+d.location.port;return a+="/",a},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return a.length===1&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a=m.getState(!1,!1),b=(a||{}).url||d.location.href,c;return c=b.replace(/\/+$/,"").replace(/[^\/]+$/,function(a,b,c){return/\./.test(a)?a:a+"/"}),c},m.getBasePageUrl=function(){var a=d.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a,b,c){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b=typeof b=="undefined"?!0:b,/[a-z]+\:\/\//.test(a)||(d==="/"?c=m.getRootUrl()+a.replace(/^\/+/,""):d==="#"?c=m.getPageUrl().replace(/#.*/,"")+a:d==="?"?c=m.getPageUrl().replace(/[\?#].*/,"")+a:b?c=m.getBaseUrl()+a.replace(/^(\.\/)+/,""):c=m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),b},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){typeof a=="undefined"&&(a=!0),typeof b=="undefined"&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b=m.extractId(a.url),c;if(!b){c=m.getStateString(a);if(typeof m.stateToId[c]!="undefined")b=m.stateToId[c];else if(typeof m.store.stateToId[c]!="undefined")b=m.store.stateToId[c];else{for(;;){b=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof m.idToState[b]=="undefined"&&typeof m.store.idToState[b]=="undefined")break}m.stateToId[c]=b,m.idToState[b]=a}}return b},m.normalizeState=function(a){var b,c;if(!a||typeof a!="object")a={};if(typeof a.normalized!="undefined")return a;if(!a.data||typeof a.data!="object")a.data={};b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(m.unescapeString(a.url||d.location.href)),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data);if(b.title||c)b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id;return b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d),d},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c),d},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id,c},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash,c},m.extractId=function(a){var b,c,d;return c=/(.*)\&_suid=([0-9]+)$/.exec(a),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c=null,d,e;return b=b||!1,d=m.extractId(a),d&&(c=m.getStateById(d)),c||(e=m.getFullUrl(a),d=m.getIdByUrl(e)||!1,d&&(c=m.getStateById(d)),!c&&b&&!m.isTraditionalAnchor(a)&&(c=m.createStateObject(null,null,e))),c},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b=!1,c;return c=m.extractState(a.url),b=c&&c.id!==a.id,b},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b=!1,c,d,e;return m.savedStates.length&&(c=a.id,d=m.getLastSavedState(),e=d.id,b=c===e),b},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return typeof a=="undefined"?b=m.savedStates[m.savedStates.length-1]:a<0?b=m.savedStates[m.savedStates.length+a]:b=m.savedStates[a],b},m.getHash=function(){var a=m.unescapeHash(d.location.hash);return a},m.unescapeString=function(b){var c=b,d;for(;;){d=a.unescape(c);if(d===c)break;c=d}return c},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=m.unescapeString(b),b},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e,f;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(c=m.escapeHash(a),m.busy(!0),e=m.extractState(a,!0),e&&!m.emulated.pushState?m.pushState(e.data,e.title,e.url,!1):d.location.hash!==c&&(m.bugs.setHash?(f=m.getPageUrl(),m.pushState(null,null,f+"#"+c,!1)):d.location.hash=c),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.escape(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b),b},m.setTitle=function(a){var b=a.title,c;b||(c=m.getStateByIndex(0),c&&c.url===a.url&&(b=c.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=b,m},m.queues=[],m.busy=function(a){typeof a!="undefined"?m.busy.flag=a:typeof m.busy.flag=="undefined"&&(m.busy.flag=!1);if(!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(m.busy.flag)return;for(a=m.queues.length-1;a>=0;--a){c=m.queues[a];if(c.length===0)continue;d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay)}};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return typeof a=="function"&&(a={callback:a}),typeof b!="undefined"&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b=m.extractState(d.location.href),c;if(!m.isLastSavedState(b))c=b;else return;return c||(c=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;c<=a;++c)m.forward(b);else{if(!(a<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m};if(m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var e=!1,f=!1,g,h;return m.doubleCheckComplete(),g=m.getHash(),g?(h=m.extractState(g||d.location.href,!0),h?m.replaceState(h.data,h.title,h.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(e=m.Adapter.extractEventData("state",b,c)||!1,e?f=m.getStateById(e):m.expectedStateId?f=m.getStateById(m.expectedStateId):f=m.extractState(d.location.href),f||(f=m.createStateObject(null,null,d.location.href)),m.expectedStateId=!1,m.isLastSavedState(f)?(m.busy(!1),!1):(m.storeState(f),m.saveState(f),m.setTitle(f),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"beforeunload",m.clearAllIntervals),m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(d.location.href,!0))),f&&(m.onUnload=function(){var a,b;try{a=k.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState){if(!m.idToState.hasOwnProperty(b))continue;a.idToState[b]=m.idToState[b]}for(b in m.urlToId){if(!m.urlToId.hasOwnProperty(b))continue;a.urlToId[b]=m.urlToId[b]}for(b in m.stateToId){if(!m.stateToId.hasOwnProperty(b))continue;a.stateToId[b]=m.stateToId[b]}m.store=a,m.normalizeStore(),f.setItem("History.store",k.stringify(a))},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload));if(!m.emulated.pushState){m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval));if(e.vendor==="Apple Computer, Inc."||(e.appCodeName||"")==="Mozilla")m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})}},m.init()}(window)
;var rwindow,rdocument;if(typeof RELANG==='undefined')
{var RELANG={};}
var RLANG={html:'HTML',video:'Insert Video',image:'Insert Image',table:'Table',link:'Link',link_insert:'Insert link',unlink:'Unlink',formatting:'Formatting',paragraph:'Paragraph',quote:'Quote',code:'Code',header1:'Header 1',header2:'Header 2',header3:'Header 3',header4:'Header 4',bold:'Bold',italic:'Italic',fontcolor:'Font Color',backcolor:'Back Color',unorderedlist:'Unordered List',orderedlist:'Ordered List',outdent:'Outdent',indent:'Indent',cancel:'Cancel',insert:'Insert',save:'Save',_delete:'Delete',insert_table:'Insert Table',insert_row_above:'Add Row Above',insert_row_below:'Add Row Below',insert_column_left:'Add Column Left',insert_column_right:'Add Column Right',delete_column:'Delete Column',delete_row:'Delete Row',delete_table:'Delete Table',rows:'Rows',columns:'Columns',add_head:'Add Head',delete_head:'Delete Head',title:'Title',image_position:'Position',none:'None',left:'Left',right:'Right',image_web_link:'Image Web Link',text:'Text',mailto:'Email',web:'URL',video_html_code:'Video Embed Code',file:'Insert File',upload:'Upload',download:'Download',choose:'Choose',or_choose:'Or choose',drop_file_here:'Drop file here',align_left:'Align text to the left',align_center:'Center text',align_right:'Align text to the right',align_justify:'Justify text',horizontalrule:'Insert Horizontal Rule',deleted:'Deleted',anchor:'Anchor',link_new_tab:'Open link in new tab',underline:'Underline',alignment:'Alignment'};(function($){jQuery.fn.redactor=function(option)
{return this.each(function()
{var $obj=$(this);var data=$obj.data('redactor');if(!data)
{$obj.data('redactor',(data=new Redactor(this,option)));}});};var Redactor=function(element,options)
{this.$el=$(element);if(typeof options!=='undefined'&&typeof options.lang!=='undefined'&&options.lang!=='en'&&typeof RELANG[options.lang]!=='undefined')
{RLANG=RELANG[options.lang];}
this.opts=$.extend({iframe:false,css:false,lang:'en',direction:'ltr',callback:false,keyupCallback:false,keydownCallback:false,execCommandCallback:false,plugins:false,cleanup:true,focus:false,tabindex:false,autoresize:true,minHeight:false,fixed:false,fixedTop:0,fixedBox:false,source:true,shortcuts:true,mobile:true,air:false,wym:false,convertLinks:true,convertDivs:true,protocol:'http://',autosave:false,autosaveCallback:false,interval:60,imageGetJson:false,imageUpload:false,imageUploadCallback:false,imageUploadErrorCallback:false,fileUpload:false,fileUploadCallback:false,fileUploadErrorCallback:false,uploadCrossDomain:false,uploadFields:false,observeImages:true,overlay:true,allowedTags:["form","input","button","select","option","datalist","output","textarea","fieldset","legend","section","header","hgroup","aside","footer","article","details","nav","progress","time","canvas","code","span","div","label","a","br","p","b","i","del","strike","u","img","video","source","track","audio","iframe","object","embed","param","blockquote","mark","cite","small","ul","ol","li","hr","dl","dt","dd","sup","sub","big","pre","code","figure","figcaption","strong","em","table","tr","td","th","tbody","thead","tfoot","h1","h2","h3","h4","h5","h6"],toolbarExternal:false,buttonsCustom:{},buttonsAdd:[],buttons:['html','|','formatting','|','bold','italic','deleted','|','unorderedlist','orderedlist','outdent','indent','|','image','video','file','table','link','|','fontcolor','backcolor','|','alignment','|','horizontalrule'],airButtons:['formatting','|','bold','italic','deleted','|','unorderedlist','orderedlist','outdent','indent','|','fontcolor','backcolor'],formattingTags:['p','blockquote','pre','h1','h2','h3','h4'],activeButtons:['deleted','italic','bold','underline','unorderedlist','orderedlist'],activeButtonsStates:{b:'bold',strong:'bold',i:'italic',em:'italic',del:'deleted',strike:'deleted',ul:'unorderedlist',ol:'orderedlist',u:'underline'},colors:['#ffffff','#000000','#eeece1','#1f497d','#4f81bd','#c0504d','#9bbb59','#8064a2','#4bacc6','#f79646','#ffff00','#f2f2f2','#7f7f7f','#ddd9c3','#c6d9f0','#dbe5f1','#f2dcdb','#ebf1dd','#e5e0ec','#dbeef3','#fdeada','#fff2ca','#d8d8d8','#595959','#c4bd97','#8db3e2','#b8cce4','#e5b9b7','#d7e3bc','#ccc1d9','#b7dde8','#fbd5b5','#ffe694','#bfbfbf','#3f3f3f','#938953','#548dd4','#95b3d7','#d99694','#c3d69b','#b2a2c7','#b7dde8','#fac08f','#f2c314','#a5a5a5','#262626','#494429','#17365d','#366092','#953734','#76923c','#5f497a','#92cddc','#e36c09','#c09100','#7f7f7f','#0c0c0c','#1d1b10','#0f243e','#244061','#632423','#4f6128','#3f3151','#31859b','#974806','#7f6000'],emptyHtml:'<p><br /></p>',buffer:false,visual:true,modal_file:String()+'<div id="redactor_modal_content">'+'<form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data">'+'<label>Name (optional)</label>'+'<input type="text" id="redactor_filename" class="redactor_input" />'+'<div style="margin-top: 7px;">'+'<input type="file" id="redactor_file" name="file" />'+'</div>'+'</form><br>'+'</div>',modal_image_edit:String()+'<div id="redactor_modal_content">'+'<label>'+RLANG.title+'</label>'+'<input id="redactor_file_alt" class="redactor_input" />'+'<label>'+RLANG.link+'</label>'+'<input id="redactor_file_link" class="redactor_input" />'+'<label>'+RLANG.image_position+'</label>'+'<select id="redactor_form_image_align">'+'<option value="none">'+RLANG.none+'</option>'+'<option value="left">'+RLANG.left+'</option>'+'<option value="right">'+RLANG.right+'</option>'+'</select>'+'</div>'+'<div id="redactor_modal_footer">'+'<a href="javascript:void(null);" id="redactor_image_delete_btn" class="redactor_modal_btn">'+RLANG._delete+'</a>&nbsp;&nbsp;&nbsp;'+'<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a>'+'<input type="button" name="save" class="redactor_modal_btn" id="redactorSaveBtn" value="'+RLANG.save+'" />'+'</div>',modal_image:String()+'<div id="redactor_modal_content">'+'<div id="redactor_tabs">'+'<a href="javascript:void(null);" class="redactor_tabs_act">'+RLANG.upload+'</a>'+'<a href="javascript:void(null);">'+RLANG.choose+'</a>'+'<a href="javascript:void(null);">'+RLANG.link+'</a>'+'</div>'+'<form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data">'+'<div id="redactor_tab1" class="redactor_tab">'+'<input type="file" id="redactor_file" name="file" />'+'</div>'+'<div id="redactor_tab2" class="redactor_tab" style="display: none;">'+'<div id="redactor_image_box"></div>'+'</div>'+'</form>'+'<div id="redactor_tab3" class="redactor_tab" style="display: none;">'+'<label>'+RLANG.image_web_link+'</label>'+'<input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  />'+'</div>'+'</div>'+'<div id="redactor_modal_footer">'+'<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a>'+'<input type="button" name="upload" class="redactor_modal_btn" id="redactor_upload_btn" value="'+RLANG.insert+'" />'+'</div>',modal_link:String()+'<div id="redactor_modal_content">'+'<form id="redactorInsertLinkForm" method="post" action="">'+'<div id="redactor_tabs">'+'<a href="javascript:void(null);" class="redactor_tabs_act">URL</a>'+'<a href="javascript:void(null);">Email</a>'+'<a href="javascript:void(null);">'+RLANG.anchor+'</a>'+'</div>'+'<input type="hidden" id="redactor_tab_selected" value="1" />'+'<div class="redactor_tab" id="redactor_tab1">'+'<label>URL</label><input type="text" id="redactor_link_url" class="redactor_input"  />'+'<label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" />'+'<label><input type="checkbox" id="redactor_link_blank"> '+RLANG.link_new_tab+'</label>'+'</div>'+'<div class="redactor_tab" id="redactor_tab2" style="display: none;">'+'<label>Email</label><input type="text" id="redactor_link_mailto" class="redactor_input" />'+'<label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" />'+'</div>'+'<div class="redactor_tab" id="redactor_tab3" style="display: none;">'+'<label>'+RLANG.anchor+'</label><input type="text" class="redactor_input" id="redactor_link_anchor"  />'+'<label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" />'+'</div>'+'</form>'+'</div>'+'<div id="redactor_modal_footer">'+'<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a>'+'<input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+RLANG.insert+'" />'+'</div>',modal_table:String()+'<div id="redactor_modal_content">'+'<label>'+RLANG.rows+'</label>'+'<input type="text" size="5" value="2" id="redactor_table_rows" />'+'<label>'+RLANG.columns+'</label>'+'<input type="text" size="5" value="3" id="redactor_table_columns" />'+'</div>'+'<div id="redactor_modal_footer">'+'<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a>'+'<input type="button" name="upload" class="redactor_modal_btn" id="redactor_insert_table_btn" value="'+RLANG.insert+'" />'+'</div>',modal_video:String()+'<div id="redactor_modal_content">'+'<form id="redactorInsertVideoForm">'+'<label>'+RLANG.video_html_code+'</label>'+'<textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"></textarea>'+'</form>'+'</div>'+'<div id="redactor_modal_footer">'+'<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a>'+'<input type="button" class="redactor_modal_btn" id="redactor_insert_video_btn" value="'+RLANG.insert+'" />'+'</div>',toolbar:{html:{title:RLANG.html,func:'toggle'},formatting:{title:RLANG.formatting,func:'show',dropdown:{p:{title:RLANG.paragraph,exec:'formatblock'},blockquote:{title:RLANG.quote,exec:'formatblock',className:'redactor_format_blockquote'},pre:{title:RLANG.code,exec:'formatblock',className:'redactor_format_pre'},h1:{title:RLANG.header1,exec:'formatblock',className:'redactor_format_h1'},h2:{title:RLANG.header2,exec:'formatblock',className:'redactor_format_h2'},h3:{title:RLANG.header3,exec:'formatblock',className:'redactor_format_h3'},h4:{title:RLANG.header4,exec:'formatblock',className:'redactor_format_h4'}}},bold:{title:RLANG.bold,exec:'bold'},italic:{title:RLANG.italic,exec:'italic'},deleted:{title:RLANG.deleted,exec:'strikethrough'},underline:{title:RLANG.underline,exec:'underline'},unorderedlist:{title:'&bull; '+RLANG.unorderedlist,exec:'insertunorderedlist'},orderedlist:{title:'1. '+RLANG.orderedlist,exec:'insertorderedlist'},outdent:{title:'< '+RLANG.outdent,exec:'outdent'},indent:{title:'> '+RLANG.indent,exec:'indent'},image:{title:RLANG.image,func:'showImage'},video:{title:RLANG.video,func:'showVideo'},file:{title:RLANG.file,func:'showFile'},table:{title:RLANG.table,func:'show',dropdown:{insert_table:{title:RLANG.insert_table,func:'showTable'},separator_drop1:{name:'separator'},insert_row_above:{title:RLANG.insert_row_above,func:'insertRowAbove'},insert_row_below:{title:RLANG.insert_row_below,func:'insertRowBelow'},insert_column_left:{title:RLANG.insert_column_left,func:'insertColumnLeft'},insert_column_right:{title:RLANG.insert_column_right,func:'insertColumnRight'},separator_drop2:{name:'separator'},add_head:{title:RLANG.add_head,func:'addHead'},delete_head:{title:RLANG.delete_head,func:'deleteHead'},separator_drop3:{name:'separator'},delete_column:{title:RLANG.delete_column,func:'deleteColumn'},delete_row:{title:RLANG.delete_row,func:'deleteRow'},delete_table:{title:RLANG.delete_table,func:'deleteTable'}}},link:{title:RLANG.link,func:'show',dropdown:{link:{title:RLANG.link_insert,func:'showLink'},unlink:{title:RLANG.unlink,exec:'unlink'}}},fontcolor:{title:RLANG.fontcolor,func:'show'},backcolor:{title:RLANG.backcolor,func:'show'},alignment:{title:RLANG.alignment,func:'show',dropdown:{alignleft:{title:RLANG.align_left,exec:'JustifyLeft'},aligncenter:{title:RLANG.align_center,exec:'JustifyCenter'},alignright:{title:RLANG.align_right,exec:'JustifyRight'},justify:{title:RLANG.align_justify,exec:'JustifyFull'}}},alignleft:{exec:'JustifyLeft',title:RLANG.align_left},aligncenter:{exec:'JustifyCenter',title:RLANG.align_center},alignright:{exec:'JustifyRight',title:RLANG.align_right},justify:{exec:'JustifyFull',title:RLANG.align_justify},horizontalrule:{exec:'inserthorizontalrule',title:RLANG.horizontalrule}}},options,this.$el.data());this.dropdowns=[];this.init();};Redactor.prototype={init:function()
{this.height=this.$el.css('height');this.width=this.$el.css('width');rdocument=this.document=document;rwindow=this.window=window;if(this.opts.mobile===false&&this.isMobile())
{this.build(true);return false;}
if(this.opts.iframe)
{this.opts.autoresize=false;}
if(this.opts.air)
{this.opts.buttons=this.opts.airButtons;}
else if(this.opts.toolbar!==false)
{if(this.opts.source===false)
{var index=this.opts.buttons.indexOf('html');var next=this.opts.buttons[index+1];this.opts.buttons.splice(index,1);if(typeof next!=='undefined'&&next==='|')
{this.opts.buttons.splice(index,1);}}
$.extend(this.opts.toolbar,this.opts.buttonsCustom);$.each(this.opts.buttonsAdd,$.proxy(function(i,s)
{this.opts.buttons.push(s);},this));}
if(this.opts.toolbar!==false)
{$.each(this.opts.toolbar.formatting.dropdown,$.proxy(function(i,s)
{if($.inArray(i,this.opts.formattingTags)=='-1')
{delete this.opts.toolbar.formatting.dropdown[i];}},this));}
function afterBuild()
{this.enableAir();this.buildToolbar();if(typeof this.opts.plugins==='object')
{$.each(this.opts.plugins,$.proxy(function(i,s)
{if(typeof RedactorPlugins[s]!=='undefined')
{$.extend(this,RedactorPlugins[s]);if(typeof RedactorPlugins[s].init!=='undefined')
{this.init();}}},this));}
if(this.opts.activeButtons!==false&&this.opts.toolbar!==false)
{var observeFormatting=$.proxy(function(){this.observeFormatting();},this);this.$editor.click(observeFormatting).keyup(observeFormatting);}
var oldsafari=false;if(this.browser('webkit')&&navigator.userAgent.indexOf('Chrome')===-1)
{var arr=this.browser('version').split('.');if(arr[0]<536)oldsafari=true;}
if(this.isMobile(true)===false&&oldsafari===false)
{this.$editor.bind('paste',$.proxy(function(e)
{if(this.opts.cleanup===false)
{return true;}
this.pasteRunning=true;this.setBuffer();if(this.opts.autoresize===true)
{this.saveScroll=this.document.body.scrollTop;}
else
{this.saveScroll=this.$editor.scrollTop();}
var frag=this.extractContent();setTimeout($.proxy(function()
{var pastedFrag=this.extractContent();this.$editor.append(frag);this.restoreSelection();var html=this.getFragmentHtml(pastedFrag);this.pasteCleanUp(html);this.pasteRunning=false;},this),1);},this));}
this.keyup();this.keydown();if(this.opts.autosave!==false)
{this.autoSave();}
setTimeout($.proxy(function()
{this.observeImages();this.observeTables();},this),1);if(this.browser('mozilla'))
{this.$editor.click($.proxy(function()
{this.saveSelection();},this));try
{this.document.execCommand('enableObjectResizing',false,false);this.document.execCommand('enableInlineTableEditing',false,false);}
catch(e){}}
if(this.opts.focus)
{setTimeout($.proxy(function(){this.$editor.focus();},this),1);}
if(this.opts.fixed)
{this.observeScroll();$(document).scroll($.proxy(this.observeScroll,this));}
if(typeof this.opts.callback==='function')
{this.opts.callback(this);}
if(this.opts.toolbar!==false)
{this.$toolbar.find('a').attr('tabindex','-1');}}
this.build(false,afterBuild);},shortcuts:function(e,cmd)
{e.preventDefault();this.execCommand(cmd,false);},keyup:function()
{this.$editor.keyup($.proxy(function(e)
{var key=e.keyCode||e.which;if(this.browser('mozilla')&&!this.pasteRunning)
{this.saveSelection();}
if(typeof this.opts.keyupCallback==='function')
{this.opts.keyupCallback(this,e);}
if(key===8||key===46)
{this.observeImages();return this.formatEmpty(e);}
if(key===13&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey)
{if(this.browser('webkit'))
{this.formatNewLine(e);}
if(this.opts.convertLinks)
{this.$editor.linkify();}}
this.syncCode();},this));},keydown:function()
{this.$editor.keydown($.proxy(function(e)
{var key=e.keyCode||e.which;var parent=this.getParentNode();var current=this.getCurrentNode();var pre=false;var ctrl=e.ctrlKey||e.metaKey;if((parent||current)&&($(parent).get(0).tagName==='PRE'||$(current).get(0).tagName==='PRE'))
{pre=true;}
if(typeof this.opts.keydownCallback==='function')
{this.opts.keydownCallback(this,e);}
if(ctrl&&this.opts.shortcuts)
{if(key===90)
{if(this.opts.buffer!==false)
{e.preventDefault();this.getBuffer();}
else if(e.shiftKey)
{this.shortcuts(e,'redo');}
else
{this.shortcuts(e,'undo');}}
else if(key===77)
{this.shortcuts(e,'removeFormat');}
else if(key===66)
{this.shortcuts(e,'bold');}
else if(key===73)
{this.shortcuts(e,'italic');}
else if(key===74)
{this.shortcuts(e,'insertunorderedlist');}
else if(key===75)
{this.shortcuts(e,'insertorderedlist');}
else if(key===76)
{this.shortcuts(e,'superscript');}
else if(key===72)
{this.shortcuts(e,'subscript');}}
if(!ctrl&&key!==90)
{this.opts.buffer=false;}
if(pre===true&&key===13)
{e.preventDefault();var html=$(current).parent().text();this.insertNodeAtCaret(this.document.createTextNode('\r\n'));if(html.search(/\s$/)==-1)
{this.insertNodeAtCaret(this.document.createTextNode('\r\n'));}
this.syncCode();return false;}
if(this.opts.shortcuts&&!e.shiftKey&&key===9)
{if(pre===false)
{this.shortcuts(e,'indent');}
else
{e.preventDefault();this.insertNodeAtCaret(this.document.createTextNode('\t'));this.syncCode();return false;}}
else if(this.opts.shortcuts&&e.shiftKey&&key===9)
{this.shortcuts(e,'outdent');}
if(this.browser('webkit')&&navigator.userAgent.indexOf('Chrome')===-1)
{return this.safariShiftKeyEnter(e,key);}},this));},build:function(mobile,whendone)
{if(mobile!==true)
{this.$box=$('<div class="redactor_box"></div>');if(this.opts.air)
{this.air=$('<div class="redactor_air" style="display: none;"></div>');}
this.$content=null;function initFrame()
{this.$editor=this.$content.contents().find("body").attr('contenteditable',true).attr('dir',this.opts.direction);rdocument=this.document=this.$editor[0].ownerDocument;rwindow=this.window=this.document.defaultView||window;if(this.opts.css!==false)
{this.$content.contents().find('head').append('<link rel="stylesheet" href="'+this.opts.css+'" />');}
this.$editor.html(html);if(whendone)
{whendone.call(this);whendone=null;}}
this.textareamode=true;if(this.$el.get(0).tagName==='TEXTAREA')
{if(this.opts.iframe)
{var me=this;this.$content=$('<iframe style="width: 100%;" frameborder="0"></iframe>').load(function()
{initFrame.call(me);});}
else
{this.$content=this.$editor=$('<div></div>');}
var classlist=this.$el.get(0).className.split(/\s+/);$.each(classlist,$.proxy(function(i,s)
{this.$content.addClass('redactor_'+s);},this));}
else
{this.textareamode=false;this.$content=this.$editor=this.$el;this.$el=$('<textarea name="'+this.$editor.attr('id')+'"></textarea>').css('height',this.height);}
if(this.$editor)
{this.$editor.addClass('redactor_editor').attr('contenteditable',true).attr('dir',this.opts.direction);}
if(this.opts.tabindex!==false)
{this.$content.attr('tabindex',this.opts.tabindex);}
if(this.opts.minHeight!==false)
{this.$content.css('min-height',this.opts.minHeight+'px');}
if(this.opts.wym===true)
{this.$content.addClass('redactor_editor_wym');}
if(this.opts.autoresize===false)
{this.$content.css('height',this.height);}
this.$el.hide();var html='';if(this.textareamode)
{html=this.$el.val();html=this.savePreCode(html);this.$box.insertAfter(this.$el).append(this.$content).append(this.$el);}
else
{html=this.$editor.html();html=this.savePreCode(html);this.$box.insertAfter(this.$content).append(this.$el).append(this.$editor);}
html=this.paragraphy(html);if(this.$editor)
{this.$editor.html(html);}
if(this.textareamode===false)
{this.syncCode();}}
else
{if(this.$el.get(0).tagName!=='TEXTAREA')
{var html=this.$el.val();var textarea=$('<textarea name="'+this.$editor.attr('id')+'"></textarea>').css('height',this.height).val(html);this.$el.hide();this.$el.after(textarea);}}
if(whendone&&this.$editor)
{whendone.call(this);}},enableAir:function()
{if(this.opts.air===false)
{return false;}
this.air.hide();this.$editor.bind('textselect',$.proxy(function(e)
{this.showAir(e);},this));this.$editor.bind('textunselect',$.proxy(function()
{this.air.hide();},this));},showAir:function(e)
{$('.redactor_air').hide();var width=this.air.innerWidth();var left=e.clientX;if($(this.document).width()<(left+width))
{left=left-width;}
var top=e.clientY+$(document).scrollTop()+14;if(this.opts.iframe===true)
{top=top+this.$box.position().top;left=left+this.$box.position().left;}
this.air.css({left:left+'px',top:top+'px'}).show();},syncCode:function()
{this.$el.val(this.$editor.html());},setCode:function(html)
{html=this.stripTags(html);this.$editor.html(html).focus();this.syncCode();},getCode:function()
{var html='';if(this.opts.visual)
{html=this.$editor.html()}
else
{html=this.$el.val();}
return this.stripTags(html);},insertHtml:function(html)
{this.$editor.focus();this.pasteHtmlAtCaret(html);this.observeImages();this.syncCode();},pasteHtmlAtCaret:function(html)
{var sel,range;if(this.document.getSelection)
{sel=this.window.getSelection();if(sel.getRangeAt&&sel.rangeCount)
{range=sel.getRangeAt(0);range.deleteContents();var el=this.document.createElement("div");el.innerHTML=html;var frag=this.document.createDocumentFragment(),node,lastNode;while(node=el.firstChild)
{lastNode=frag.appendChild(node);}
range.insertNode(frag);if(lastNode)
{range=range.cloneRange();range.setStartAfter(lastNode);range.collapse(true);sel.removeAllRanges();sel.addRange(range);}}}
else if(this.document.selection&&this.document.selection.type!="Control")
{this.document.selection.createRange().pasteHTML(html);}},destroy:function()
{var html=this.getCode();if(this.textareamode)
{this.$box.after(this.$el);this.$box.remove();this.$el.height(this.height).val(html).show();}
else
{this.$box.after(this.$editor);this.$box.remove();this.$editor.removeClass('redactor_editor').removeClass('redactor_editor_wym').attr('contenteditable',false).html(html).show();}
if(this.opts.toolbarExternal)
{$(this.opts.toolbarExternal).empty();}
$('.redactor_air').remove();for(var i=0;i<this.dropdowns.length;i++)
{this.dropdowns[i].remove();delete(this.dropdowns[i]);}
if(this.opts.autosave!==false)
{clearInterval(this.autosaveInterval);}},observeFormatting:function()
{var parent=this.getCurrentNode();this.inactiveAllButtons();$.each(this.opts.activeButtonsStates,$.proxy(function(i,s)
{if($(parent).closest(i,this.$editor.get()[0]).length!=0)
{this.setBtnActive(s);}},this));var tag=$(parent).closest(['p','div','h1','h2','h3','h4','h5','h6','blockquote','td']);if(typeof tag[0]!=='undefined'&&typeof tag[0].elem!=='undefined'&&$(tag[0].elem).size()!=0)
{var align=$(tag[0].elem).css('text-align');switch(align)
{case'right':this.setBtnActive('alignright');break;case'center':this.setBtnActive('aligncenter');break;case'justify':this.setBtnActive('justify');break;default:this.setBtnActive('alignleft');break;}}},observeImages:function()
{if(this.opts.observeImages===false)
{return false;}
this.$editor.find('img').each($.proxy(function(i,s)
{if(this.browser('msie'))
{$(s).attr('unselectable','on');}
this.resizeImage(s);},this));},observeTables:function()
{this.$editor.find('table').click($.proxy(this.tableObserver,this));},observeScroll:function()
{var scrolltop=$(this.document).scrollTop();var boxtop=this.$box.offset().top;var left=0;if(scrolltop>boxtop)
{var width='100%';if(this.opts.fixedBox)
{left=this.$box.offset().left;width=this.$box.innerWidth();}
this.fixed=true;this.$toolbar.css({position:'fixed',width:width,zIndex:1005,top:this.opts.fixedTop+'px',left:left});}
else
{this.fixed=false;this.$toolbar.css({position:'relative',width:'auto',zIndex:1,top:0,left:left});}},setBuffer:function()
{this.saveSelection();this.opts.buffer=this.$editor.html();},getBuffer:function()
{if(this.opts.buffer===false)
{return false;}
this.$editor.html(this.opts.buffer);if(!this.browser('msie'))
{this.restoreSelection();}
this.opts.buffer=false;},execCommand:function(cmd,param)
{if(this.opts.visual==false)
{this.$el.focus();return false;}
try
{var parent;if(cmd==='ltr'){parent=this.getCurrentNode();$(parent).removeAttr('dir');}
else if(cmd==='rtl'){parent=this.getCurrentNode();$(parent).attr('dir','rtl');}
else if(cmd==='inserthtml')
{if(this.browser('msie'))
{this.$editor.focus();this.document.selection.createRange().pasteHTML(param);}
else
{this.pasteHtmlAtCaret(param);}
this.observeImages();}
else if(cmd==='unlink')
{parent=this.getParentNode();if($(parent).get(0).tagName==='A')
{$(parent).replaceWith($(parent).text());}
else
{this.execRun(cmd,param);}}
else if(cmd==='JustifyLeft'||cmd==='JustifyCenter'||cmd==='JustifyRight'||cmd==='JustifyFull')
{parent=this.getCurrentNode();var tag=$(parent).get(0).tagName;if(this.opts.iframe===false&&$(parent).parents('.redactor_editor').size()==0)
{return false;}
var tagsArray=['P','DIV','H1','H2','H3','H4','H5','H6','BLOCKQUOTE','TD'];if($.inArray(tag,tagsArray)!=-1)
{var align=false;if(cmd==='JustifyCenter')
{align='center';}
else if(cmd==='JustifyRight')
{align='right';}
else if(cmd==='JustifyFull')
{align='justify';}
if(align===false)
{$(parent).css('text-align','');}
else
{$(parent).css('text-align',align);}}
else
{this.execRun(cmd,param);}}
else if(cmd==='formatblock'&&param==='blockquote')
{parent=this.getCurrentNode();if($(parent).get(0).tagName==='BLOCKQUOTE')
{if(this.browser('msie'))
{var node=$('<p>'+$(parent).html()+'</p>');$(parent).replaceWith(node);}
else
{this.execRun(cmd,'p');}}
else if($(parent).get(0).tagName==='P')
{var parent2=$(parent).parent();if($(parent2).get(0).tagName==='BLOCKQUOTE')
{var node=$('<p>'+$(parent).html()+'</p>');$(parent2).replaceWith(node);this.setSelection(node[0],0,node[0],0);}
else
{if(this.browser('msie'))
{var node=$('<blockquote>'+$(parent).html()+'</blockquote>');$(parent).replaceWith(node);}
else
{this.execRun(cmd,param);}}}
else
{this.execRun(cmd,param);}}
else if(cmd==='formatblock'&&(param==='pre'||param==='p'))
{parent=this.getParentNode();if($(parent).get(0).tagName==='PRE')
{$(parent).replaceWith('<p>'+this.encodeEntities($(parent).text())+'</p>');}
else
{this.execRun(cmd,param);}}
else
{if(cmd==='inserthorizontalrule'&&this.browser('msie'))
{this.$editor.focus();}
if(cmd==='formatblock'&&this.browser('mozilla'))
{this.$editor.focus();}
this.execRun(cmd,param);}
if(cmd==='inserthorizontalrule')
{this.$editor.find('hr').removeAttr('id');}
this.syncCode();if(this.oldIE())
{this.$editor.focus();}
if(typeof this.opts.execCommandCallback==='function')
{this.opts.execCommandCallback(this,cmd);}
if(this.opts.air)
{this.air.hide();}}
catch(e){}},execRun:function(cmd,param)
{if(cmd==='formatblock'&&this.browser('msie'))
{param='<'+param+'>';}
this.document.execCommand(cmd,false,param);},formatNewLine:function(e)
{var parent=this.getParentNode();if(parent.nodeName==='DIV'&&parent.className==='redactor_editor')
{var element=$(this.getCurrentNode());if(element.get(0).tagName==='DIV'&&(element.html()===''||element.html()==='<br>'))
{var newElement=$('<p>').append(element.clone().get(0).childNodes);element.replaceWith(newElement);newElement.html('<br />');this.setSelection(newElement[0],0,newElement[0],0);}}},safariShiftKeyEnter:function(e,key)
{if(e.shiftKey&&key===13)
{e.preventDefault();this.insertNodeAtCaret($('<span><br /></span>').get(0));this.syncCode();return false;}
else
{return true;}},formatEmpty:function(e)
{var html=$.trim(this.$editor.html());html=html.replace(/<br\s?\/?>/i,'');var thtml=html.replace(/<p>\s?<\/p>/gi,'');if(html===''||thtml==='')
{e.preventDefault();var node=$(this.opts.emptyHtml).get(0);this.$editor.html(node);this.setSelection(node,0,node,0);this.syncCode();return false;}
else
{this.syncCode();}},paragraphy:function(str)
{str=$.trim(str);if(str===''||str==='<p></p>')
{return this.opts.emptyHtml;}
if(this.opts.convertDivs)
{str=str.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,'<p>$2</p>');}
var X=function(x,a,b){return x.replace(new RegExp(a,'g'),b);};var R=function(a,b){return X(str,a,b);};var blocks='(table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|math|style|script|object|input|param|p|h[1-6])';str+='\n';R('<br />\\s*<br />','\n\n');R('(<'+blocks+'[^>]*>)','\n$1');R('(</'+blocks+'>)','$1\n\n');R('\r\n|\r','\n');R('\n\n+','\n\n');R('\n?((.|\n)+?)$','<p>$1</p>\n');R('<p>\\s*?</p>','');R('<p>(<div[^>]*>\\s*)','$1<p>');R('<p>([^<]+)\\s*?(</(div|address|form)[^>]*>)','<p>$1</p>$2');R('<p>\\s*(</?'+blocks+'[^>]*>)\\s*</p>','$1');R('<p>(<li.+?)</p>','$1');R('<p>\\s*(</?'+blocks+'[^>]*>)','$1');R('(</?'+blocks+'[^>]*>)\\s*</p>','$1');R('(</?'+blocks+'[^>]*>)\\s*<br />','$1');R('<br />(\\s*</?(p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)','$1');if(str.indexOf('<pre')!=-1)
{R('(<pre(.|\n)*?>)((.|\n)*?)</pre>',function(m0,m1,m2,m3)
{return X(m1,'\\\\([\'\"\\\\])','$1')+X(X(X(m3,'<p>','\n'),'</p>|<br />',''),'\\\\([\'\"\\\\])','$1')+'</pre>';});}
return R('\n</p>$','</p>');},stripTags:function(html)
{var allowed=this.opts.allowedTags;var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return html.replace(tags,function($0,$1)
{return $.inArray($1.toLowerCase(),allowed)>'-1'?$0:'';});},savePreCode:function(html)
{var pre=html.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);if(pre!==null)
{$.each(pre,$.proxy(function(i,s)
{var arr=s.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);arr[2]=this.encodeEntities(arr[2]);html=html.replace(s,'<pre'+arr[1]+'>'+arr[2]+'</pre>');},this));}
return html;},encodeEntities:function(str)
{str=String(str).replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"');return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');},cleanupPre:function(s)
{s=s.replace(/<br>/gi,'\n');s=s.replace(/<\/p>/gi,'\n');s=s.replace(/<\/div>/gi,'\n');var tmp=this.document.createElement("div");tmp.innerHTML=s;return tmp.textContent||tmp.innerText;},pasteCleanUp:function(html)
{var parent=this.getParentNode();if($(parent).get(0).tagName==='PRE')
{html=this.cleanupPre(html);this.pasteCleanUpInsert(html);return true;}
html=html.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,'');html=html.replace(/(&nbsp;){2,}/gi,'&nbsp;');html=html.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2");html=this.stripTags(html);html=html.replace(/<td><\/td>/gi,'[td]');html=html.replace(/<td>&nbsp;<\/td>/gi,'[td]');html=html.replace(/<td><br><\/td>/gi,'[td]');html=html.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]');html=html.replace(/<iframe(.*?)>([\w\W]*?)<\/iframe>/gi,'[iframe$1]$2[/iframe]');html=html.replace(/<video(.*?)>([\w\W]*?)<\/video>/gi,'[video$1]$2[/video]');html=html.replace(/<audio(.*?)>([\w\W]*?)<\/audio>/gi,'[audio$1]$2[/audio]');html=html.replace(/<embed(.*?)>([\w\W]*?)<\/embed>/gi,'[embed$1]$2[/embed]');html=html.replace(/<object(.*?)>([\w\W]*?)<\/object>/gi,'[object$1]$2[/object]');html=html.replace(/<param(.*?)>/gi,'[param$1]');html=html.replace(/<img(.*?)style="(.*?)"(.*?)>/gi,'[img$1$3]');html=html.replace(/<(\w+)([\w\W]*?)>/gi,'<$1>');html=html.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,'');html=html.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,'');html=html.replace(/\[td\]/gi,'<td>&nbsp;</td>');html=html.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>');html=html.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,'<iframe$1>$2</iframe>');html=html.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,'<video$1>$2</video>');html=html.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,'<audio$1>$2</audio>');html=html.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,'<embed$1>$2</embed>');html=html.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,'<object$1>$2</object>');html=html.replace(/\[param(.*?)\]/gi,'<param$1>');html=html.replace(/\[img(.*?)\]/gi,'<img$1>');if(this.opts.convertDivs)
{html=html.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,'<p>$2</p>');}
html=html.replace(/<span>([\w\W]*?)<\/span>/gi,'$1');html=html.replace(/\n{3,}/gi,'\n');html=html.replace(/<p><p>/gi,'<p>');html=html.replace(/<\/p><\/p>/gi,'</p>');if(this.browser('mozilla'))
{html=html.replace(/<br>$/gi,'');}
this.pasteCleanUpInsert(html);},pasteCleanUpInsert:function(html)
{this.execCommand('inserthtml',html);if(this.opts.autoresize===true)
{$(this.document.body).scrollTop(this.saveScroll);}
else
{this.$editor.scrollTop(this.saveScroll);}},formattingRemove:function(html)
{var prebuffer=[];var pre=html.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);if(pre!==null)
{$.each(pre,function(i,s)
{html=html.replace(s,'prebuffer_'+i);prebuffer.push(s);});}
html=html.replace(/\s{2,}/g,' ');html=html.replace(/\n/g,' ');html=html.replace(/[\t]*/g,'');html=html.replace(/\n\s*\n/g,"\n");html=html.replace(/^[\s\n]*/g,'');html=html.replace(/[\s\n]*$/g,'');html=html.replace(/>\s+</g,'><');if(prebuffer)
{$.each(prebuffer,function(i,s)
{html=html.replace('prebuffer_'+i,s);});prebuffer=[];}
return html;},formattingIndenting:function(html)
{html=html.replace(/<li/g,"\t<li");html=html.replace(/<tr/g,"\t<tr");html=html.replace(/<td/g,"\t\t<td");html=html.replace(/<\/tr>/g,"\t</tr>");return html;},formattingEmptyTags:function(html)
{var etags=["<pre></pre>","<blockquote>\\s*</blockquote>","<em>\\s*</em>","<ul></ul>","<ol></ol>","<li></li>","<table></table>","<tr></tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*</b>","<b>&nbsp;</b>","<p>\\s*</p>","<p>&nbsp;</p>","<p>\\s*<br>\\s*</p>","<div>\\s*</div>","<div>\\s*<br>\\s*</div>"];for(var i=0;i<etags.length;++i)
{var bbb=etags[i];html=html.replace(new RegExp(bbb,'gi'),"");}
return html;},formattingAddBefore:function(html)
{var lb='\r\n';var btags=["<p","<form","</ul>",'</ol>',"<fieldset","<legend","<object","<embed","<select","<option","<input","<textarea","<pre","<blockquote","<ul","<ol","<li","<dl","<dt","<dd","<table","<thead","<tbody","<caption","</caption>","<th","<tr","<td","<figure"];for(var i=0;i<btags.length;++i)
{var eee=btags[i];html=html.replace(new RegExp(eee,'gi'),lb+eee);}
return html;},formattingAddAfter:function(html)
{var lb='\r\n';var atags=['</p>','</div>','</h1>','</h2>','</h3>','</h4>','</h5>','</h6>','<br>','<br />','</dl>','</dt>','</dd>','</form>','</blockquote>','</pre>','</legend>','</fieldset>','</object>','</embed>','</textarea>','</select>','</option>','</table>','</thead>','</tbody>','</tr>','</td>','</th>','</figure>'];for(var i=0;i<atags.length;++i)
{var aaa=atags[i];html=html.replace(new RegExp(aaa,'gi'),aaa+lb);}
return html;},formatting:function(html)
{html=this.formattingRemove(html);html=this.formattingEmptyTags(html);html=this.formattingAddBefore(html);html=this.formattingAddAfter(html);html=this.formattingIndenting(html);return html;},toggle:function()
{var html;if(this.opts.visual)
{var height=this.$editor.innerHeight();this.$editor.hide();this.$content.hide();html=this.$editor.html();this.$el.height(height).val(html).show().focus();this.setBtnActive('html');this.opts.visual=false;}
else
{this.$el.hide();var html=this.$el.val();this.$editor.html(html).show();this.$content.show();if(this.$editor.html()==='')
{this.setCode(this.opts.emptyHtml);}
this.$editor.focus();this.setBtnInactive('html');this.opts.visual=true;this.observeImages();this.observeTables();}},autoSave:function()
{this.autosaveInterval=setInterval($.proxy(function()
{$.ajax({url:this.opts.autosave,type:'post',data:this.$el.attr('name')+'='+escape(encodeURIComponent(this.getCode())),success:$.proxy(function(data)
{if(typeof this.opts.autosaveCallback==='function')
{this.opts.autosaveCallback(data,this);}},this)});},this),this.opts.interval*1000);},buildToolbar:function()
{if(this.opts.toolbar===false)
{return false;}
this.$toolbar=$('<ul>').addClass('redactor_toolbar');if(this.opts.air)
{$(this.air).append(this.$toolbar);$('body').append(this.air);}
else
{if(this.opts.toolbarExternal===false)
{this.$box.prepend(this.$toolbar);}
else
{$(this.opts.toolbarExternal).html(this.$toolbar);}}
$.each(this.opts.buttons,$.proxy(function(i,key)
{if(key!=='|'&&typeof this.opts.toolbar[key]!=='undefined')
{var s=this.opts.toolbar[key];if(this.opts.fileUpload===false&&key==='file')
{return true;}
this.$toolbar.append($('<li>').append(this.buildButton(key,s)));}
if(key==='|')
{this.$toolbar.append($('<li class="redactor_separator"></li>'));}},this));},buildButton:function(key,s)
{var button=$('<a href="javascript:void(null);" title="'+s.title+'" class="redactor_btn_'+key+'"></a>');if(typeof s.func==='undefined')
{button.click($.proxy(function()
{if($.inArray(key,this.opts.activeButtons)!=-1)
{this.inactiveAllButtons();this.setBtnActive(key);}
if(this.browser('mozilla'))
{this.$editor.focus();}
this.execCommand(s.exec,key);},this));}
else if(s.func!=='show')
{button.click($.proxy(function(e){this[s.func](e);},this));}
if(typeof s.callback!=='undefined'&&s.callback!==false)
{button.click($.proxy(function(e){s.callback(this,e,key);},this));}
if(key==='backcolor'||key==='fontcolor'||typeof(s.dropdown)!=='undefined')
{var dropdown=$('<div class="redactor_dropdown" style="display: none;">');if(key==='backcolor'||key==='fontcolor')
{dropdown=this.buildColorPicker(dropdown,key);}
else
{dropdown=this.buildDropdown(dropdown,s.dropdown);}
this.dropdowns.push(dropdown.appendTo($(document.body)));this.hdlShowDropDown=$.proxy(function(e){this.showDropDown(e,dropdown,key);},this);button.click(this.hdlShowDropDown);}
return button;},buildDropdown:function(dropdown,obj)
{$.each(obj,$.proxy(function(x,d)
{if(typeof(d.className)==='undefined')
{d.className='';}
var drop_a;if(typeof d.name!=='undefined'&&d.name==='separator')
{drop_a=$('<a class="redactor_separator_drop">');}
else
{drop_a=$('<a href="javascript:void(null);" class="'+d.className+'">'+d.title+'</a>');if(typeof(d.callback)==='function')
{$(drop_a).click($.proxy(function(e){d.callback(this,e,x);},this));}
else if(typeof(d.func)==='undefined')
{$(drop_a).click($.proxy(function(){this.execCommand(d.exec,x);},this));}
else
{$(drop_a).click($.proxy(function(e){this[d.func](e);},this));}}
$(dropdown).append(drop_a);},this));return dropdown;},buildColorPicker:function(dropdown,key)
{var mode;if(key==='backcolor')
{if(this.browser('msie'))
{mode='BackColor';}
else
{mode='hilitecolor';}}
else
{mode='forecolor';}
$(dropdown).width(210);var len=this.opts.colors.length;for(var i=0;i<len;++i)
{var color=this.opts.colors[i];var swatch=$('<a rel="'+color+'" href="javascript:void(null);" class="redactor_color_link"></a>').css({'backgroundColor':color});$(dropdown).append(swatch);var _self=this;$(swatch).click(function()
{_self.execCommand(mode,$(this).attr('rel'));if(mode==='forecolor')
{_self.$editor.find('font').replaceWith(function(){return $('<span style="color: '+$(this).attr('color')+';">'+$(this).html()+'</span>');});}
if(_self.browser('msie')&&mode==='BackColor')
{_self.$editor.find('font').replaceWith(function(){return $('<span style="'+$(this).attr('style')+'">'+$(this).html()+'</span>');});}});}
var elnone=$('<a href="javascript:void(null);" class="redactor_color_none"></a>').html(RLANG.none);if(key==='backcolor')
{elnone.click($.proxy(this.setBackgroundNone,this));}
else
{elnone.click($.proxy(this.setColorNone,this));}
$(dropdown).append(elnone);return dropdown;},setBackgroundNone:function()
{$(this.getParentNode()).css('background-color','transparent');this.syncCode();},setColorNone:function()
{$(this.getParentNode()).attr('color','').css('color','');this.syncCode();},showDropDown:function(e,dropdown,key)
{if(this.getBtn(key).hasClass('dropact'))
{this.hideAllDropDown();}
else
{this.hideAllDropDown();this.setBtnActive(key);this.getBtn(key).addClass('dropact');var left=this.getBtn(key).offset().left;if(this.opts.air)
{var air_top=this.air.offset().top;$(dropdown).css({position:'absolute',left:left+'px',top:air_top+30+'px'}).show();}
else if(this.opts.fixed&&this.fixed)
{$(dropdown).css({position:'fixed',left:left+'px',top:'30px'}).show();}
else
{var top=this.$toolbar.offset().top+30;$(dropdown).css({position:'absolute',left:left+'px',top:top+'px'}).show();}}
var hdlHideDropDown=$.proxy(function(e){this.hideDropDown(e,dropdown,key);},this);$(document).one('click',hdlHideDropDown);this.$editor.one('click',hdlHideDropDown);this.$content.one('click',hdlHideDropDown);e.stopPropagation();},hideAllDropDown:function()
{this.$toolbar.find('a.dropact').removeClass('redactor_act').removeClass('dropact');$('.redactor_dropdown').hide();},hideDropDown:function(e,dropdown,key)
{if(!$(e.target).hasClass('dropact'))
{$(dropdown).removeClass('dropact');this.showedDropDown=false;this.hideAllDropDown();}},getBtn:function(key)
{if(this.opts.toolbar===false)
{return false;}
return $(this.$toolbar.find('a.redactor_btn_'+key));},setBtnActive:function(key)
{this.getBtn(key).addClass('redactor_act');},setBtnInactive:function(key)
{this.getBtn(key).removeClass('redactor_act');},inactiveAllButtons:function()
{$.each(this.opts.activeButtons,$.proxy(function(i,s)
{this.setBtnInactive(s);},this));},changeBtnIcon:function(key,classname)
{this.getBtn(key).addClass('redactor_btn_'+classname);},removeBtnIcon:function(key,classname)
{this.getBtn(key).removeClass('redactor_btn_'+classname);},addBtnSeparator:function()
{this.$toolbar.append($('<li class="redactor_separator"></li>'));},addBtnSeparatorAfter:function(key)
{var $btn=this.getBtn(key);$btn.parent().after($('<li class="redactor_separator"></li>'));},addBtnSeparatorBefore:function(key)
{var $btn=this.getBtn(key);$btn.parent().before($('<li class="redactor_separator"></li>'));},removeBtnSeparatorAfter:function(key)
{var $btn=this.getBtn(key);$btn.parent().next().remove();},removeBtnSeparatorBefore:function(key)
{var $btn=this.getBtn(key);$btn.parent().prev().remove();},setBtnRight:function(key)
{if(this.opts.toolbar===false)
{return false;}
this.getBtn(key).parent().addClass('redactor_btn_right');},setBtnLeft:function(key)
{if(this.opts.toolbar===false)
{return false;}
this.getBtn(key).parent().removeClass('redactor_btn_right');},addBtn:function(key,title,callback,dropdown)
{if(this.opts.toolbar===false)
{return false;}
var btn=this.buildButton(key,{title:title,callback:callback,dropdown:dropdown});this.$toolbar.append($('<li>').append(btn));},addBtnFirst:function(key,title,callback,dropdown)
{if(this.opts.toolbar===false)
{return false;}
var btn=this.buildButton(key,{title:title,callback:callback,dropdown:dropdown});this.$toolbar.prepend($('<li>').append(btn));},addBtnAfter:function(afterkey,key,title,callback,dropdown)
{if(this.opts.toolbar===false)
{return false;}
var btn=this.buildButton(key,{title:title,callback:callback,dropdown:dropdown});var $btn=this.getBtn(afterkey);$btn.parent().after($('<li>').append(btn));},addBtnBefore:function(beforekey,key,title,callback,dropdown)
{if(this.opts.toolbar===false)
{return false;}
var btn=this.buildButton(key,{title:title,callback:callback,dropdown:dropdown});var $btn=this.getBtn(beforekey);$btn.parent().before($('<li>').append(btn));},removeBtn:function(key,separator)
{var $btn=this.getBtn(key);if(separator===true)
{$btn.parent().next().remove();}
$btn.parent().removeClass('redactor_btn_right');$btn.remove();},getFragmentHtml:function(fragment)
{var cloned=fragment.cloneNode(true);var div=this.document.createElement('div');div.appendChild(cloned);return div.innerHTML;},extractContent:function()
{var node=this.$editor.get(0);var frag=this.document.createDocumentFragment(),child;while((child=node.firstChild))
{frag.appendChild(child);}
return frag;},saveSelection:function()
{this.$editor.focus();this.savedSel=this.getOrigin();this.savedSelObj=this.getFocus();},restoreSelection:function()
{if(typeof this.savedSel!=='undefined'&&this.savedSel!==null&&this.savedSelObj!==null&&this.savedSel[0].tagName!=='BODY')
{if(this.opts.iframe===false&&$(this.savedSel[0]).closest('.redactor_editor').size()==0)
{this.$editor.focus();}
else
{if(this.browser('opera'))
{this.$editor.focus();}
this.setSelection(this.savedSel[0],this.savedSel[1],this.savedSelObj[0],this.savedSelObj[1]);if(this.browser('mozilla'))
{this.$editor.focus();}}}
else
{this.$editor.focus();}},getSelection:function()
{var doc=this.document;if(this.window.getSelection)
{return this.window.getSelection();}
else if(doc.getSelection)
{return doc.getSelection();}
else
{return doc.selection.createRange();}
return false;},hasSelection:function()
{if(!this.oldIE())
{var sel;return(sel=this.getSelection())&&(sel.focusNode!=null)&&(sel.anchorNode!=null);}
else
{var node=this.$editor.get(0);var range;node.focus();if(!node.document.selection)
{return false;}
range=node.document.selection.createRange();return range&&range.parentElement().document===node.document;}},getOrigin:function()
{if(!this.oldIE())
{var sel;if(!((sel=this.getSelection())&&(sel.anchorNode!=null)))
{return null;}
return[sel.anchorNode,sel.anchorOffset];}
else
{var node=this.$editor.get(0);var range;node.focus();if(!this.hasSelection())
{return null;}
range=node.document.selection.createRange();return this._getBoundary(node.document,range,true);}},getFocus:function()
{if(!this.oldIE())
{var sel;if(!((sel=this.getSelection())&&(sel.focusNode!=null)))
{return null;}
return[sel.focusNode,sel.focusOffset];}
else
{var node=this.$editor.get(0);var range;node.focus();if(!this.hasSelection())
{return null;}
range=node.document.selection.createRange();return this._getBoundary(node.document,range,false);}},setSelection:function(orgn,orgo,focn,foco)
{if(focn==null)
{focn=orgn;}
if(foco==null)
{foco=orgo;}
if(!this.oldIE())
{var sel=this.getSelection();if(!sel)
{return;}
if(sel.collapse&&sel.extend)
{sel.collapse(orgn,orgo);sel.extend(focn,foco);}
else
{r=this.document.createRange();r.setStart(orgn,orgo);r.setEnd(focn,foco);try
{sel.removeAllRanges();}
catch(e){}
sel.addRange(r);}}
else
{var node=this.$editor.get(0);var range=node.document.body.createTextRange();this._moveBoundary(node.document,range,false,focn,foco);this._moveBoundary(node.document,range,true,orgn,orgo);return range.select();}},getCurrentNode:function()
{if(typeof this.window.getSelection!=='undefined')
{return this.getSelectedNode().parentNode;}
else if(typeof this.document.selection!=='undefined')
{return this.getSelection().parentElement();}},getParentNode:function()
{return $(this.getCurrentNode()).parent()[0]},getSelectedNode:function()
{if(this.oldIE())
{return this.getSelection().parentElement();}
else if(typeof this.window.getSelection!=='undefined')
{var s=this.window.getSelection();if(s.rangeCount>0)
{return this.getSelection().getRangeAt(0).commonAncestorContainer;}
else
{return false;}}
else if(typeof this.document.selection!=='undefined')
{return this.getSelection();}},_getBoundary:function(doc,textRange,bStart)
{var cursor,cursorNode,node,offset,parent;cursorNode=doc.createElement('a');cursor=textRange.duplicate();cursor.collapse(bStart);parent=cursor.parentElement();while(true)
{parent.insertBefore(cursorNode,cursorNode.previousSibling);cursor.moveToElementText(cursorNode);if(!(cursor.compareEndPoints((bStart?'StartToStart':'StartToEnd'),textRange)>0&&(cursorNode.previousSibling!=null)))
{break;}}
if(cursor.compareEndPoints((bStart?'StartToStart':'StartToEnd'),textRange)===-1&&cursorNode.nextSibling)
{cursor.setEndPoint((bStart?'EndToStart':'EndToEnd'),textRange);node=cursorNode.nextSibling;offset=cursor.text.length;}
else
{node=cursorNode.parentNode;offset=this._getChildIndex(cursorNode);}
cursorNode.parentNode.removeChild(cursorNode);return[node,offset];},_moveBoundary:function(doc,textRange,bStart,node,offset)
{var anchorNode,anchorParent,cursor,cursorNode,textOffset;textOffset=0;anchorNode=this._isText(node)?node:node.childNodes[offset];anchorParent=this._isText(node)?node.parentNode:node;if(this._isText(node))
{textOffset=offset;}
cursorNode=doc.createElement('a');anchorParent.insertBefore(cursorNode,anchorNode||null);cursor=doc.body.createTextRange();cursor.moveToElementText(cursorNode);cursorNode.parentNode.removeChild(cursorNode);textRange.setEndPoint((bStart?'StartToStart':'EndToEnd'),cursor);return textRange[bStart?'moveStart':'moveEnd']('character',textOffset);},_isText:function(d)
{return(d!=null?d.nodeType==3:false);},_getChildIndex:function(e)
{var k=0;while(e=e.previousSibling){k++;}
return k;},insertNodeAfterCaret:function(node)
{this.saveSelection();this.insertNodeAtCaret(node);this.restoreSelection();},insertNodeAtCaret:function(node)
{if(this.window.getSelection)
{var sel=this.getSelection();if(sel.rangeCount)
{var range=sel.getRangeAt(0);range.collapse(false);range.insertNode(node);range=range.cloneRange();range.selectNodeContents(node);range.collapse(false);sel.removeAllRanges();sel.addRange(range);}}
else if(this.document.selection)
{var html=(node.nodeType===1)?node.outerHTML:node.data;var id="marker_"+(""+Math.random()).slice(2);html+='<span id="'+id+'"></span>';var textRange=this.getSelection();textRange.collapse(false);textRange.pasteHTML(html);var markerSpan=this.document.getElementById(id);textRange.moveToElementText(markerSpan);textRange.select();markerSpan.parentNode.removeChild(markerSpan);}},getSelectedHtml:function()
{var html='';if(this.window.getSelection)
{var sel=this.window.getSelection();if(sel.rangeCount)
{var container=this.document.createElement("div");for(var i=0,len=sel.rangeCount;i<len;++i)
{container.appendChild(sel.getRangeAt(i).cloneContents());}
html=container.innerHTML;}}
else if(this.document.selection)
{if(this.document.selection.type==="Text")
{html=this.document.selection.createRange().htmlText;}}
return html;},resizeImage:function(resize)
{var clicked=false;var clicker=false;var start_x;var start_y;var ratio=$(resize).width()/$(resize).height();var min_w=10;var min_h=10;$(resize).off('hover mousedown mouseup click mousemove');$(resize).hover(function(){$(resize).css('cursor','nw-resize');},function(){$(resize).css('cursor','');clicked=false;});$(resize).mousedown(function(e)
{e.preventDefault();ratio=$(resize).width()/$(resize).height();clicked=true;clicker=true;start_x=Math.round(e.pageX-$(resize).eq(0).offset().left);start_y=Math.round(e.pageY-$(resize).eq(0).offset().top);});$(resize).mouseup($.proxy(function(e)
{clicked=false;$(resize).css('cursor','');this.syncCode();},this));$(resize).click($.proxy(function(e)
{if(clicker)
{this.imageEdit(e);}},this));$(resize).mousemove(function(e)
{if(clicked)
{clicker=false;var mouse_x=Math.round(e.pageX-$(this).eq(0).offset().left)-start_x;var mouse_y=Math.round(e.pageY-$(this).eq(0).offset().top)-start_y;var div_h=$(resize).height();var new_h=parseInt(div_h,10)+mouse_y;var new_w=new_h*ratio;if(new_w>min_w)
{$(resize).width(new_w);}
if(new_h>min_h)
{$(resize).height(new_h);}
start_x=Math.round(e.pageX-$(this).eq(0).offset().left);start_y=Math.round(e.pageY-$(this).eq(0).offset().top);}});},showTable:function()
{this.saveSelection();this.modalInit(RLANG.table,this.opts.modal_table,300,$.proxy(function()
{$('#redactor_insert_table_btn').click($.proxy(this.insertTable,this));setTimeout(function()
{$('#redactor_table_rows').focus();},200);},this));},insertTable:function()
{var rows=$('#redactor_table_rows').val();var columns=$('#redactor_table_columns').val();var table_box=$('<div></div>');var tableid=Math.floor(Math.random()*99999);var table=$('<table id="table'+tableid+'"><tbody></tbody></table>');for(var i=0;i<rows;i++)
{var row=$('<tr></tr>');for(var z=0;z<columns;z++)
{var column=$('<td><br></td>');$(row).append(column);}
$(table).append(row);}
$(table_box).append(table);var html=$(table_box).html()+'<p></p>';this.restoreSelection();this.execCommand('inserthtml',html);this.modalClose();this.observeTables();},tableObserver:function(e)
{this.$table=$(e.target).closest('table');this.$table_tr=this.$table.find('tr');this.$table_td=this.$table.find('td');this.$tbody=$(e.target).closest('tbody');this.$thead=$(this.$table).find('thead');this.$current_td=$(e.target);this.$current_tr=$(e.target).closest('tr');},deleteTable:function()
{$(this.$table).remove();this.$table=false;this.syncCode();},deleteRow:function()
{$(this.$current_tr).remove();this.syncCode();},deleteColumn:function()
{var index=$(this.$current_td).get(0).cellIndex;$(this.$table).find('tr').each(function()
{$(this).find('td').eq(index).remove();});this.syncCode();},addHead:function()
{if($(this.$table).find('thead').size()!==0)
{this.deleteHead();}
else
{var tr=$(this.$table).find('tr').first().clone();tr.find('td').html('&nbsp;');this.$thead=$('<thead></thead>');this.$thead.append(tr);$(this.$table).prepend(this.$thead);this.syncCode();}},deleteHead:function()
{$(this.$thead).remove();this.$thead=false;this.syncCode();},insertRowAbove:function()
{this.insertRow('before');},insertRowBelow:function()
{this.insertRow('after');},insertColumnLeft:function()
{this.insertColumn('before');},insertColumnRight:function()
{this.insertColumn('after');},insertRow:function(type)
{var new_tr=$(this.$current_tr).clone();new_tr.find('td').html('&nbsp;');if(type==='after')
{$(this.$current_tr).after(new_tr);}
else
{$(this.$current_tr).before(new_tr);}
this.syncCode();},insertColumn:function(type)
{var index=0;this.$current_tr.find('td').each($.proxy(function(i,s)
{if($(s)[0]===this.$current_td[0])
{index=i;}},this));this.$table_tr.each(function(i,s)
{var current=$(s).find('td').eq(index);var td=current.clone();td.html('&nbsp;');if(type==='after')
{$(current).after(td);}
else
{$(current).before(td);}});this.syncCode();},showVideo:function()
{this.saveSelection();this.modalInit(RLANG.video,this.opts.modal_video,600,$.proxy(function()
{$('#redactor_insert_video_btn').click($.proxy(this.insertVideo,this));setTimeout(function()
{$('#redactor_insert_video_area').focus();},200);},this));},insertVideo:function()
{var data=$('#redactor_insert_video_area').val();data=this.stripTags(data);this.restoreSelection();this.execCommand('inserthtml',data);this.modalClose();},imageEdit:function(e)
{var $el=$(e.target);var parent=$el.parent();var callback=$.proxy(function()
{$('#redactor_file_alt').val($el.attr('alt'));$('#redactor_image_edit_src').attr('href',$el.attr('src'));$('#redactor_form_image_align').val($el.css('float'));if($(parent).get(0).tagName==='A')
{$('#redactor_file_link').val($(parent).attr('href'));}
$('#redactor_image_delete_btn').click($.proxy(function(){this.imageDelete($el);},this));$('#redactorSaveBtn').click($.proxy(function(){this.imageSave($el);},this));},this);this.modalInit(RLANG.image,this.opts.modal_image_edit,380,callback);},imageDelete:function(el)
{$(el).remove();this.modalClose();this.syncCode();},imageSave:function(el)
{var parent=$(el).parent();$(el).attr('alt',$('#redactor_file_alt').val());var floating=$('#redactor_form_image_align').val();if(floating==='left')
{$(el).css({'float':'left',margin:'0 10px 10px 0'});}
else if(floating==='right')
{$(el).css({'float':'right',margin:'0 0 10px 10px'});}
else
{$(el).css({'float':'none',margin:'0'});}
var link=$.trim($('#redactor_file_link').val());if(link!=='')
{if($(parent).get(0).tagName!=='A')
{$(el).replaceWith('<a href="'+link+'">'+this.outerHTML(el)+'</a>');}
else
{$(parent).attr('href',link);}}
else
{if($(parent).get(0).tagName==='A')
{$(parent).replaceWith(this.outerHTML(el));}}
this.modalClose();this.observeImages();this.syncCode();},showImage:function()
{this.saveSelection();var callback=$.proxy(function()
{if(this.opts.imageGetJson!==false)
{$.getJSON(this.opts.imageGetJson,$.proxy(function(data){var folders={};var z=0;$.each(data,$.proxy(function(key,val)
{if(typeof val.folder!=='undefined')
{z++;folders[val.folder]=z;}},this));var folderclass=false;$.each(data,$.proxy(function(key,val)
{var thumbtitle='';if(typeof val.title!=='undefined')
{thumbtitle=val.title;}
var folderkey=0;if(!$.isEmptyObject(folders)&&typeof val.folder!=='undefined')
{folderkey=folders[val.folder];if(folderclass===false)
{folderclass='.redactorfolder'+folderkey;}}
var img=$('<img src="'+val.thumb+'" class="redactorfolder redactorfolder'+folderkey+'" rel="'+val.image+'" title="'+thumbtitle+'" />');$('#redactor_image_box').append(img);$(img).click($.proxy(this.imageSetThumb,this));},this));if(!$.isEmptyObject(folders))
{$('.redactorfolder').hide();$(folderclass).show();var onchangeFunc=function(e)
{$('.redactorfolder').hide();$('.redactorfolder'+$(e.target).val()).show();}
var select=$('<select id="redactor_image_box_select">');$.each(folders,function(k,v)
{select.append($('<option value="'+v+'">'+k+'</option>'));});$('#redactor_image_box').before(select);select.change(onchangeFunc);}},this));}
else
{$('#redactor_tabs a').eq(1).remove();}
if(this.opts.imageUpload!==false)
{if(this.opts.uploadCrossDomain===false&&this.isMobile()===false)
{if($('#redactor_file').size()!==0)
{$('#redactor_file').dragupload({url:this.opts.imageUpload,uploadFields:this.opts.uploadFields,success:$.proxy(this.imageUploadCallback,this),error:$.proxy(this.opts.imageUploadErrorCallback,this)});}}
this.uploadInit('redactor_file',{auto:true,url:this.opts.imageUpload,success:$.proxy(this.imageUploadCallback,this),error:$.proxy(this.opts.imageUploadErrorCallback,this)});}
else
{$('.redactor_tab').hide();if(this.opts.imageGetJson===false)
{$('#redactor_tabs').remove();$('#redactor_tab3').show();}
else
{var tabs=$('#redactor_tabs a');tabs.eq(0).remove();tabs.eq(1).addClass('redactor_tabs_act');$('#redactor_tab2').show();}}
$('#redactor_upload_btn').click($.proxy(this.imageUploadCallbackLink,this));if(this.opts.imageUpload===false&&this.opts.imageGetJson===false)
{setTimeout(function()
{$('#redactor_file_link').focus();},200);}},this);this.modalInit(RLANG.image,this.opts.modal_image,610,callback);},imageSetThumb:function(e)
{this._imageSet('<img src="'+$(e.target).attr('rel')+'" alt="'+$(e.target).attr('title')+'" />',true);},imageUploadCallbackLink:function()
{if($('#redactor_file_link').val()!=='')
{var data='<img src="'+$('#redactor_file_link').val()+'" />';this._imageSet(data,true);}
else
{this.modalClose();}},imageUploadCallback:function(data)
{this._imageSet(data);},_imageSet:function(json,link)
{this.restoreSelection();if(json!==false)
{var html='';if(link!==true)
{html='<p><img src="'+json.filelink+'" /></p>';}
else
{html=json;}
this.execCommand('inserthtml',html);if(link!==true&&typeof this.opts.imageUploadCallback==='function')
{this.opts.imageUploadCallback(this,json);}}
this.modalClose();this.observeImages();},showLink:function()
{this.saveSelection();var callback=$.proxy(function()
{this.insert_link_node=false;var sel=this.getSelection();var url='',text='',target='';if(this.browser('msie'))
{var parent=this.getParentNode();if(parent.nodeName==='A')
{this.insert_link_node=$(parent);text=this.insert_link_node.text();url=this.insert_link_node.attr('href');target=this.insert_link_node.attr('target');}
else
{if(this.oldIE())
{text=sel.text;}
else
{text=sel.toString();}}}
else
{if(sel&&sel.anchorNode&&sel.anchorNode.parentNode.tagName==='A')
{url=sel.anchorNode.parentNode.href;text=sel.anchorNode.parentNode.text;target=sel.anchorNode.parentNode.target;if(sel.toString()==='')
{this.insert_link_node=sel.anchorNode.parentNode;}}
else
{text=sel.toString();}}
$('.redactor_link_text').val(text);var thref=self.location.href.replace(/\/$/i,'');var turl=url.replace(thref,'');if(url.search('mailto:')===0)
{this.setModalTab(2);$('#redactor_tab_selected').val(2);$('#redactor_link_mailto').val(url.replace('mailto:',''));}
else if(turl.search(/^#/gi)===0)
{this.setModalTab(3);$('#redactor_tab_selected').val(3);$('#redactor_link_anchor').val(turl.replace(/^#/gi,''));}
else
{$('#redactor_link_url').val(turl);}
if(target==='_blank')
{$('#redactor_link_blank').attr('checked',true);}
$('#redactor_insert_link_btn').click($.proxy(this.insertLink,this));setTimeout(function()
{$('#redactor_link_url').focus();},200);},this);this.modalInit(RLANG.link,this.opts.modal_link,460,callback);},insertLink:function()
{var tab_selected=$('#redactor_tab_selected').val();var link='',text='',targettext='',target='';if(tab_selected==='1')
{link=$('#redactor_link_url').val();text=$('#redactor_link_url_text').val();if($('#redactor_link_blank').prop('checked'))
{targettext=' target="_blank"';target='_blank';}
var pattern='/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/';var re=new RegExp('^(http|ftp|https)://'+pattern,'i');var re2=new RegExp('^'+pattern,'i');if(link.search(re)==-1&&link.search(re2)==0&&this.opts.protocol!==false)
{link=this.opts.protocol+link;}}
else if(tab_selected==='2')
{link='mailto:'+$('#redactor_link_mailto').val();text=$('#redactor_link_mailto_text').val();}
else if(tab_selected==='3')
{link='#'+$('#redactor_link_anchor').val();text=$('#redactor_link_anchor_text').val();}
this._insertLink('<a href="'+link+'"'+targettext+'>'+text+'</a>',$.trim(text),link,target);},_insertLink:function(a,text,link,target)
{this.$editor.focus();this.restoreSelection();if(text!=='')
{if(this.insert_link_node)
{$(this.insert_link_node).text(text);$(this.insert_link_node).attr('href',link);if(target!=='')
{$(this.insert_link_node).attr('target',target);}
else
{$(this.insert_link_node).removeAttr('target');}
this.syncCode();}
else
{this.execCommand('inserthtml',a);}}
this.modalClose();},showFile:function()
{this.saveSelection();var callback=$.proxy(function()
{var sel=this.getSelection();var text='';if(this.oldIE())
{text=sel.text;}
else
{text=sel.toString();}
$('#redactor_filename').val(text);if(this.opts.uploadCrossDomain===false&&this.isMobile()===false)
{$('#redactor_file').dragupload({url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:$.proxy(this.fileUploadCallback,this),error:$.proxy(this.opts.fileUploadErrorCallback,this)});}
this.uploadInit('redactor_file',{auto:true,url:this.opts.fileUpload,success:$.proxy(this.fileUploadCallback,this),error:$.proxy(this.opts.fileUploadErrorCallback,this)});},this);this.modalInit(RLANG.file,this.opts.modal_file,500,callback);},fileUploadCallback:function(json)
{this.restoreSelection();if(json!==false)
{var text=$('#redactor_filename').val();if(text==='')
{text=json.filename;}
var link='<a href="'+json.filelink+'">'+text+'</a>';if(this.browser('webkit')&&!!this.window.chrome)
{link=link+'&nbsp;';}
this.execCommand('inserthtml',link);if(typeof this.opts.fileUploadCallback==='function')
{this.opts.fileUploadCallback(this,json);}}
this.modalClose();},modalInit:function(title,content,width,callback)
{if($('#redactor_modal_overlay').size()===0)
{this.overlay=$('<div id="redactor_modal_overlay" style="display: none;"></div>');$('body').prepend(this.overlay);}
if(this.opts.overlay)
{$('#redactor_modal_overlay').show();$('#redactor_modal_overlay').click($.proxy(this.modalClose,this));}
if($('#redactor_modal').size()===0)
{this.modal=$('<div id="redactor_modal" style="display: none;"><div id="redactor_modal_close">&times;</div><div id="redactor_modal_header"></div><div id="redactor_modal_inner"></div></div>');$('body').append(this.modal);}
$('#redactor_modal_close').click($.proxy(this.modalClose,this));this.hdlModalClose=$.proxy(function(e){if(e.keyCode===27){this.modalClose();return false;}},this);$(document).keyup(this.hdlModalClose);this.$editor.keyup(this.hdlModalClose);if(content.indexOf('#')==0)
{$('#redactor_modal_inner').empty().append($(content).html());}
else
{$('#redactor_modal_inner').empty().append(content);}
$('#redactor_modal_header').html(title);if(typeof $.fn.draggable!=='undefined')
{$('#redactor_modal').draggable({handle:'#redactor_modal_header'});$('#redactor_modal_header').css('cursor','move');}
if($('#redactor_tabs').size()!==0)
{var that=this;$('#redactor_tabs a').each(function(i,s)
{i++;$(s).click(function()
{$('#redactor_tabs a').removeClass('redactor_tabs_act');$(this).addClass('redactor_tabs_act');$('.redactor_tab').hide();$('#redactor_tab'+i).show();$('#redactor_tab_selected').val(i);if(that.isMobile()===false)
{var height=$('#redactor_modal').outerHeight();$('#redactor_modal').css('margin-top','-'+(height+10)/2+'px');}});});}
$('#redactor_modal .redactor_btn_modal_close').click($.proxy(this.modalClose,this));if(this.isMobile()===false)
{$('#redactor_modal').css({position:'fixed',top:'-2000px',left:'50%',width:width+'px',marginLeft:'-'+(width+60)/2+'px'}).show();this.modalSaveBodyOveflow=$(document.body).css('overflow');$(document.body).css('overflow','hidden');}
else
{$('#redactor_modal').css({position:'fixed',width:'100%',height:'100%',top:'0',left:'0',margin:'0',minHeight:'300px'}).show();}
if(typeof callback==='function')
{callback();}
if(this.isMobile()===false)
{setTimeout(function()
{var height=$('#redactor_modal').outerHeight();$('#redactor_modal').css({top:'50%',height:'auto',minHeight:'auto',marginTop:'-'+(height+10)/2+'px'});},20);}},modalClose:function()
{$('#redactor_modal_close').unbind('click',this.modalClose);$('#redactor_modal').fadeOut('fast',$.proxy(function()
{$('#redactor_modal_inner').html('');if(this.opts.overlay)
{$('#redactor_modal_overlay').hide();$('#redactor_modal_overlay').unbind('click',this.modalClose);}
$(document).unbind('keyup',this.hdlModalClose);this.$editor.unbind('keyup',this.hdlModalClose);},this));if(this.isMobile()===false)
{$(document.body).css('overflow',this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:'visible');}
return false;},setModalTab:function(num)
{$('.redactor_tab').hide();var tabs=$('#redactor_tabs a');tabs.removeClass('redactor_tabs_act');tabs.eq(num-1).addClass('redactor_tabs_act');$('#redactor_tab'+num).show();},uploadInit:function(element,options)
{this.uploadOptions={url:false,success:false,error:false,start:false,trigger:false,auto:false,input:false};$.extend(this.uploadOptions,options);if($('#'+element).size()!==0&&$('#'+element).get(0).tagName==='INPUT')
{this.uploadOptions.input=$('#'+element);this.element=$($('#'+element).get(0).form);}
else
{this.element=$('#'+element);}
this.element_action=this.element.attr('action');if(this.uploadOptions.auto)
{$(this.uploadOptions.input).change($.proxy(function()
{this.element.submit(function(e){return false;});this.uploadSubmit();},this));}
else if(this.uploadOptions.trigger)
{$('#'+this.uploadOptions.trigger).click($.proxy(this.uploadSubmit,this));}},uploadSubmit:function()
{this.uploadForm(this.element,this.uploadFrame());},uploadFrame:function()
{this.id='f'+Math.floor(Math.random()*99999);var d=this.document.createElement('div');var iframe='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';d.innerHTML=iframe;$(d).appendTo("body");if(this.uploadOptions.start)
{this.uploadOptions.start();}
$('#'+this.id).load($.proxy(this.uploadLoaded,this));return this.id;},uploadForm:function(f,name)
{if(this.uploadOptions.input)
{var formId='redactorUploadForm'+this.id;var fileId='redactorUploadFile'+this.id;this.form=$('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+name+'" name="'+formId+'" id="'+formId+'" enctype="multipart/form-data"></form>');if(this.opts.uploadFields!==false&&typeof this.opts.uploadFields==='object')
{$.each(this.opts.uploadFields,$.proxy(function(k,v)
{if(v.toString().indexOf('#')===0)
{v=$(v).val();}
var hidden=$('<input/>',{'type':"hidden",'name':k,'value':v});$(this.form).append(hidden);},this));}
var oldElement=this.uploadOptions.input;var newElement=$(oldElement).clone();$(oldElement).attr('id',fileId);$(oldElement).before(newElement);$(oldElement).appendTo(this.form);$(this.form).css('position','absolute');$(this.form).css('top','-2000px');$(this.form).css('left','-2000px');$(this.form).appendTo('body');this.form.submit();}
else
{f.attr('target',name);f.attr('method','POST');f.attr('enctype','multipart/form-data');f.attr('action',this.uploadOptions.url);this.element.submit();}},uploadLoaded:function()
{var i=$('#'+this.id)[0];var d;if(i.contentDocument)
{d=i.contentDocument;}
else if(i.contentWindow)
{d=i.contentWindow.document;}
else
{d=window.frames[this.id].document;}
if(this.uploadOptions.success)
{if(typeof d!=='undefined')
{var rawString=d.body.innerHTML;var jsonString=rawString.match(/\{(.|\n)*\}/)[0];var json=$.parseJSON(jsonString);if(typeof json.error=='undefined')
{this.uploadOptions.success(json);}
else
{this.uploadOptions.error(this,json);this.modalClose();}}
else
{alert('Upload failed!');this.modalClose();}}
this.element.attr('action',this.element_action);this.element.attr('target','');},browser:function(browser)
{var ua=navigator.userAgent.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];if(browser=='version')
{return match[2];}
if(browser=='webkit')
{return(match[1]=='chrome'||match[1]=='webkit');}
return match[1]==browser;},oldIE:function()
{if(this.browser('msie')&&parseInt(this.browser('version'),10)<9)
{return true;}
return false;},outerHTML:function(s)
{return $("<p>").append($(s).eq(0).clone()).html();},normalize:function(str)
{return parseInt(str.replace('px',''),10);},isMobile:function(ipad)
{if(ipad===true&&/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent))
{return true;}
else if(/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent))
{return true;}
else
{return false;}}};$.fn.getObject=function()
{return this.data('redactor');};$.fn.getEditor=function()
{return this.data('redactor').$editor;};$.fn.getCode=function()
{return $.trim(this.data('redactor').getCode());};$.fn.getText=function()
{return this.data('redactor').$editor.text();};$.fn.getSelected=function()
{return this.data('redactor').getSelectedHtml();};$.fn.setCode=function(html)
{this.data('redactor').setCode(html);};$.fn.insertHtml=function(html)
{this.data('redactor').insertHtml(html);};$.fn.destroyEditor=function()
{this.each(function()
{if(typeof $(this).data('redactor')!='undefined')
{$(this).data('redactor').destroy();$(this).removeData('redactor');}});};$.fn.setFocus=function()
{this.data('redactor').$editor.focus();};$.fn.execCommand=function(cmd,param)
{this.data('redactor').execCommand(cmd,param);};})(jQuery);(function($){"use strict";$.fn.dragupload=function(options)
{return this.each(function(){var obj=new Construct(this,options);obj.init();});};function Construct(el,options){this.opts=$.extend({url:false,success:false,error:false,preview:false,uploadFields:false,text:RLANG.drop_file_here,atext:RLANG.or_choose},options);this.$el=$(el);}
Construct.prototype={init:function()
{if(navigator.userAgent.search("MSIE")===-1)
{this.droparea=$('<div class="redactor_droparea"></div>');this.dropareabox=$('<div class="redactor_dropareabox">'+this.opts.text+'</div>');this.dropalternative=$('<div class="redactor_dropalternative">'+this.opts.atext+'</div>');this.droparea.append(this.dropareabox);this.$el.before(this.droparea);this.$el.before(this.dropalternative);this.dropareabox.bind('dragover',$.proxy(function(){return this.ondrag();},this));this.dropareabox.bind('dragleave',$.proxy(function(){return this.ondragleave();},this));var uploadProgress=$.proxy(function(e)
{var percent=parseInt(e.loaded/e.total*100,10);this.dropareabox.text('Loading '+percent+'%');},this);var xhr=jQuery.ajaxSettings.xhr();if(xhr.upload)
{xhr.upload.addEventListener('progress',uploadProgress,false);}
var provider=function(){return xhr;};this.dropareabox.get(0).ondrop=$.proxy(function(event)
{event.preventDefault();this.dropareabox.removeClass('hover').addClass('drop');var file=event.dataTransfer.files[0];var fd=new FormData();if(this.opts.uploadFields!==false&&typeof this.opts.uploadFields==='object')
{$.each(this.opts.uploadFields,$.proxy(function(k,v)
{if(v.toString().indexOf('#')===0)
{v=$(v).val();}
fd.append(k,v);},this));}
fd.append('file',file);$.ajax({url:this.opts.url,dataType:'html',data:fd,xhr:provider,cache:false,contentType:false,processData:false,type:'POST',success:$.proxy(function(data)
{var json=$.parseJSON(data);if(typeof json.error=='undefined')
{this.opts.success(json);}
else
{this.opts.error(this,json);this.opts.success(false);}},this)});},this);}},ondrag:function()
{this.dropareabox.addClass('hover');return false;},ondragleave:function()
{this.dropareabox.removeClass('hover');return false;}};})(jQuery);(function($){"use strict";var protocol='http://';var url1=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,url2=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,linkifyThis=function()
{var childNodes=this.childNodes,i=childNodes.length;while(i--)
{var n=childNodes[i];if(n.nodeType===3)
{var html=n.nodeValue;if(html)
{html=html.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(url1,'$1<a href="'+protocol+'$2">$2</a>$3').replace(url2,'$1<a href="$2">$2</a>$5');$(n).after(html).remove();}}
else if(n.nodeType===1&&!/^(a|button|textarea)$/i.test(n.tagName))
{linkifyThis.call(n);}}};$.fn.linkify=function()
{this.each(linkifyThis);};})(jQuery);(function($){$.event.special.textselect={setup:function(data,namespaces)
{$(this).data("textselected",false);$(this).data("ttt",data);$(this).on('mouseup',$.event.special.textselect.handler)},teardown:function(data)
{$(this).off('mouseup',$.event.special.textselect.handler)},handler:function(event)
{var data=$(this).data("ttt");var text=$.event.special.textselect.getSelectedText(data).toString();if(text!='')
{$(this).data("textselected",true);event.type="textselect";event.text=text;$.event.dispatch.apply(this,arguments)}},getSelectedText:function(data)
{var text='';if(rwindow.getSelection)text=rwindow.getSelection();else if(rdocument.getSelection)text=rdocument.getSelection();else if(rdocument.selection)text=rdocument.selection.createRange().text;return text}};$.event.special.textunselect={setup:function(data,namespaces)
{$(this).data("rttt",data);$(this).data("textselected",false);$(this).on('mouseup',$.event.special.textunselect.handler);$(this).on('keyup',$.event.special.textunselect.handlerKey)},teardown:function(data)
{$(this).unbind('mouseup',$.event.special.textunselect.handler)},handler:function(event)
{if($(this).data("textselected"))
{var data=$(this).data("rttt");var text=$.event.special.textselect.getSelectedText(data).toString();if(text=='')
{$(this).data("textselected",false);event.type="textunselect";$.event.dispatch.apply(this,arguments)}}},handlerKey:function(event)
{if($(this).data("textselected"))
{var data=$(this).data("rttt");var text=$.event.special.textselect.getSelectedText(data).toString();if((event.keyCode=27)&&(text==''))
{$(this).data("textselected",false);event.type="textunselect";$.event.dispatch.apply(this,arguments)}}}}})(jQuery);;if(typeof RedactorPlugins==='undefined')var RedactorPlugins={};RedactorPlugins.clips={init:function()
{var clip_content_id=$($(this)[0]['$el'][0]).attr('data-clips-id');var callback=$.proxy(function()
{$('#redactor_modal .redactor_clip_link').each($.proxy(function(i,s)
{$(s).click($.proxy(function()
{this.insertClip($(s).next().html());return false;},this));},this));this.saveSelection();this.setBuffer();},this);if($('#'+clip_content_id).length>0){this.addBtn('clips','Click to view available tags',function(obj)
{obj.modalInit('Available Tags','#'+clip_content_id,500,callback);});}},insertClip:function(html)
{this.restoreSelection();this.execCommand('inserthtml',html);this.modalClose();}};RedactorPlugins.rtl={init:function()
{var dropdown={};dropdown.ltr={title:'Left to Right',exec:'ltr'}
dropdown.rtl={title:'Right to Left',exec:'rtl'}
this.addBtn('rtl','RTL-LTR',function(){},dropdown);}};;!function($){"use strict";$.fn['bootstrapSwitch']=function(method){var methods={init:function(){return this.each(function(){var $element=$(this),$div,$switchLeft,$switchRight,$label,myClasses="",classes=$element.attr('class'),color,moving,onLabel="ON",offLabel="OFF",icon=false;$.each(['switch-mini','switch-small','switch-large'],function(i,el){if(classes.indexOf(el)>=0)
myClasses=el;});$element.addClass('has-switch');if($element.data('on')!==undefined)
color="switch-"+$element.data('on');if($element.data('on-label')!==undefined)
onLabel=$element.data('on-label');if($element.data('off-label')!==undefined)
offLabel=$element.data('off-label');if($element.data('icon')!==undefined)
icon=$element.data('icon');$switchLeft=$('<span>').addClass("switch-left").addClass(myClasses).addClass(color).html(onLabel);color='';if($element.data('off')!==undefined)
color="switch-"+$element.data('off');$switchRight=$('<span>').addClass("switch-right").addClass(myClasses).addClass(color).html(offLabel);$label=$('<label>').html("&nbsp;").addClass(myClasses).attr('for',$element.find('input').attr('id'));if(icon){$label.html('<i class="icon icon-'+icon+'"></i>');}
$div=$element.find(':checkbox').wrap($('<div>')).parent().data('animated',false);if($element.data('animated')!==false)
$div.addClass('switch-animate').data('animated',true);$div.append($switchLeft).append($label).append($switchRight);$element.find('>div').addClass($element.find('input').is(':checked')?'switch-on':'switch-off');if($element.find('input').is(':disabled'))
$(this).addClass('deactivate');var changeStatus=function($this){$this.siblings('label').trigger('mousedown').trigger('mouseup').trigger('click');};$element.on('keydown',function(e){if(e.keyCode===32){e.stopImmediatePropagation();e.preventDefault();changeStatus($(e.target).find('span:first'));}});$switchLeft.on('click',function(e){changeStatus($(this));});$switchRight.on('click',function(e){changeStatus($(this));});$element.find('input').on('change',function(e,skipOnChange){var $this=$(this),$element=$this.parent(),thisState=$this.is(':checked'),state=$element.is('.switch-off');e.preventDefault();$element.css('left','');if(state===thisState){if(thisState)
$element.removeClass('switch-off').addClass('switch-on');else $element.removeClass('switch-on').addClass('switch-off');if($element.data('animated')!==false)
$element.addClass("switch-animate");if(typeof skipOnChange==='boolean'&&skipOnChange)
return;$element.parent().trigger('switch-change',{'el':$this,'value':thisState})}});$element.find('label').on('mousedown touchstart',function(e){var $this=$(this);moving=false;e.preventDefault();e.stopImmediatePropagation();$this.closest('div').removeClass('switch-animate');if($this.closest('.has-switch').is('.deactivate'))
$this.unbind('click');else{$this.on('mousemove touchmove',function(e){var $element=$(this).closest('.switch'),relativeX=(e.pageX||e.originalEvent.targetTouches[0].pageX)-$element.offset().left,percent=(relativeX/$element.width())*100,left=25,right=75;moving=true;if(percent<left)
percent=left;else if(percent>right)
percent=right;$element.find('>div').css('left',(percent-right)+"%")});$this.on('click touchend',function(e){var $this=$(this),$target=$(e.target),$myCheckBox=$target.siblings('input');e.stopImmediatePropagation();e.preventDefault();$this.unbind('mouseleave');if(moving)
$myCheckBox.prop('checked',!(parseInt($this.parent().css('left'))<-25));else $myCheckBox.prop("checked",!$myCheckBox.is(":checked"));moving=false;$myCheckBox.trigger('change');});$this.on('mouseleave',function(e){var $this=$(this),$myCheckBox=$this.siblings('input');e.preventDefault();e.stopImmediatePropagation();$this.unbind('mouseleave');$this.trigger('mouseup');$myCheckBox.prop('checked',!(parseInt($this.parent().css('left'))<-25)).trigger('change');});$this.on('mouseup',function(e){e.stopImmediatePropagation();e.preventDefault();$(this).unbind('mousemove');});}});});},toggleActivation:function(){$(this).toggleClass('deactivate');},isActive:function(){return!$(this).hasClass('deactivate');},setActive:function(active){if(active)
$(this).removeClass('deactivate');else $(this).addClass('deactivate');},toggleState:function(skipOnChange){var $input=$(this).find('input:checkbox');$input.prop('checked',!$input.is(':checked')).trigger('change',skipOnChange);},setState:function(value,skipOnChange){$(this).find('input:checkbox').prop('checked',value).trigger('change',skipOnChange);},status:function(){return $(this).find('input:checkbox').is(':checked');},destroy:function(){var $div=$(this).find('div'),$checkbox;$div.find(':not(input:checkbox)').remove();$checkbox=$div.children();$checkbox.unwrap().unwrap();$checkbox.unbind('change');return $checkbox;}};if(methods[method])
return methods[method].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof method==='object'||!method)
return methods.init.apply(this,arguments);else
$.error('Method '+method+' does not exist!');};}(jQuery);$(function(){$('.switch')['bootstrapSwitch']();});;var RichHTML={version:'1.0.0',versionDetail:{major:1,minor:0,patch:0},prefixLabel:'',debugLvl:1};RichHTML.apply=function(o,c,defaults){var p;if(defaults){RichHTML.apply(o,defaults);}
if(o&&c&&typeof c==='object'){for(p in c){o[p]=c[p];}}
return o;};(function(){var idSeed=0;RichHTML.apply(RichHTML,{overlayTpl:'<div id="richhtml-overlay" style="display:none;left:-999999px;"></div><div id="richhtml-overlay-inner" style="display:none;left:-999999px;"></div>',id:function(el,prefix){el=RichHTML.getDom(el,true)||{};if(!el.id){el.id=(prefix||"rich-comp-")+(++idSeed);}
return el.id;},isEmpty:function(obj){var prop;for(prop in obj){return false;}
return true;},replaceAll:function(str,token,newToken,ignoreCase){var i=-1,_token;if(typeof token==="string"){_token=ignoreCase===true?token.toLowerCase():undefined;while((i=(_token!==undefined?str.toLowerCase().indexOf(_token,i>=0?i+newToken.length:0):str.indexOf(token,i>=0?i+newToken.length:0)))!==-1){str=str.substring(0,i).concat(newToken).concat(str.substring(i+token.length));}}
return str;},mask:function(selector,fade){if(!fade)fade=false;if((!selector)||selector===null)selector="body";var $t,height,width;$t=$(selector);height=($t.outerHeight()===0)?$(document).height():$t.outerHeight();width=$t.outerWidth();$("#richhtml-overlay").css({top:$t.offset().top,left:$t.offset().left,width:width,height:height,display:''});if(fade)$("#richhtml-overlay").fadeIn('slow');else $("#richhtml-overlay").show();},onPreLoad:function(el){$(this).trigger('preload',el);},onPostLoad:function(el){$(this).trigger('postload',el);},unMask:function(){$("#richhtml-overlay").fadeOut();$("#richhtml-overlay").css({display:'none',left:'-999999px'});},debug:function(lvl,message){if(RichHTML.debugLvl>=lvl){console.log(message);}},mouseCoords:function(ev){if(ev.pageX||ev.pageY){return{x:ev.pageX,y:ev.pageY};}
return{x:ev.clientX+document.body.scrollLeft-document.body.clientLeft,y:ev.clientY+document.body.scrollTop-document.body.clientTop};},getDom:function(el,strict){var e;if(!el||!document){return null;}
return $(".ce-container").get(0);},center:function(el,containerEl,transition,offset){if(!offset){offset=0;}
var $me=el;if(!containerEl){containerEl=window;}
return $me.each(function(){var props,top,left;if(containerEl==window){props={position:'absolute'};$me.css(props);top=($(containerEl).height()-$me.outerHeight())/2;top+=$(containerEl).scrollTop()||0;top=(top>0?top:0);}else{props={position:'relative'};top=($(containerEl).parent().height()-$me.outerHeight())/2;top+=$(containerEl).scrollTop()||0;top=(top>0?top:0);}
top=(top-offset<10)?top:top-offset;$.extend(props,{top:top+'px'});left=($(containerEl).width()-$me.outerWidth())/2;left+=$(containerEl).scrollLeft()||0;left=(left>0?left:0);$.extend(props,{left:left+'px'});if(transition&&transition>0){$me.animate(props,transition);}
else{$me.css(props);}
return $me;});}});})();$(document).ready(function(){$(document.body).append(RichHTML.overlayTpl);});Array.max=function(array){return Math.max.apply(Math,array);};Array.min=function(array){return Math.min.apply(Math,array);};$.fn.hasAttr=function(prop,val){return($(this).attr(prop.toLowerCase())===val.toLowerCase());};if(typeof lang!=='function'){function _sprintf(s){var re=/%/;var i=0;while(re.test(s))
{s=s.replace(re,_sprintf.arguments[++i]);}
return s;}
function lang(){switch(lang.arguments.length){case 1:return phrase;case 2:return _sprintf(phrase,lang.arguments[1]);case 3:return _sprintf(phrase,lang.arguments[1],lang.arguments[2]);case 4:return _sprintf(phrase,lang.arguments[1],lang.arguments[2],lang.arguments[3]);}
return phrase;}};RichHTML.grid=function(config){this.name="richgrid";this.id=null;this.el=null;this.data=null;this.last_tag=0;this.jsonData=null;this.pagingEl=null;this.footerEl=null;this.hasExpander=false;this.hasCheckbox=false;this.width='100%';this.internalTplClean="<div class='richtable'><div class='edit_menu'>Loading ...</div><table id='{rich-id}' style='table-layout: fixed;{tablestyle}'><thead><tr>{{#columns}}<th nowrap='nowrap' rowspan='1' colspan='1' class='{{align}} {{sortable}} {{xtype}} {{editable}} {{#flexing}}flexing{{/flexing}}' {{#getsortfieldname}}{{sortFieldName}}{{/getsortfieldname}} dataindex='{{dataIndex}}' style='{{#width}}width:{{width}};{{/width}}{{#hidecolumn}}{{hidden}}{{/hidecolumn}}' {{#hasCheckbox}}data-checkbox='true'{{/hasCheckbox}}>{{#editable_menu}}<div class='{{edit_icon_class}}' data-rich-icon='&#xe600;'></div>{{/editable_menu}}<span class='{{sort_icon_class}}'>{{text}}&nbsp;</span></th>{{/columns}}</tr></thead><tbody>{tbody}</tbody><tfoot class='light rich-footer'><tr><th colspan='{footer-colspan}' id='{rich-id}-footer'></th></tr></tfoot></table><div id='{rich-id}-navigation' class='richgrid-pagenavi-wrapper'></div></div>";this.tbodyTplClean="{{#groups}}{{#groupname}}<tr class='rich-group-row' id='{{rich_group_id}}'><td class='rich-group-name' colspan={{cols}}><span class='rich-grouptoggle rich-grouptoggle-plus {{plusvisible}}' data-rich-icon='&#xe001;' /><span class='rich-grouptoggle rich-grouptoggle-minus {{minusvisible}}' data-rich-icon='&#xe000;' />{{{name}}}</td></tr>{{/groupname}}{{#items}}{row-data}{{/items}}{{/groups}}";this.internalTpl=null;this.tbodyTpl=null;this.pagingTpl="<div class='richgrid-pagenavi' data-items-per-page='{navpagesitemsperpage}' data-pages='{navpagescount}'>{navbuttons}</div>";this.columns=null;this.url=null;this.selectedColumn=null;this.editable=false;this.groupField=null,this.startCollapsed=false,this.baseParams={dir:"desc",start:0,limit:10};this.root='items';this.totalProperty='total';this.padingEl=null;this.isDraggable=false;this.dragData={dragObject:null,onDragClass:"dragging",scrollAmount:5,savedY:0};this.emptyText=lang("No data found");this.pagingData=[];this.cookieExpires=365;if(config.name){this.name=config.name;}
if(config.el){this.el=config.el;}
if(config.groupField){this.groupField=config.groupField;}
if(config.startCollapsed){this.startCollapsed=config.startCollapsed;}
if(config.id){this.id=config.id;}
else{this.id=this.getId();}
if(config.editable){this.editable=config.editable;}
if(config.url){this.url=config.url;}
if(config.root){this.root=config.root;}
if(config.data){this.data=config.data;}
if(config.pagingEl){this.pagingEl=config.pagingEl;}
if(config.columns){this.columns=config.columns;}
this.columns.push({id:"extra_th",dataIndex:"extra_th",xtype:"extra_th"});if(config.metaEl){this.metaEl=config.metaEl;}
else{this.metaEl=this.el+"-metadata";}
if(config.footerEl){this.footerEl=config.footerEl;}
else{this.footerEl=this.el+"-footer";}
if(config.width){this.width=config.width;}
if(config.emptyText){this.emptyText=config.emptyText;}
if(config.baseParams){jQuery.extend(this.baseParams,config.baseParams);}
if(config.totalProperty){this.totalProperty=config.totalProperty;}
if(config.cookieExpires){this.cookieExpires=config.cookieExpires;}};RichHTML.grid.prototype.getId=function(){return this.id||(this.id=RichHTML.id.apply(this));};RichHTML.grid.prototype.getSelectedRowData=function(){var self=this,arrayOfObjs=[],ids;ids=self.getSelectedRowIds();$.each(self.data,function(k,v){if($.grep(ids,function(n){return n==v.id;}).length>0){arrayOfObjs.push(v);}});return arrayOfObjs;};RichHTML.grid.prototype.getSelectedRowIds=function(){var self=this,arrayOfIds;arrayOfIds=$.map($("#"+self.id+" tbody .checkbox-icon-checked"),function(n,i){if($(n).parent().hasClass('hide-checkbox'))return;substr=$(n).parent().attr('id').split('{-}');return $.trim(substr[1]);});return arrayOfIds;};RichHTML.grid.prototype.render=function(){var self=this;if(!self.templatePrep()){return;}
json=self.dataPrep();$('#'+self.el).html(Mustache.to_html(self.internalTpl,json).replace(/^\s*/mg,''));self.initialLoad(json);};RichHTML.grid.prototype.toggleColumn=function(colId,visible){var self=this,a_hidden=[];$.each(self.columns,function(i,val){if(jQuery.inArray(val.xtype,["expander","checkbox","drag","extra_th"])!=-1)return;if(colId==val.dataIndex){if(visible){self.columns[i].hidden=false;}else{self.columns[i].hidden=true;}}
if(self.columns[i].hidden)a_hidden.push(val.dataIndex);});self.set_cookie({'action':'columns',data:{'h':a_hidden}});self.reload();};RichHTML.grid.prototype.renderEditable=function()
{var self=this,html="";$.each(self.columns,function(i,val){if(jQuery.inArray(val.xtype,["expander","checkbox","drag","extra_th"])!=-1)return;if(val['hidden']){checked="";}else{checked="checked=true";}
html+='<p class="edit-column-entry" data-index="'+val.dataIndex+'"><input '+checked+' type="checkbox" class="col_checkbox" val="'+val.dataIndex+'" />'+val.text+'</p>';});$('.edit_menu').html(html);$("document").off('click');$('.edit_menu p').bind('click',function(event){var dataIndex=null;if(event.target.className!=="col_checkbox"){dataIndex=$(event.target).attr('data-index');checked=$(event.target).find('.col_checkbox').prop("checked");$(event.target).find('.col_checkbox').prop("checked",!checked);state=!checked;}else{dataIndex=$(event.target).parent().attr('data-index');state=$(event.target).prop("checked");}
self.toggleColumn(dataIndex,state);});}
RichHTML.grid.prototype.enable=function()
{var self=this;RichHTML.unMask();};RichHTML.grid.prototype.disable=function()
{var self=this;RichHTML.mask('#'+self.id);};RichHTML.grid.prototype.timestamp=function(label){var self=this;previous_tag=self.last_tag;self.last_tag=Date.now();if(previous_tag==0){}else{elapsed=self.last_tag-previous_tag;}}
RichHTML.grid.prototype.initialLoad=function(json){var self=this;RichHTML.mask('#'+self.id);RichHTML.onPreLoad(self);self.last_tag=0;if(self.url!==null){RichHTML.debug(3,Array('JSON initialLoad request for data',self.baseParams));$.getJSON(self.url,self.baseParams,function(data){if(typeof(ce.parseResponse)==="function"){cedata=ce.parseResponse(data);if(data.error==true){data.error=false;}}
RichHTML.debug(3,Array('JSON request success',data));if(data.error){return false;}
if(typeof(data[self.root])==="undefined"){RichHTML.debug(1,Array('Grid is expecting data collection in root named:'+self.root));return false;}
json.rows=data[self.root];json.rows=self.addRenderers(json.columns,json.rows);self.data=json.rows;self.jsonData=data;if(self.groupField===null){json.groups=[];json.groups.push({items:json.rows});$('#'+self.el).html(Mustache.to_html(self.internalTpl,json).replace(/^\s*/mg,''));self.pagingData.items=json.rows.length;if(typeof(data[self.totalProperty])==="undefined"){RichHTML.debug(3,Array('Paging de-activated. JSON does not contain total count in element: '+self.totalProperty));self.pagingData.totalItems=null;}else{self.pagingData.totalItems=data[self.totalProperty];}}else{json=self.groupOnGroupField(json);$('#'+self.el).html(Mustache.to_html(self.internalTpl,json).replace(/^\s*/mg,''));self.pagingData.totalItems=null;}
if(json.rows.length===0){$('#'+self.el+' tbody').html('<tr><td class="richgrid-nodata" colspan="'+json.columns.length+'">'+self.emptyText+'</td></tr>');}
self.onLoad();});}else{RichHTML.debug(1,'url config param is required to populate datagrid');}};RichHTML.grid.prototype.groupOnGroupField=function(json){var self=this;var minusvisible='visible';var plusvisible='';var groups=[];var group_index=1;json.groups=[];for(var x=0;x<json.rows.length;x++){if(typeof(groups[json.rows[x][this.groupField]])==="undefined"){groups[json.rows[x][this.groupField]]=[];}
groups[json.rows[x][this.groupField]].push(json.rows[x]);}
for(var key in groups){if(groups.hasOwnProperty(key)){var force_collapsed=false;var obj=groups[key];if((jQuery.cookie!='undefined')&&($.cookie("richgrid-data"+RichHTML.prefixLabel))){cookie_vars=JSON.parse($.cookie("richgrid-data"+RichHTML.prefixLabel));if(typeof(cookie_vars[self.el])!="undefined"&&typeof(cookie_vars[self.el].groups)!="undefined"){is_collapsed=cookie_vars[self.el].groups[self.id+'-rich-group-'+group_index];if(typeof(is_collapsed)!="undefined"){force_collapsed=true;}}}
if(this.startCollapsed||force_collapsed){plusvisible='visible';minusvisible='';$.each(obj,function(i,o){o.hidden=true;});}else{plusvisible='';minusvisible='visible';}
json.groups.push({items:obj,groupname:{rich_group_id:this.id+'-rich-group-'+group_index,plusvisible:plusvisible,minusvisible:minusvisible,name:obj[0][this.groupField],cols:json.columns.length}});group_index++;}}
return json;};RichHTML.grid.prototype.reload=function(config){var self=this,params={};self.last_tag=0;RichHTML.mask('#'+self.id);RichHTML.onPreLoad(self);self.templatePrep();if(config&&(typeof(config.params)!=="undefined")){params=config.params;self.set_cookie({'action':'sort',data:{'d':config.params.dir,'s':config.params.sort}});}
jQuery.extend(self.baseParams,params);json=self.dataPrep();if(self.url!==null){RichHTML.debug(3,Array('JSON reload request for data',self.baseParams));$.getJSON(self.url,self.baseParams,function(data){if(typeof(ce.parseResponse)==="function"){cedata=ce.parseResponse(data);if(data.error==true){data.error=false;}}
RichHTML.debug(3,Array('JSON request success',data));if(data.error){return false;}
if(typeof(data[self.root])==="undefined"){RichHTML.debug(1,Array('Grid is expecting data collection in root named:'+self.root));return false;}
json.rows=data[self.root];json.rows=self.addRenderers(json.columns,json.rows);self.data=json.rows;self.jsonData=data;if(self.groupField===null){json.groups=[];json.groups.push({items:json.rows});$('#'+self.el).html(Mustache.to_html(self.internalTpl,json).replace(/^\s*/mg,''));self.pagingData.items=json.rows.length;if(typeof(data[self.totalProperty])==="undefined"){RichHTML.debug(3,Array('Paging de-activated. JSON does not contain total count in element: '+self.totalProperty));self.pagingData.totalItems=null;}else{self.pagingData.totalItems=data[self.totalProperty];}}else{json=self.groupOnGroupField(json);$('#'+self.el).html(Mustache.to_html(self.internalTpl,json).replace(/^\s*/mg,''));self.pagingData.totalItems=null;}
if(json.rows.length===0){$('#'+self.el+' tbody').html('<tr><td class="richgrid-nodata" colspan="'+json.columns.length+'">'+self.emptyText+'</td></tr>');}
self.onLoad(true);});}else{RichHTML.debug(1,Array('url config param is required to populate datagrid'));}};RichHTML.grid.prototype.dataDelayedRenderer=function(renderer,text,id,row){var el={},html;html=renderer(text,row,el);$("#"+id).html(html);};RichHTML.grid.prototype.dataRenderer=function(renderer,row){var self=this;return function(){return function(text,cellid){var raw,id,el={};raw=text.split("{||}");id=self.id+"-cell-"+raw[0];text=raw[1];if(renderer){text=renderer(text,row,el);if(!RichHTML.isEmpty(el)){$(self).bind({"colload":function(){self.mapCellModifiers(el,id);}});}
return text;}else{return text;}};};};RichHTML.grid.prototype.mapCellModifiers=function(el,id){var self=this;if(typeof(el.addClass)!=="undefined"){$('td[id="'+id+'"]').addClass(el.addClass);}
if(typeof(el.removeClass)!=="undefined"){$('td[id="'+id+'"]').removeClass(el.removeClass);}
if(typeof(el.addStyle)!=="undefined"){$('td[id="'+id+'"]').attr('style',el.addStyle);}
if(typeof(el.removeStyle)!=="undefined"&&el.removeStyle){$('td[id="'+id+'"]').attr('style','');}
$(self).unbind('colload');};RichHTML.grid.prototype.addRenderers=function(cols,rows){var self=this,renderOnExpand=false;$.each(cols,function(c_i,c_val){if((typeof(c_val.dataIndex)==="undefined")&&(typeof(c_val.renderer)==="undefined")){if(c_val.xtype!=="drag"){RichHTML.debug(1,"Error: You need either a dataIndex or renderer for column:"+c_i);}}
$.each(rows,function(r_i,r_val){renderOnExpand=(typeof(c_val.renderOnExpand)==="undefined")?false:c_val.renderOnExpand;if(c_val.renderer&&!renderOnExpand){r_val[c_i+"-rich-renderer"]=self.dataRenderer(c_val.renderer,r_val);}else if(!renderOnExpand){r_val[c_i+"-rich-renderer"]=self.dataRenderer();}else{r_val[c_i+"-rich-delayedrenderer"]=c_val.renderer;r_val[c_i+"-rich-delayedrenderer-classes"]="delayedrenderer rowdata-"+c_i+"-"+r_i;}});});return rows;};RichHTML.grid.prototype.getMouseOffset=function(target,ev){var docPos,mousePos;ev=ev||window.event;docPos=this.getPosition(target);mousePos=this.mouseCoords(ev);if(docPos==null){return null;}else{return{x:mousePos.x-docPos.x,y:mousePos.y-docPos.y};}};RichHTML.grid.prototype.getPosition=function(e){var top=0,left=0;if(e.offsetHeight===0){e=e.firstChild;}
if(e==null){return null;}
while(e.offsetParent){left+=e.offsetLeft;top+=e.offsetTop;e=e.offsetParent;}
left+=e.offsetLeft;top+=e.offsetTop;return{x:left,y:top};};RichHTML.grid.prototype.mouseCoords=function(ev){if(ev.pageX||ev.pageY){return{x:ev.pageX,y:ev.pageY};}
return{x:ev.clientX+document.body.scrollLeft-document.body.clientLeft,y:ev.clientY+document.body.scrollTop-document.body.clientTop};};RichHTML.grid.prototype.templatePrep=function()
{var self=this,cols="",colCount=0,expandercolCount=0,expanderDataIndex="",expanderRenderer="",itemIndex="",richid="",widthStr,last_visible_index=null,hidden,foundhidden,has_fullwidth_th=false,flexid=null;if(self.columns===null){RichHTML.debug(1,Array('You need to define columns array'));return false;}
hidden=null;if(jQuery.cookie!='undefined'){if($.cookie("richgrid-data"+RichHTML.prefixLabel)){cookie_vars=JSON.parse($.cookie("richgrid-data"+RichHTML.prefixLabel));if(typeof(cookie_vars[self.el])!="undefined"&&typeof(cookie_vars[self.el].hidden)!="undefined")
{hidden=cookie_vars[self.el].hidden;}
if(typeof(cookie_vars[self.el])!="undefined"&&typeof(cookie_vars[self.el].d)!="undefined"&&typeof(cookie_vars[self.el].s)!="undefined")
{self.baseParams.dir=cookie_vars[self.el].d;self.baseParams.sort=cookie_vars[self.el].s;}}}
$.each(self.columns,function(i,val){if(typeof(val.hidden)==="undefined"){val.hidden=false;}
if(hidden!=null){foundhidden=jQuery.inArray(self.columns[i].dataIndex,hidden);if(foundhidden!=-1){val.hidden=true;self.columns[i].hidden=true;}else{val.hidden=false;self.columns[i].hidden=false;}}
if(val.xtype==="extra_th"){extraid=i;self.columns[i].width="100%";self.columns[i].hidden=true;cols+="<td class='extra_td' valign='top'></td>";}else if(val.xtype==="expander"){val.hidden=false;self.columns[i].hidden=false;if(val.dataIndex){if(typeof(val.escapeHTML)==="undefined"||!val.escapeHTML){expanderDataIndex="{"+val.dataIndex+"}";}else{expanderDataIndex=val.dataIndex;}}
expanderRenderer=colCount+"-rich-renderer";self.hasExpander=true;cols+="<td valign='top' class='expander {{"+colCount+"-rich-delayedrenderer-classes}}' rowspan='1' id='{{#expanderid}}{{/expanderid}}'><div class='expander-icon'></div></td>";self.columns[i].width="23px";}else if(val.xtype==="checkbox"){val.hidden=false;self.columns[i].hidden=false;itemIndex=(typeof(val.escapeHTML)==="undefined"||!val.escapeHTML)?"{"+val.dataIndex+"}":val.dataIndex;self.hasCheckbox=true;cols+="<td class='checkbox' id='{{#checkboxid}}{{"+itemIndex+"}}{{/checkboxid}}' {{#"+colCount+"-rich-renderer}}{{#getlastcellid}}{{/getlastcellid}}{-}{{"+itemIndex+"}}{||}{{"+itemIndex+"}}{{/"+colCount+"-rich-renderer}} valign='top'><div class='checkbox-icon'></div></td>";self.columns[i].width="28px";self.columns[i].hasCheckbox=true;}else if(val.xtype==="drag"){val.hidden=false;self.columns[i].hidden=false;self.columns[i].width="23px";self.isDraggable=true;cols+="<td class='draghandle' id='{{#cellid}}{{/cellid}}' valign='top'><div class='drag-icon'></div></td>";}else if(val.dataIndex){self.columns[i].editable_menu=false;self.columns[i].editable="";if(val.hidden){hiddenstyle="display:none;"}else{hiddenstyle="";}
if(typeof(val.sortable)!=="undefined"&&val.sortable){self.columns[i].sortable="sortable";self.columns[i].sort_icon_class="sort-icon";}
if(typeof(val.width)!=="undefined"&&val.width!=null){widthStr=self.columns[i].width.toString();if((widthStr.indexOf("px")!=-1)||(widthStr==="100%")){self.columns[i].width=val.width;}else{self.columns[i].width=val.width+"px";}}else if(!val.hidden){}
if(typeof(val.id)!=="undefined"){richid="data-localid='"+val.id+"'";}
else{richid="";}
itemIndex=(typeof(val.escapeHTML)==="undefined"||!val.escapeHTML)?"{"+val.dataIndex+"}":val.dataIndex;cols+="<td id='{{#cellid}}{{/cellid}}' style='overflow: visible;"+hiddenstyle+"' class='"+((typeof(val.align)!=="undefined")?val.align:"left")+"' "+richid+"  dataindex='"+val.dataIndex+"' valign='top'>{{#"+colCount+"-rich-renderer}}{{#getlastcellid}}{{/getlastcellid}}{||}{{"+itemIndex+"}}{{/"+colCount+"-rich-renderer}}</td>";}
colCount++;if(!val.hidden)expandercolCount++;if(jQuery.inArray(val.xtype,["expander","checkbox","drag","extra_th"])==-1){if(val.flex==1&&!self.columns[i].hidden)flexid=i;if((val.width=="100%")&&(!self.columns[i].hidden))has_fullwidth_th=true;if(!self.columns[i].hidden)last_visible_index=i;}});if(typeof(self.editable)!=="undefined"&&self.editable){if(last_visible_index==null)last_visible_index=extraid;self.columns[last_visible_index].editable="editable";self.columns[last_visible_index].editable_menu=true;self.columns[last_visible_index].edit_icon_class="edit-icon";}
if(!has_fullwidth_th){if(flexid!=null){self.columns[flexid].flexing=true;}else if(last_visible_index!=null){if(extraid==last_visible_index){self.columns[extraid].hidden=false;}
self.columns[last_visible_index].flexing=true;}}
cols="<tr {{#hidden}}style='display:none;'{{/hidden}} class='{{#getcollapsedstate}}{{/getcollapsedstate}}' id='{{#getrowid}}{{/getrowid}}'>"+cols+"</tr>";if(self.hasExpander){cols+="<tr class='expander-row' id='{{#expanderrowid}}{{/expanderrowid}}' style='display:none;'>";cols+="<td colspan='"+(expandercolCount)+"'><div class='pointer' boundto='{{#getlastextenderid}}{{/getlastextenderid}}' />";cols+="<div class='expander-data' id='{{#cellid}}{{/cellid}}'>{{#"+expanderRenderer+"}}{{#getlastextenderid}}{{/getlastextenderid}}{||}{{"+expanderDataIndex+"}}{{/"+expanderRenderer+"}}</div>";cols+="</td></tr>";}
self.tbodyTpl=RichHTML.replaceAll(self.tbodyTplClean,"{row-data}",cols);self.internalTpl=RichHTML.replaceAll(self.internalTplClean,"{rich-id}",this.getId());self.internalTpl=RichHTML.replaceAll(self.internalTpl,"{tablestyle}","width:"+this.width);self.internalTpl=RichHTML.replaceAll(self.internalTpl,"{footer-colspan}",colCount);self.internalTpl=RichHTML.replaceAll(self.internalTpl,"{tbody}",self.tbodyTpl);return true;};RichHTML.grid.prototype.dataPrep=function()
{var self=this,cellCounter=0,rowCounter=0,expanderCounter=0,json={};json.getsortfieldname=function(){return function(text,render){return(text)?"sortfieldname='"+text+"'":"";};};json.checkboxid=function(){return function(text,render){return self.id+"-cell-"+(++cellCounter)+"{-}"+text;};};json.expanderid=function(){return function(text,render){return self.id+"-expander-"+(++expanderCounter);};};json.cellid=function(){return function(text,render){return self.id+"-cell-"+(++cellCounter);};};json.getlastcellid=function(){return function(text,render){return cellCounter;};};json.hidecolumn=function(){return function(text,render){if(text==="true"){return"display:none;";}else{return"";}};};json.getcollapsedstate=function(){return function(text,render){if((self.groupField!==null)&&(self.startCollapsed))return'collapsed';else return'';};};json.getrowid=function(){return function(text,render){return self.id+"-row-"+(++rowCounter);};};json.getlastextenderid=function(){return function(text,render){return expanderCounter;};};json.expanderrowid=function(){return function(text,render){return self.id+"-expander-"+(expanderCounter)+"-data";};};json.columns=self.columns;return json;};RichHTML.grid.prototype.bindColumns=function(){var self=this,span,dir;$("body").off('click',"#"+self.id+" thead th.sortable");$("body").on('click',"#"+self.id+" thead th.sortable",function(event){if(event.target.className==="col_checkbox"||event.target.className==="edit-icon"||event.target.className==="edit-column-entry"){return true;}
if(typeof(event.dosort)==="undefined"){event.dosort=true;}
$("#"+self.id+" thead th.sortable").removeClass('sortable-selected');$(this).siblings('.sortable').children('span').removeClass('sort-icon-asc').removeClass('sort-icon-desc');span=$(this).children('span');$(this).addClass('sortable-selected');if(!event.dosort){span.toggleClass('sort-icon-'+event.sortdir);}else{span.toggleClass('sort-icon-asc');}
if(span.hasClass('sort-icon-asc')){span.removeClass('sort-icon-desc');dir="asc";}else{span.addClass('sort-icon-desc');dir="desc";}
self.selectedColumn=$(this).attr('dataindex');if(event.dosort){self.reload({"params":{"start":0,"dir":dir,"sort":self.selectedColumn}});}});$("body").off('click',"th.editable div.edit-icon");$("body").on('click',"th.editable div.edit-icon",function(event){event.preventDefault();$('.edit_menu').fadeToggle("fast",function(){$('.edit_menu').toggleClass('open');if($('.edit_menu').hasClass('open')&&!$('.edit_menu').hasClass('populated')){self.renderEditable();$('.edit_menu').addClass('populated');}});});};RichHTML.grid.prototype.getRowValues=function(colId,justtext){var self=this,arrayofids=[],i;if(typeof(justtext)=="undefined"){justtext=true;}
rows=$("#"+self.id+" tr td[data-localid='"+colId+"']");for(i=0;i<rows.length;i++){if(justtext){arrayofids[i]=$(rows[i]).text();}else{arrayofids[i]=rows[i].innerHTML;}}
return arrayofids;};RichHTML.grid.prototype.onLoad=function(reloading){var self=this,data,paginghtml="",buttonshtml="",classes="",rowid,renderer,text,col,id,event,loopstart,loopend;if(self.data.length===0){RichHTML.debug(3,Array('Data Not Loaded - Doesn\'t appear to be any data to load'));if(self.pagingEl!==null){$("#"+self.pagingEl).html("");}
else{$("#"+self.id).parent().children(".richgrid-pagenavi-wrapper").html("");}
self.bindColumns();}else{RichHTML.debug(3,Array('Data Loaded - Setting up grid binds (expander & checkboxes)'));if(typeof(reloading)==="undefined"){reloading=false;}
self.bindColumns();if(typeof(self.baseParams.sort)!=="undefined"){RichHTML.debug(3,Array('Had default sort info - sorting column',self.baseParams));event=jQuery.Event("click");event.dosort=false;event.sortdir=self.baseParams.dir.toLowerCase();$("#"+self.id+" thead th.sortable[dataindex='"+self.baseParams.sort+"']").trigger(event);}
if(self.hasExpander){$("body").off('click',"#"+self.id+" tbody td.expander div.expander-icon");$("body").on('click',"#"+self.id+" tbody td.expander div.expander-icon",function(){$(this).toggleClass('expander-icon-expanded');$(this).parent().parent().children('td').toggleClass('nobottomborder');$("#"+$(this).parent().attr('id')+"-data").toggle();if(($(this).parent().hasClass('delayedrenderer'))&&($(this).hasClass('expander-icon-expanded'))){classes=$(this).parent().attr('class');text=$("#"+$(this).parent().attr('id')+"-data .expander-data").text();id=$("#"+$(this).parent().attr('id')+"-data .expander-data").attr('id');RichHTML.debug(3,Array('preparing to call delayed renderer',Array("classes:"+classes,"text:"+text,"id:"+id)));$.each(classes.split(" "),function(i,val){if(val.indexOf('rowdata')>-1){val=val.split("-");rowid=val[2];col=val[1];renderer=self.data[rowid][col+"-rich-delayedrenderer"];self.dataDelayedRenderer(renderer,text,id,self.data[rowid]);}});}});}
if(self.isDraggable){$("body").off("mousedown","#"+self.id+" tbody td.draghandle .drag-icon");$("body").on("mousedown","#"+self.id+" tbody td.draghandle .drag-icon",function(event){self.mouseDown(this,event);return false;});}
if(self.hasCheckbox){$("body").off('click',"#"+self.id+" tbody td .checkbox-icon");$("body").on('click',"#"+self.id+" tbody td .checkbox-icon",function(event,massclick){var rowid,data;if(typeof(massclick)==="undefined"){massclick=false;}
$(this).toggleClass('checkbox-icon-checked');if(!massclick&&!$(this).hasClass('checkbox-icon-checked')){$("#"+self.id+" th.checkbox-checked").removeClass('checkbox-checked').addClass('checkbox');}
if(!massclick){rowid=$(this).parent().attr('id').split("{-}")[1];data={};data.rowid=rowid;data.rowsSelected=self.getSelectedRowIds();data.totalSelected=self.getSelectedRowIds().length;$(self).trigger('rowselect',[data]);}
$(this).parent().parent().each(function(){$(this).toggleClass('row-selected');});});}
if(self.pagingData.totalItems&&self.pagingData.totalItems!==null){self.pagingData.pages=Math.ceil(self.pagingData.totalItems/self.baseParams.limit);self.pagingData.start=parseInt(self.baseParams.start,10);if(self.pagingData.start===0){self.pagingData.page=1;}else{self.pagingData.page=Math.ceil((self.pagingData.start+1)/self.baseParams.limit);}
self.pagingData.next=self.pagingData.page+1;self.pagingData.previous=self.pagingData.page-1;loopstart=Array.max(Array(1,self.pagingData.page));loopend=Array.min(Array(self.pagingData.page,self.pagingData.pages));if(loopstart!==1&&(self.pagingData.page>2)){buttonshtml+="<span class='first' data-"+self.id+"-link='0'></span>";}else{buttonshtml+="<span class='first disabled' data-"+self.id+"-link='0'></span>";}
if(self.pagingData.page>1){buttonshtml+="<span data-"+self.id+"-link='"+((self.pagingData.page-2)*self.baseParams.limit)+"' class='previouspostslink'></span>";}else{buttonshtml+="<span data-"+self.id+"-link='"+((self.pagingData.page-2)*self.baseParams.limit)+"' class='previouspostslink disabled'></span>";}
for(i=loopstart;i<=loopend;i++)
{if(self.pagingData.page===i){buttonshtml+="<span class='current'>"+i+"</span>";}
else{buttonshtml+="<span data-"+self.id+"-link='"+((i-1)*self.baseParams.limit)+"'>"+i+"</span>";}}
if(self.pagingData.page<self.pagingData.pages)
{buttonshtml+="<span class='nextpostslink' data-"+self.id+"-link='"+(self.pagingData.page*self.baseParams.limit)+"'></span>";}else{buttonshtml+="<span class='nextpostslink disabled' data-"+self.id+"-link='"+(self.pagingData.page*self.baseParams.limit)+"'></span>";}
if(loopend!==self.pagingData.pages){buttonshtml+="<span class='last' data-"+self.id+"-link='"+((self.pagingData.pages-1)*self.baseParams.limit)+"'></span>";}else{buttonshtml+="<span class='last disabled' data-"+self.id+"-link='"+((self.pagingData.pages-1)*self.baseParams.limit)+"'></span>";}
if(self.pagingData.pages>1){paginghtml=RichHTML.replaceAll(self.pagingTpl,"{navbuttons}",buttonshtml);paginghtml=RichHTML.replaceAll(paginghtml,"{navpagescount}",self.pagingData.pages);paginghtml=RichHTML.replaceAll(paginghtml,"{navpagesitemsperpage}",self.baseParams.limit);if(self.pagingEl!==null){$("#"+self.pagingEl).html(paginghtml);}else{$("#"+self.id).parent().children(".richgrid-pagenavi-wrapper").html(paginghtml);}}else{if(self.pagingEl!==null){$("#"+self.pagingEl).html("");}
else{$("#"+self.id).parent().children(".richgrid-pagenavi-wrapper").html("");}}
$(document).on("click","*[data-"+self.id+"-link]:not(.disabled)",function(){$(document).off("click","*[data-"+self.id+"-link]:not(.disabled)");self.reload({params:{start:$(this).attr("data-"+self.id+"-link")}});});}
if(self.groupField!==null)
{$("body").on('click','.richtable .rich-grouptoggle',function(){$(this).siblings().filter('.rich-grouptoggle').show();$(this).hide();$(this).parent().parent().nextUntil(".rich-group-row").toggle();group_id=$(this).parent().parent().attr('id');group_visible=$(this).parent().parent().find('.rich-grouptoggle-minus').is(":visible");self.set_cookie({'action':'group',data:{group_id:group_id,group_visible:group_visible}});});}
$("#"+self.id+" tbody tr:not(.rich-group-row) td[dataindex='"+self.selectedColumn+"']").addClass('col-selected');$("#"+self.id+" tbody tr:not(.expander-row,.rich-group-row):odd").addClass('odd');}
if(self.hasCheckbox){if(!reloading){$("body").on('click',"#"+self.id+" thead th.checkbox",function(){th=this;RichHTML.debug(3,Array('Clicking checkbox header',"#"+self.id));if(!$(th).hasClass('checkbox-checked')){$("#"+self.id+" tbody td.checkbox div.checkbox-icon:not(.checkbox-icon-checked)").each(function(){$(this).trigger('click',[true]);});}else{$("#"+self.id+" tbody td.checkbox div.checkbox-icon-checked").each(function(){$(this).trigger('click',[true]);});}
$(th).toggleClass('checkbox-checked');data={};data.rowid='all';data.rowsSelected=self.getSelectedRowIds();data.totalSelected=self.getSelectedRowIds().length;$(self).trigger('rowselect',[data]);});}else{$("#"+self.id+" thead th.checkbox-checked").removeClass('checkbox-checked');}}
RichHTML.unMask();RichHTML.onPostLoad(self);data={};data.paging=self.pagingData;data.meta=self.setMetaData();data.jsonData=self.jsonData;if(typeof(self.footerEl)!=="undefined"){$('#'+self.footerEl).show();$('#'+self.footerEl+' .rich-button').attr('disabled','disabled');}
$(self).trigger("load",[data]).trigger("colload");};RichHTML.grid.prototype.set_cookie=function(params){var self=this;if(jQuery.cookie=='undefined')return;if($.cookie("richgrid-data"+RichHTML.prefixLabel)){cookie_vars=JSON.parse($.cookie("richgrid-data"+RichHTML.prefixLabel));}else{cookie_vars={};}
if(params.action=="group"){if(typeof(cookie_vars[self.el])=="undefined")cookie_vars[self.el]={};if(typeof(cookie_vars[self.el]['groups'])=="undefined")cookie_vars[self.el].groups={};if(!params.data.group_visible){cookie_vars[self.el].groups[params.data.group_id]="1"}else{delete cookie_vars[self.el].groups[params.data.group_id];}}else if(params.action=="sort"){if((typeof(params.data.d)=="undefined")||(typeof(params.data.s)=="undefined"))return false;if(typeof(cookie_vars[self.el])=="undefined")cookie_vars[self.el]={};cookie_vars[self.el]['d']=params.data.d;cookie_vars[self.el]['s']=params.data.s;}else if(params.action=="columns"){if(typeof(cookie_vars[self.el])=="undefined")cookie_vars[self.el]={};if(typeof(cookie_vars[self.el]['hidden'])=="undefined")cookie_vars[self.el].groups={};cookie_vars[self.el].hidden=params.data['h'];}
$.cookie("richgrid-data"+RichHTML.prefixLabel,JSON.stringify(cookie_vars),{expires:self.cookieExpires});}
RichHTML.grid.prototype.setMetaData=function(){var self=this,meta="";if(self.pagingData.totalItems==0){meta=lang("Displaying items")+": 0 - 0 "+lang("of")+" 0";}else if(typeof(self.pagingData.start)!=="undefined"){meta=lang("Displaying items")+": "+(self.pagingData.start+1)+" - "+(self.pagingData.start+self.pagingData.items)+" "+lang("of")+" "+self.pagingData.totalItems;}
if(typeof(self.metaEl)!=="undefined"){$('#'+self.metaEl).html(meta);}
return meta;};RichHTML.grid.prototype.getTargetRow=function(draggedRow,y){var self=this,rows,row,rowY,rowHeight,i;rows=$("#"+self.id)[0].rows;for(i=0;i<rows.length;i++){row=rows[i];rowY=self.getPosition(row);if(rowY==null)return null;rowY=rowY.y;rowHeight=parseInt(row.offsetHeight,10)/2;if(row.offsetHeight===0){rowY=self.getPosition(row.firstChild);if(rowY==null)return null;rowY=rowY.y;rowHeight=parseInt(row.firstChild.offsetHeight,10)/2;}
if((y>rowY-rowHeight)&&(y<(rowY+rowHeight))){if(row===draggedRow[0]){return null;}
return row;}}
return null;};RichHTML.grid.prototype.mouseDown=function(target,event){var self=this;self.dragData.dragObject=$(target).parent().parent();self.dragData.mouseOffset=self.getMouseOffset(target,event);if(self.dragData.mouseOffset==null)return;RichHTML.debug(3,Array("Initializing Drag",self.dragData));$("body").off("mousemove");$("body").on("mousemove",'#'+self.id,function(ev){var expanderrow,mousePos,y,yOffset,windowHeight,movingDown,currentRow;if(self.dragData.dragObject===null){return;}
mousePos=self.mouseCoords(ev);y=mousePos.y-self.dragData.mouseOffset.y;yOffset=window.pageYOffset;if(document.all){if(typeof document.compatMode!=='undefined'&&document.compatMode!=='BackCompat'){yOffset=document.documentElement.scrollTop;}
else if(typeof document.body!=='undefined'){yOffset=document.body.scrollTop;}}
if(mousePos.y-yOffset<self.dragData.scrollAmount){window.scrollBy(0,-self.dragData.scrollAmount);}else{windowHeight=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight;if(windowHeight-(mousePos.y-yOffset)<self.dragData.scrollAmount){window.scrollBy(0,self.dragData.scrollAmount);}}
if(y!==self.dragData.savedY){movingDown=y>self.dragData.savedY;self.dragData.savedY=y;if(self.dragData.onDragClass){self.dragData.dragObject.addClass(self.dragData.onDragClass);}
currentRow=self.getTargetRow(self.dragData.dragObject,y);if(currentRow&&!$('#'+currentRow.id).hasClass('expander-row')){if(movingDown){$('#'+currentRow.id).insertBefore(self.dragData.dragObject);}else{$('#'+currentRow.id).insertAfter(self.dragData.dragObject);}
if(self.hasExpander){expanderrow=$("#"+self.id+"-expander-"+currentRow.id.split('row-')[1]+"-data");if(expanderrow.length){expanderrow.insertAfter($('#'+currentRow.id));}
expanderrow=$("#"+self.id+"-expander-"+self.dragData.dragObject.attr('id').split('row-')[1]+"-data");if(expanderrow.length){expanderrow.insertAfter(self.dragData.dragObject);}}}}});$("body").off("mouseup",'#'+self.id);$("body").on("mouseup",'#'+self.id,function(ev){if(self.dragData.dragObject===null){return;}
$('#'+self.id).unbind("mousemove");if(self.dragData.onDragClass){self.dragData.dragObject.removeClass(self.dragData.onDragClass);}
$("#"+self.id+" tbody tr:not(.expander-row)").removeClass('odd');$("#"+self.id+" tbody tr:not(.expander-row):odd").addClass('odd');self.dragData.dragObject=null;var data={};$(self).trigger("drop",[data]);});};;RichHTML.msgBox=function(content,config,callback)
{var msgBox=new RichHTML.window({});var required="";msgBox.name='msgBox';msgBox.options.escClose=false;msgBox.options.type="alert";msgBox.options.password=false;msgBox.options.textarea=false;msgBox.options.allowblank=false;msgBox.options.value="";msgBox.confirm_buttons={button1:{text:lang("Yes")},button2:{text:lang("No")},button3:{text:lang("Cancel"),type:"cancel"}};msgBox.prompt_buttons={button1:{text:lang("OK")},button2:{text:lang("Cancel"),type:"cancel"}};msgBox.yesno_buttons={button1:{text:lang("Yes")},button2:{text:lang("No")}};msgBox.options=$.extend(msgBox.options,config);if(typeof(msgBox.options.buttons)=="undefined"){switch(msgBox.options.type){case"confirm":msgBox.options.buttons=msgBox.confirm_buttons;break;case"yesno":msgBox.options.buttons=msgBox.yesno_buttons;break;case"prompt":msgBox.options.type="prompt";msgBox.options.buttons=msgBox.prompt_buttons;break;default:break;}}
switch(msgBox.options.type){case"prompt":if(msgBox.options.content===null){if(msgBox.options.allowblank===false){required=" class='required' ";}
if(msgBox.options.password){msgBox.options.content=content+"<input type='password' class='required' name='value' style='width:80%;margin-top:4px;' />";}else if(msgBox.options.textarea){msgBox.options.content=content+"<textarea "+required+" name='value' style='width:100%;margin-top:4px;' rows='2' /></textarea>";}else{msgBox.options.content=content+"<input type='text' "+required+" name='value' style='width:80%;margin-top: 4px;' value='"+msgBox.options.value+"' />";}}
break;default:if(msgBox.options.content===null){msgBox.options.content=content;}
break;}
if(callback){msgBox.options.afterClick=callback;}else{msgBox.options.afterClick=null;}
if(msgBox.options.title===''){msgBox.options.hideTitle=true;}
msgBox.show();RichHTML.center($('#'+msgBox.id+' .window-description-elements'),$('#'+msgBox.id+' .window-description form'));if(typeof msgBox.options.afterClick==='function'&&msgBox.options.afterClick!==false){$(msgBox).bind({"buttonclick":function(event,data){var elements,args=[];elements=msgBox.form.serializeArray();data.elements={};for(var i=0;i<elements.length;i++){data.elements[elements[i].name]=elements[i].value;}
args.push(data);msgBox.options.afterClick.apply(self,args);}});}
return msgBox;};RichHTML.confirm=function(title,options,callback){var config={type:'confirm'};config=$.extend(config,options);return RichHTML.msgBox(title,config,callback);};RichHTML.error=function(title,options,callback){var config={type:'error'};config=$.extend(config,options);return RichHTML.msgBox(title,config,callback);};RichHTML.prompt=function(title,options,callback){var config={type:'prompt'};config=$.extend(config,options);return RichHTML.msgBox(title,config,callback);};RichHTML.alert=function(msg,options,callback){var config={type:'yesno'};config=$.extend(config,options);return RichHTML.msgBox(msg,config,callback);};RichHTML.info=function(msg,options,callback){var config={type:'info'};config=$.extend(config,options);return RichHTML.msgBox(msg,config,callback);};RichHTML.window=function(config){var defaults,self=this;self.id=null;self.hasButtons=false;self.name='richwindow';self.delayLoad=false;self.form=null;self.params={};defaults={content:null,width:360,showerrors:true,type:"form",grid:null,onSubmit:null,showSubmit:false,showDelete:false,hideButtons:false,escClose:true,hideTitle:false,useOverlay:true,transition:0,title:'',beforeSubmit:null,beforeCancel:null};self.options=$.extend(defaults,config);self.elements={firstElement:null,lastElement:null,firstGroup:null,lastGroup:null};if(config.id){self.id=config.id;}
else{self.id=self.getId();}
self.template='<div class="richwindow" id="{richid}" style="width:{width};"><div class="window-bg" style="width:{width};">';self.template+='<div class="window-title" style="width:{width};">{title}</div>';self.template+='<div class="window-description loading-content {msgboxclasses}" style="{minHeight};height:{height};"><form novalidate action="index.php" id="form-description-{richid}" novalidate="novalidate" style="margin-bottom:5px;"><div class="window-description-elements"></div></form></div>';self.template+='<div class="window-buttons">{{buttons}}</div></div></div>';self.closeKeyHandler=function(e){if(e.keyCode===27&&self.options.escClose){$('.richwindow .datepicker').hide();if(jQuery().timepicker){$('.richwindow .timepicker').timepicker('hideWidget');}
if(jQuery().colourPicker){$('#jquery-colour-picker').hide();}
self.hide();}};self.enterKeyHandler=function(e){if(e.keyCode===13){if($(document.activeElement).hasClass('rich-button')){$(document.activeElement).click();}
if(!$(document.activeElement).is('div')&&!$(document.activeElement).is('textarea')){e.preventDefault();if(self.options.type=='prompt'){$('#'+self.id+' #rich-button-button1').click();}
return false;}}};self.tabKeyHandler=function(e){if(e.keyCode===9){if($(e.target).is(self.elements.lastGroup)&&!e.shiftKey){self.elements.firstGroup.first().focus();e.preventDefault();}else if($(e.target).is(self.elements.firstGroup)&&e.shiftKey){self.elements.lastGroup.first().focus();e.preventDefault();}}};};RichHTML.window.prototype.callDelete=function(method){var self=this,me;me=$('#'+self.id);if(typeof(self.options.deleteUrl)==="undefined"){RichHTML.debug(1,"You need to define a deleteUrl if you want to use the delete method.");return false;}
if(self.form===null){RichHTML.debug(1,"this.form is not set yet via the render method.");return false;}
if(typeof(method)==="undefined"){successMethod=function(data){if(self.options.grid!==null){self.options.grid.reload();}
self.hide();};}else{successMethod=function(data){method(data);if(self.options.grid!==null){self.options.grid.reload();}
self.hide();};}
if(self.params&&typeof(self.params)!=="undefined"){$.each(self.params,function(c_i,c_val){me.find('.window-description form .window-description-elements').append($('<input/>').attr('type','hidden').attr('name',c_i).val(c_val));});}
$.post(self.options.deleteUrl,self.form.serialize(),successMethod,"json");};RichHTML.window.prototype.submit=function(method){var self=this,me;if(!method)method=null;me=$('#'+self.id);if(typeof(self.options.actionUrl)==="undefined"){RichHTML.debug(1,"You need to define an actionUrl if you want to use the submit method.");return false;}
if(self.form===null){RichHTML.debug(1,"this.form is not set yet via the render method.");return false;}
if(method===null){successMethod=function(data){self.postSubmit(data);};}else{successMethod=function(data){method(data,self.form.serializeArray());self.postSubmit(data);};}
if(self.params&&typeof(self.params)!=="undefined"){$.each(self.params,function(c_i,c_val){me.find('.window-description form .window-description-elements').append($('<input/>').attr('type','hidden').attr('name',c_i).val(c_val));});}
$.post(self.options.actionUrl,self.form.serialize(),successMethod,"json");};RichHTML.window.prototype.postSubmit=function(data){var self=this;if((typeof(data.error)=="undefined")||((typeof(data.error)!="undefined")&&!data.error)){if(self.options.grid!==null){self.options.grid.reload();}
self.hide();}else{if((typeof(data.message)==="undefined")||($.trim(data.message)==="")){data.message='There was an error submitting your request';}
if(self.options.showerrors)RichHTML.msgBox(data.message,{type:'error'});}};RichHTML.window.prototype.getId=function(){return this.id||(this.id=RichHTML.id.apply(this));};RichHTML.window.prototype.checkContent=function(){var self=this,itemsDefined=0;(self.options.content!==null)?itemsDefined++:itemsDefined;(typeof(self.options.el)!=="undefined")?itemsDefined++:itemsDefined;(typeof(self.options.url)!=="undefined")?itemsDefined++:itemsDefined;if(itemsDefined>1){RichHTML.debug(1,"You need only one param of el, url, or content to determine where the content is coming from.");return false;}else if(itemsDefined===0){RichHTML.debug(1,"You need either config param el, url, or content to determine where the content is coming from.");return false;}
return true;};RichHTML.window.prototype.setHeight=function(height){var innerwindow=$('#'+this.id).find('.window-description');innerwindow.height(height);};RichHTML.window.prototype.prepTemplate=function(){var self=this,content="";if(!self.checkContent()){return false;}
self.template=RichHTML.replaceAll(self.template,"{richid}",self.id);if((self.options.title==='')&&(!self.options.hideTitle)){self.options.title='Empty title';}
if(self.options.type==="form"){self.template=RichHTML.replaceAll(self.template,"{msgboxclasses}","");}else{self.template=RichHTML.replaceAll(self.template,"{msgboxclasses}","msgbox-wrapper msgbox-"+self.options.type);}
self.template=RichHTML.replaceAll(self.template,"{title}",self.options.title);self.template=RichHTML.replaceAll(self.template,"{width}",self.options.width+"px");if(typeof(self.options.height)==="undefined"){self.template=RichHTML.replaceAll(self.template,"{height}","auto");}else{self.template=RichHTML.replaceAll(self.template,"{height}",self.options.height+"px");}
if(typeof(self.options.minHeight)!=="undefined"){self.template=RichHTML.replaceAll(self.template,"{minHeight}","min-height:"+self.options.minHeight+"px");}else{self.template=RichHTML.replaceAll(self.template,"{minHeight}","");}
self.template=RichHTML.replaceAll(self.template,"{descriptionwidth}",(self.options.width-40)+"px");return true;};RichHTML.window.prototype.prepButtons=function(){var self=this,buttons='',button;for(button in self.options.buttons){buttons+='<a href="#" class="rich-button white" id="rich-button-'+button+'"><span class="buttontext">'+self.options.buttons[button].text+'</span></a>';}
if((buttons==='')&&(self.options.hideButtons)){self.hasButtons=false;RichHTML.debug(3,"No buttons and hide Ok passed as true");}else if(buttons===''){self.hasButtons=true;if(self.options.showSubmit){buttons+='<a href="#" class="rich-button white" id="rich-button-submit"><span class="buttontext">'+lang('Submit')+'</span></a>';if(self.options.showDelete){buttons+='<a href="#" class="rich-button white" id="rich-button-delete"><span class="buttontext">'+lang('Delete')+'</span></a>';}
buttons+='<a href="#" class="rich-button white" id="rich-button-autoclose"><span class="buttontext">'+lang('Close')+'</span></a>';}else{if(self.options.showDelete){buttons='<a href="#" class="rich-button white" id="rich-button-delete"><span class="buttontext">'+lang('Delete')+'</span></a>';}
buttons+='<a href="#" class="rich-button white" id="rich-button-autoclose"><span class="buttontext">'+lang('Ok')+'</span></a>';}
self.template=RichHTML.replaceAll(self.template,"{{buttons}}",buttons);}else{self.hasButtons=true;self.template=RichHTML.replaceAll(self.template,"{{buttons}}",buttons);}
return true;};RichHTML.window.prototype.render=function(useOverlay){var self=this,me;if(useOverlay){$('<div class = "rich-dark-overlay" />').appendTo('body').fadeIn("slow");}
$(document.body).append(self.template);me=$('#'+self.id);if(!self.hasButtons){me.find('.window-buttons').css('display','none');me.find('.window-description').addClass('window-no-buttons');}
if(self.options.hideTitle){me.find('.window-title').css('display','none');me.find('.window-description').addClass('window-no-title');}
self.form=me.find('.window-description form');if(typeof(self.options.el)!=="undefined"){RichHTML.debug(3,"Loading content from element with id: "+self.options.el);$('#'+self.id+' .window-description form .window-description-elements').html($('#'+self.options.el).html());$('.richwindow .loading-content').removeClass('loading-content');}else if(typeof(self.options.url)!=="undefined"){RichHTML.debug(3,"Loading content from url: "+self.options.url);self.delayLoad=true;}else if(typeof(self.options.content)!=="undefined"){RichHTML.debug(3,"Loading content from content param: "+self.options.content);$('#'+self.id+' .window-description form .window-description-elements').html(self.options.content);$('.richwindow .loading-content').removeClass('loading-content');}
self.position();return true;};RichHTML.window.prototype.position=function(){var self=this;var props;var obj={};if(self.options.right){obj.right=self.options.right+"px";}
if(self.options.left){obj.left=self.options.left+"px";}
if(self.options.top){obj.top=self.options.top+"px";}
if(self.options.bottom){obj.bottom=self.options.bottom+"px";}
if((self.options.right)||(self.options.left)||(self.options.top)||(self.options.bottom)){obj.position='absolute';$('#'+self.id).css(obj);}else{RichHTML.center($('#'+self.id),window,self.options.transition,100);}
return;};RichHTML.window.prototype.hide=function(){var self=this;if(jQuery().timepicker){$('.richwindow .timepicker').timepicker('hideWidget');}
if(jQuery().colourPicker){$('#jquery-colour-picker').hide();}
if(self.options.useOverlay){$('.rich-dark-overlay').fadeOut("fast",function(){$(this).remove();});}
$(document).unbind('keydown',self.closeKeyHandler).unbind('keydown',self.tabKeyHandler).unbind('keydown',self.enterKeyHandler);$('#'+self.id).remove();};RichHTML.window.prototype.validateForm=function(){var self=this;data={};if(jQuery().validate){data.validate=self.form.validate({highlight:function(element,errorClass,validClass){$(element).addClass(errorClass).removeClass(validClass);},unhighlight:function(element,errorClass,validClass){$(element).removeClass(errorClass).addClass(validClass);$(element).attr('title','');},errorPlacement:function(error,element){if(error.html()!==''){element.attr('title',error[0].innerText);}}});if(self.form.valid()){return true;}else{$('#'+self.id+' .window-description .error').first().focus();$(self).trigger("validationerror",[data]);return false;}}else if(jQuery().parsley){data.validate=self.form.parsley('validate');if(self.form.parsley('isValid')){return true;}
$('#'+self.id+' .window-description .error').first().focus();$(self).trigger("validationerror",[data]);return false;}else{return true;}};RichHTML.window.prototype.mask=function(){var $t,height,width;$t=$('.richwindow');height=($t.outerHeight()===0)?$(document).height():$t.outerHeight();width=$t.outerWidth();$("#richhtml-overlay-inner").css({top:$t.offset().top,left:$t.offset().left,width:width,height:height,display:''});$("#richhtml-overlay-inner").show();};RichHTML.window.prototype.unMask=function(){$("#richhtml-overlay-inner").fadeOut();$("#richhtml-overlay-inner").css({display:'none',left:'-999999px'});};RichHTML.window.prototype.buttonBindings=function(){var self=this,me,data={};me=$('#'+self.id);me.find('.rich-button').bind('click',function(){var scope,buttonId=$(this).attr('id').substring(12);if(buttonId==="autoclose"){if(self.options.showSubmit&&self.options.beforeCancel){self.options.beforeCancel();}
self.hide();data.btn="ok";$(self).trigger('buttonclick',[data]);}else if(buttonId==="submit"){if(!self.validateForm()){return false;}
if(self.options.showSubmit&&self.options.beforeSubmit){if(self.options.beforeSubmit()===false){return false;}}
self.submit(self.options.onSubmit);data.btn="submit";$(self).trigger('buttonclick',[data]);}else if(buttonId==="delete"){self.callDelete(self.options.onDelete);data.btn="delete";$(self).trigger('buttonclick',[data]);}else{if(((self.options.buttons[buttonId].type!=="cancel")||typeof(self.options.buttons[buttonId].type)==="undefined")&&!self.validateForm()){return false;}
if(typeof self.options.buttons[buttonId].onclick==='function'&&self.options.buttons[buttonId].onclick!==false){self.options.buttons[buttonId].onclick(self,{elements:self.form.serializeArray()});}else{self.hide();}
data.btn=self.options.buttons[buttonId].text;if((self.name=="richwindow")&&((typeof(self.options.buttons[buttonId].type)==="undefined")||(self.options.buttons[buttonId].type!=="cancel"))){$(self).trigger('buttonclick',[data]);}else{$(self).trigger('buttonclick',[data]);}}
return false;});return true;};RichHTML.window.prototype.setEscToClose=function(bClose){var self=this;self.options.escClose=bClose;};RichHTML.window.prototype.setUrl=function(url){var self=this;self.options.url=url;};RichHTML.window.prototype.addParams=function(newparams){this.params=$.extend(this.params,newparams);};RichHTML.window.prototype.reload=function(){this.load();};RichHTML.window.prototype.load=function(){var self=this,me;me=$('#'+self.id);if(self.delayLoad){RichHTML.mask('#'+self.id);$.get(self.options.url,self.params,function(response,status,xhr){me.find('.window-description form .window-description-elements').html(response);if(status=="error"){var msg="Sorry but there was an error: ";RichHTML.debug(1,Array(msg+xhr.status+" "+xhr.statusText,xhr));}
self.prepElements();});RichHTML.unMask();}else{self.prepElements();}
$(document).bind('keydown',self.closeKeyHandler).bind('keydown',self.tabKeyHandler).bind('keydown',self.enterKeyHandler);};RichHTML.window.prototype.show=function(options){var self=this;if(options&&typeof(options.params)!=="undefined"){self.params=$.extend(self.params,options.params);}else{self.params={};}
if(options&&typeof(options.options)!=="undefined"){self.options=$.extend(self.options,options.options);}
RichHTML.debug(3,Array("Starting render for: "+self.id,self));if(!self.prepTemplate()){return false;}
if(!self.prepButtons()){return false;}
if(!self.render(self.options.useOverlay)){return false;}
if(self.hasButtons&&!self.buttonBindings()){return false;}
this.load();self.setDraggable();return true;};RichHTML.window.prototype.prepElements=function(){var self=this,tabbable,me;me=$('#'+self.id);me.find(':input, .rich-button, textarea').eq(0).focus();tabbable=me.find(':input, .rich-button, textarea');if(tabbable.length>0){self.elements.firstElement=$(tabbable).filter(':first');self.elements.lastElement=$(tabbable).filter(':last');self.elements.firstGroup=(self.elements.firstElement[0].type!=='radio')?self.elements.firstElement:tabbable.filter("[name='"+self.elements.firstElement[0].name+"']");self.elements.lastGroup=(self.elements.lastElement[0].type!=='radio')?self.elements.lastElement:tabbable.filter("[name='"+self.elements.lastElement[0].name+"']");}
$('.richwindow .loading-content').removeClass('loading-content');};RichHTML.window.prototype.setDraggable=function(){var self=this,me,relX,relY,thistarget,targetw,targeth,docw,doch,ismousedown=false;me=$('#'+self.id);me.css('position','absolute');thistarget=me.find('.window-title');targetw=thistarget.width();targeth=thistarget.height();thistarget.bind('mousedown',function(e){var pos,srcX,srcY,mousePos;pos=me.offset();srcX=pos.left;srcY=pos.top;docw=$('body').width();doch=$('body').height();mousePos=RichHTML.mouseCoords(e);relX=e.pageX-srcX;relY=e.pageY-srcY;ismousedown=true;});$(document).bind('mousemove',function(e){var maxY,maxX,mousePos,diffX,diffY;if(ismousedown)
{targetw=me.width();targeth=me.height();maxX=docw-targetw-10;maxY=doch-targeth-10;mousePos=RichHTML.mouseCoords(e);diffX=mousePos.x-relX;diffY=mousePos.y-relY;me.css('top',(diffY)+'px');me.css('left',(diffX)+'px');}});$(window).bind('mouseup',function(e){ismousedown=false;});return this;};;heartbeat={pulseCount:0,pulseLength:0,pulseTop:0,beat:null,beats:[],url:'index.php?fuse=admin&action=pulse',add:function(options){var that=this;if(typeof options.name!='string'||typeof options.pulse!='number'){alert('Invalid parameters in heartbeat function');}
for(i=0;i<this.beats.length;i++){if(this.beats[i].name==options.name){return false;}}
var defaults={args:{},callback:null,pulse:15,delay:null};options=$.extend(true,{},defaults,options);for(var i in options.args){if(i=='fuse'||i=='action'){alert('cannot use restricted query params "fuse" or "action"');}}
if(options.delay!==null){if(options.delay!==0){setTimeout(function(){that.prepulse(options.name,options.args,options.callback);that.beats.push({name:options.name,pulse:options.pulse,args:options.args,callback:options.callback});that.setPulse();},options.delay*1000);}else{this.prepulse(options.name,options.args,options.callback);this.beats.push({name:options.name,pulse:options.pulse,args:options.args,callback:options.callback});this.setPulse();}}else{this.beats.push({name:options.name,pulse:options.pulse,args:options.args,callback:options.callback});this.setPulse();}
return true;},remove:function(beatName){for(i=0;i<this.beats.length;i++){if(this.beats[i].name==beatName){this.beats.splice(i,1);}}
this.setPulse();},check:function(beatName){for(i=0;i<this.beats.length;i++){if(this.beats[i].name==beatName){return true;}}
return false;},setPulse:function(){if(this.beats.length===0){clearInterval(this.beat);this.pulseCount=0;this.pulseTop=0;this.pulseLength=0;return;}
var pulseArray=[];for(var i=0;i<this.beats.length;i++){pulseArray.push(this.beats[i].pulse);}
this.pulseCount=0;this.pulseTop=this.gcf_lcm_ar('lcm',pulseArray.slice());this.pulseLength=this.gcf_lcm_ar('gcf',pulseArray.slice());if(this.beat){clearInterval(this.beat);}
this.beat=setInterval(function(){heartbeat.pulse();},this.pulseLength*1000);},prepulse:function(name,args,callback){var that=this;var beatArgs={};beatArgs[name]=args;$.ajax({type:'POST',url:that.url,data:{args:JSON.stringify(beatArgs)},success:function(response){ce.checkRedirectLogin(response);if(callback){callback(response.returnArgs[name]);}}});},pulse:function(){var that=this;this.pulseCount+=this.pulseLength;var beatArgs={},beatFunctions={},firePulse=false;for(i=0;i<this.beats.length;i++){if(this.pulseCount%this.beats[i].pulse===0){firePulse=true;if(this.beats[i].args!==null){beatArgs[this.beats[i].name]=this.beats[i].args;}else{beatArgs[this.beats[i].name]={};}
if(this.beats[i].callback!==null){beatFunctions[this.beats[i].name]=this.beats[i].callback;}}}
if(firePulse){$.ajax({type:'POST',url:that.url,data:{args:JSON.stringify(beatArgs)},dataType:'json',success:function(response){ce.checkRedirectLogin(response);for(var n in beatFunctions){if(n in response.returnArgs){beatFunctions[n](response.returnArgs[n]);}else{beatFunctions[n]();}}},error:function(jqXHR){if(jqXHR.responseText.indexOf("g=installer")>-1){window.location.href='../index.php';}}});}
if(this.pulseCount==this.pulseTop){this.pulseCount=0;}},gcf:function(a,b){return(b===0)?(a):(this.gcf(b,a%b));},lcm:function(a,b){return(a/this.gcf(a,b))*b;},gcf_lcm_ar:function(type,ar){if(ar.length>1){if(type=='lcm'){ar.push(this.lcm(ar.shift(),ar.shift()));}else{ar.push(this.gcf(ar.shift(),ar.shift()));}
return this.gcf_lcm_ar(type,ar);}else{return ar[0];}}};;$(document).ready(function(){var all=$.event.props,len=all.length,res=[];while(len--){var el=all[len];if(el!='layerX'&&el!='layerY')res.push(el);}
$.event.props=res;});function setStatus(s,time){}
function resetStatus(s){}
function unsetStatus(s,time){}
function msg(title){ce.msg(title);}
function dump(arr,level){var dumped_text="";if(!level){level=0;}
var level_padding="";for(var j=0;j<level+1;j++){level_padding+="    ";}
if(typeof(arr)=='object'){for(var item in arr){var value=arr[item];if(typeof(value)=='object'){dumped_text+=level_padding+"'"+item+"' ...\n";dumped_text+=dump(value,level+1);}else{dumped_text+=level_padding+"'"+item+"' => \""+value+"\"\n";}}}else{dumped_text="===>"+arr+"<===("+typeof(arr)+")";}
return dumped_text;}
function html_entity_decode(str){return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
function slideToggle(el,bShow){var $el=$(el),height=$el.data("originalHeight"),visible=$el.is(":visible");if(arguments.length==1)bShow=!visible;if(bShow==visible)return false;if(!height){height=$el.show().height();$el.data("originalHeight",height);if(!visible)$el.hide().css({height:0});}
if(bShow){$el.show().animate({height:height},{duration:250});}else{$el.animate({height:0},{duration:250,complete:function(){$el.hide();}});}
return true;}
function getFormErrors(form)
{var strAlertMessageArr=new Array();var elements=form.getElementsByTagName("input");for(var i=0;i<elements.length;i++){if(elements[i].name.substr(0,2)=="r_"){var requiredElementName=elements[i].name.substr(2);for(var j=0;j<elements.length;j++){if(elements[j].name==requiredElementName&&elements[j].value==""){strAlertMessageArr.push(clientexec.lang("The field % can't be empty.",elements[i].value));break;}}}
if(elements[i].name.substr(0,2)=="e_"){regexp=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,6})+$/;var elementName=elements[i].name.substr(2);for(var j=0;j<elements.length;j++){if(elements[j].name==elementName&&!regexp.test(elements[j].value)){strAlertMessageArr.push(clientexec.lang('Invalid Email format for field %.',elements[i].value));break;}}}}
return strAlertMessageArr;}
function lang(phrase)
{if((typeof language!="undefined")&&(typeof language[phrase]!="undefined")&&(language[phrase]!='')){switch(lang.arguments.length){case 1:return language[phrase];case 2:return _sprintf(language[phrase],lang.arguments[1]);case 3:return _sprintf(language[phrase],lang.arguments[1],lang.arguments[2]);case 4:return _sprintf(language[phrase],lang.arguments[1],lang.arguments[2],lang.arguments[3]);}
return language[phrase];}
switch(lang.arguments.length){case 1:return phrase;case 2:return _sprintf(phrase,lang.arguments[1]);case 3:return _sprintf(phrase,lang.arguments[1],lang.arguments[2]);}
return phrase;}
function varLang(phrase)
{return lang(phrase);}
var winHelpHNDL=null;var winUtilityHNDL=null;var winDebug=null;var new_fieldname="";var highlightcolor="lightYellow";var ns6=document.getElementById&&!document.all;var previous='';var eventobj;var intended=/INPUT|TEXTAREA/;var isIE=false;var isIE7=false;var isOther=false;var isNS4=false;var isNS6=false;var submitted=false;if(document.getElementById)
{if(!document.all)
{isNS6=true;}
if(document.all)
{isIE=true;}}
else
{if(document.layers)
{isNS4=true;}
else
{isOther=true;}}
isIE7=isIE&&document.documentElement&&typeof document.documentElement.style.maxHeight!="undefined";function rmbr(string){var regexp=/(<br>)|(<br\/>)/gi;string=string.replace(regexp,'\r\n');return string;}
function nl2br(string){var regexp=/\n/g;string=string.replace(regexp,'<br>\n');return string;}
function noenter(e){if(window.event){return!(window.event.keyCode==13);}else{return!(e.which==13);}}
function InArray(tarray,value)
{var i;for(i=0;i<tarray.length;i++){if(tarray[i]===value){return true;}}
return false;}
function selectedValue(id)
{return document.getElementById(id).options[document.getElementById(id).selectedIndex].value}
function MakeVisable(cur,which){strength=(which==0)?1:0.4;if(cur.style.MozOpacity){cur.style.MozOpacity=strength;}else if(cur.filters){cur.filters.alpha.opacity=strength*100;}}
function ItemSelected(form,warningmsg,onlyCb){intCount=form.elements.length;bolShowMessage=true;for(x=1;x<=intCount;x++){if(form.elements[x-1].checked&&(!onlyCb||form.elements[x-1].id.substring(0,3)=='cb_')){bolShowMessage=false;continue;}}
if(bolShowMessage){if(warningmsg!="")alert(warningmsg);return false;}else{return true;}}
function ltrim(inputString){if(typeof inputString!="string"){return inputString;}
var retValue=inputString;var ch=retValue.substring(0,1);while(ch==" "){retValue=retValue.substring(1,retValue.length);ch=retValue.substring(0,1);}
return retValue;}
function trim(inputString){if(typeof inputString!="string"){return inputString;}
var retValue=inputString;var ch=retValue.substring(0,1);while(ch==" "){retValue=retValue.substring(1,retValue.length);ch=retValue.substring(0,1);}
ch=retValue.substring(retValue.length-1,retValue.length);while(ch==" "){retValue=retValue.substring(0,retValue.length-1);ch=retValue.substring(retValue.length-1,retValue.length);}
while(retValue.indexOf("  ")!=-1){retValue=retValue.substring(0,retValue.indexOf("  "))+retValue.substring(retValue.indexOf("  ")+1,retValue.length);}
return retValue;}
function submitonce(theform){if(document.all||document.getElementById){for(i=0;i<theform.length;i++){var tempobj=theform.elements[i]
if(tempobj.type.toLowerCase()=="submit"||tempobj.type.toLowerCase()=="button")
tempobj.disabled=true}}}
var checkCount=0;function makevisible(cur,which)
{strength=(which==0)?1:0.2
if(cur.style.MozOpacity)
cur.style.MozOpacity=strength
else if(cur.filters)
cur.filters.alpha.opacity=strength*100}
function updateButtons(form)
{if(checkCount>0){for(i=0;i<form.length;i++){element=form.elements[i];if(element.type=="button"||element.type=="submit"){element.disabled=false;makevisible(element,0);}}}else{for(i=0;i<form.length;i++){element=form.elements[i];if(element.type=="button"||element.type=="submit"){element.disabled=true;makevisible(element,1);}}}}
function checkCheckBox(checkBox)
{if(checkBox.checked)checkCount++;else checkCount--;updateButtons(checkBox.form);}
function toggleAll(form)
{check=form.toggleAllChk.checked;for(i=0;i<form.length;i++){element=form.elements[i];if(element.type=='checkbox'&&element.name!='toggleAll'&&element.checked!=check&&element.disabled!=true){element.checked=check;if(check)checkCount++;else checkCount=0;}}
updateButtons(form);}
function strrpos(haystack,needle,offset){var i=(haystack+'').lastIndexOf(needle,offset);return i>=0?i:false;}
function substr(f_string,f_start,f_length){f_string+='';if(f_start<0){f_start+=f_string.length;}
if(f_length==undefined){f_length=f_string.length;}else if(f_length<0){f_length+=f_string.length;}else{f_length+=f_start;}
if(f_length<f_start){f_length=f_start;}
return f_string.substring(f_start,f_length);}
function getAbsoluteTop(objectId){o=document.getElementById(objectId)
oTop=o.offsetTop
while(o.offsetParent!=null){oParent=o.offsetParent
oTop+=oParent.offsetTop
o=oParent}
return oTop}
function getElementsByName_iefix(tag,name){var elem=document.getElementsByTagName(tag);var arr=new Array();for(i=0,iarr=0;i<elem.length;i++){att=elem[i].getAttribute("name");if(att==name){arr[iarr]=elem[i];iarr++;}}
return arr;}
function _sprintf(s)
{var re=/%/;var i=0;while(re.test(s))
{s=s.replace(re,_sprintf.arguments[++i]);}
return s;}
jQuery.nl2br=function(varTest){return varTest.replace(/(\r\n|\n\r|\r|\n)/g,"<br>");};jQuery.br2nl=function(varTest){return varTest.replace(/<br>/g,"\r");};function passwordRequest(inputMail)
{var newElement=document.getElementById(inputMail);var newEmail=newElement.value;$.ajax({url:'index.php?fuse=admin&action=RequestPassword',success:function(t){unsetStatus(false);var response=t.responseText;document.getElementById('message').innerHTML='<font class="redtext"><b>'+response+'</b></font>';},data:{ajaxRequest:"1",emailToSend:newEmail}});}
function check(form,x,submit)
{if(typeof submit=='undefined')submit=true;script_name="Form Validator ver 2.0";action="Checks Required, Integer and Date";cpyrght="(c) 1998 - Art Lubin / Artswork";email="perflunk@aol.com";var set_up_var=doall(script_name,cpyrght,email);var message="";var more_message="";if(set_up_var==5872){x=x-1;for(var i=0;i<=x;i++){if(typeof form.elements[i].name=='undefined'){continue;}
var messenger=form.elements[i].name;messenger=messenger.substring(0,2);var fieldname=form.elements[i].name;fieldname=fieldname.substring(2);if((form.elements[i].name=="ccnumber"||form.elements[i].name=="ccmonth"||form.elements[i].name=="ccyear")&&document.getElementById("creditcardinfo").style.display=="none")
{form.elements[i].value="";}
var cctypes=null;if(messenger=="r_"){if(form.elements[i].value!=""){more_message=r_check(form,x,fieldname,i);}}else if(messenger=="c_"){if(form.elements[i].value!=""){more_message=c_check(form,x,fieldname,i,true);cctypes=form.elements['validcc'].value
if(more_message==""){more_message=CheckWithAllowedCardTypes(cctypes,form,x,fieldname,i);}}}else if(messenger=="C_"){if(form.elements[i].value!=""){more_message=c_check(form,x,fieldname,i,true);cctypes=form.elements['validcc'].value
if(more_message==""){more_message=CheckWithAllowedCardTypes(cctypes,form,x,fieldname,i);}}}else if(messenger=="D_"){if(form.elements[i].value!=""){more_message=D_check(form,x,fieldname,i);}}else if(messenger=="i_"){more_message=i_check(form,x,fieldname,i);}else if(messenger=="d_"){more_message=d_check(form,x,fieldname,i);}else if(messenger=="e_"){more_message=e_check(form,x,fieldname,i);}else if(messenger=="n_"){more_message=n_check(form,x,fieldname,i);}
if(more_message!=""){if(more_message){if(message==""){message=more_message;more_message="";}else{message=message+"\n"+more_message;more_message="";}}}}
if(message!=""){alert(clientexec.lang("The following form field(s) were incomplete or incorrect")+":\n\n"+message+"\n\n"+clientexec.lang("Please complete or correct the form and submit again."));return false;}else{if(submit){submitonce(form);try{form.onsubmit();}catch(e){}
if(!submitted){form.submit();submitted=true;}}
return true;}}else{alert("The copyright information has been changed. \n In order to use this javascript please keep the copyright information intact. \n\n Script Name: Form Validator ver 2.0 \n Copyright: (c) 1998 - Art Lubin / Artswork \n Email: perflunk@aol.com");return false;}}
function isNum(str)
{regexp=/(^\d+\.?\d*)|(^\d*\.?\d+)/;if(regexp.test(str))return true;else return false;}
function n_check(form,x,fieldname,i)
{var msg_addition="";error=0;for(var y=0;y<=x;y++){if(form.elements[y].name==fieldname)break;}
numberField=form.elements[y].value;if(!isNum(numberField)){error=1;}else{if(numberField.indexOf('.3')>1)error=1;}
if(error==1)msg_addition=form.elements[i].value;return(msg_addition);}
function c_check(form,x,fieldname,i,blankallowed)
{var msg_addition="";error=0;for(var y=0;y<=x;y++){if(form.elements[y].name==fieldname)break;}
CardNumber=form.elements[y].value;error=checkCCNumber(CardNumber,blankallowed);if(error==1){msg_addition=form.elements[i].value;}
return(msg_addition);}
function checkCCNumber(CardNumber,blankallowed)
{error=0;if(CardNumber!=""){if(!isNum(CardNumber)){error=1;}else{var no_digit=CardNumber.length;var oddoeven=no_digit&1;var sum=0;for(var count=0;count<no_digit;count++){var digit=parseInt(CardNumber.charAt(count));if(!((count&1)^oddoeven)){digit*=2;if(digit>9)digit-=9;}
sum+=digit;}
if(sum%10==0){error=0;}else{error=1;}}}else if(!blankallowed){error=1;}
return(error);}
function D_check(form,x,fieldname,i)
{for(var y=0;y<=x;y++)
{if(form.elements[y].name==fieldname)break;}
var msg_addition="";regexp=/^\w+([\.-]?\w+)*(\.\w{2,3})+$/;if(regexp.test(form.elements[y].value))error=0;else{error=1;}
if(error==1)msg_addition=form.elements[i].value;return(msg_addition);}
function r_check(form,x,fieldname,i)
{var msg_addition="";new_fieldname=fieldname;for(var y=0;y<=x;y++)
{if((form.elements[y].type=="radio"||form.elements[y].type=="checkbox")&&form.elements[y].name==new_fieldname&&form.elements[y].checked==true)
{msg_addition="";break;}
else if((form.elements[y].type=="radio"||form.elements[y].type=="checkbox")&&form.elements[y].name==new_fieldname&&form.elements[y].checked==false)
{msg_addition=form.elements[i].value;}
else if(form.elements[y].type=="select-one")
{var l=form.elements[y].selectedIndex;if(form.elements[y].name==fieldname&&form.elements[y].options[l].value!="")
{msg_addition="";break;}
else if(form.elements[y].name==fieldname&&form.elements[y].options[l].value=="")
{msg_addition=form.elements[i].value;}}
else if(form.elements[y].name==fieldname&&form.elements[y].value==""&&form.elements[y].type!="radio"&&form.elements[y].type!="checkbox"&&form.elements[y].type!="select-one")
{if(form.elements[y].name=='UserName'||form.elements[y].name=='Password'){msg_addition="";}else{msg_addition=form.elements[i].value;break;}}
else if(form.elements[y].name==fieldname&&form.elements[y].value!=""&&form.elements[y].type!="radio"&&form.elements[y].type!="checkbox"&&form.elements[y].type!="select-one")
{msg_addition="";}}
return(msg_addition);}
function i_check(form,x,fieldname,i)
{for(var y=0;y<=x;y++)
{if(form.elements[y].name==fieldname)break;}
var msg_addition="";var decimal="";inputStr=form.elements[y].value.toString();if(inputStr=="")
{}
else
{for(var c=0;c<inputStr.length;c++)
{var oneChar=inputStr.charAt(c);if(c==0&&oneChar=="-"||oneChar=="."&&decimal=="")
{if(oneChar==".");{decimal="yes";}
continue;}
if(oneChar<"0"||oneChar>"9")
{msg_addition=form.elements[i].value;}}}
return(msg_addition);}
function e_check(form,x,fieldname,i)
{for(var y=0;y<=x;y++){if(form.elements[y].name==fieldname)break;}
var msg_addition="";regexp=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,6})+$/;if(!regexp.test(form.elements[y].value)){msg_addition=form.elements[i].value;}
return(msg_addition);}
function d_check(form,x,fieldname,i)
{for(var y=0;y<=x;y++)
{if(form.elements[y].name==fieldname)break;}
var msg_addition="";var sDate=form.elements[y].value;var int_or_not=isInteger(form.elements[y].value);if(int_or_not=="true")
{if((!(form.elements[y].value.length>=6))||(!(form.elements[y].value.length<=10)))
{msg_addition=form.elements[i].value;}
else
{var SlashlPos=form.elements[y].value.indexOf("/",0);if(SlashlPos>0&&SlashlPos<=2)
{if(SlashlPos==1)
{if(form.elements[y].value.charAt(0)<1||form.elements[y].value.charAt(0)>9)
{msg_addition=form.elements[i].value;}
else
{if((form.elements[y].value.charAt(0)==1||form.elements[y].value.charAt(0)==3||form.elements[y].value.charAt(0)==5||form.elements[y].value.charAt(0)==7||form.elements[y].value.charAt(0)==8)&&((form.elements[y].value.charAt(2)==0&&form.elements[y].value.charAt(3)=="/")||(form.elements[y].value.charAt(3)=="/"&&form.elements[y].value.length>=7)||(form.elements[y].value.charAt(1)=="/"&&form.elements[y].value.charAt(2)=="/")))
{msg_addition=form.elements[i].value;}
else if((form.elements[y].value.charAt(0)==1||form.elements[y].value.charAt(0)==3||form.elements[y].value.charAt(0)==5||form.elements[y].value.charAt(0)==7||form.elements[y].value.charAt(0)==8)&&((form.elements[y].value.charAt(2)>=3&&form.elements[y].value.charAt(3)>1)||(form.elements[y].value.charAt(2)==0&&form.elements[y].value.charAt(3)==0)||(form.elements[y].value.charAt(1)=="/"&&(form.elements[y].value.charAt(3)!="/"&&form.elements[y].value.charAt(4)!="/"&&form.elements[y].value.charAt(5)!="/"&&form.elements[y].value.charAt(6)!="/"))))
{msg_addition=form.elements[i].value+"hi";}
else if((form.elements[y].value.charAt(0)==1||form.elements[y].value.charAt(0)==3||form.elements[y].value.charAt(0)==5||form.elements[y].value.charAt(0)==7||form.elements[y].value.charAt(0)==8)&&(((form.elements[y].value.charAt(2)>3&&form.elements[y].value.charAt(3)!="/")||(((form.elements[y].value.charAt(1)=="/"&&form.elements[y].value.charAt(4)=="/"))&&((form.elements[y].value.length==6||form.elements[y].value.length==8))))||form.elements[y].value.charAt(5)=="/"))
{msg_addition=form.elements[i].value;}
else
{if((form.elements[y].value.charAt(0)==2&&((form.elements[y].value.charAt(2)==0&&form.elements[y].value.charAt(3)=="/")||(form.elements[y].value.charAt(3)=="/"&&form.elements[y].value.length>=7)||(form.elements[y].value.charAt(1)=="/"&&form.elements[y].value.charAt(2)=="/")||(form.elements[y].value.charAt(2)==0&&form.elements[y].value.charAt(3)==0)||(form.elements[y].value.charAt(1)=="/"&&(form.elements[y].value.charAt(3)!="/"&&form.elements[y].value.charAt(4)!="/"&&form.elements[y].value.charAt(5)!="/"&&form.elements[y].value.charAt(6)!="/")))))
{msg_addition=form.elements[i].value;}
else if(form.elements[y].value.charAt(0)==2&&((form.elements[y].value.charAt(2)>2&&form.elements[y].value.charAt(3)!="/")||(((form.elements[y].value.charAt(1)=="/"&&form.elements[y].value.charAt(4)=="/")&&((form.elements[y].value.length==6||form.elements[y].value.length==8))))||form.elements[y].value.charAt(5)=="/"))
{msg_addition=form.elements[i].value;}
else
{if((form.elements[y].value.charAt(0)==4||form.elements[y].value.charAt(0)==6||form.elements[y].value.charAt(0)==9)&&((form.elements[y].value.charAt(2)==0&&form.elements[y].value.charAt(3)=="/")||(form.elements[y].value.charAt(3)=="/"&&form.elements[y].value.length>=7)||(form.elements[y].value.charAt(1)=="/"&&form.elements[y].value.charAt(2)=="/")))
{msg_addition=form.elements[i].value;}
else if((form.elements[y].value.charAt(0)==4||form.elements[y].value.charAt(0)==6||form.elements[y].value.charAt(0)==9)&&((form.elements[y].value.charAt(2)>=3&&form.elements[y].value.charAt(3)>0)||(form.elements[y].value.charAt(2)==0&&form.elements[y].value.charAt(3)==0)||(form.elements[y].value.charAt(1)=="/"&&(form.elements[y].value.charAt(3)!="/"&&form.elements[y].value.charAt(4)!="/"&&form.elements[y].value.charAt(5)!="/"&&form.elements[y].value.charAt(6)!="/"))))
{msg_addition=form.elements[i].value;}
else if((form.elements[y].value.charAt(0)==4||form.elements[y].value.charAt(0)==6||form.elements[y].value.charAt(0)==9)&&(((form.elements[y].value.charAt(2)>3&&form.elements[y].value.charAt(3)!="/")||((form.elements[y].value.charAt(1)=="/"&&form.elements[y].value.charAt(4)=="/")&&((form.elements[y].value.length==6||form.elements[y].value.length==8))))||form.elements[y].value.charAt(5)=="/"))
{msg_addition=form.elements[i].value;}}}}}
else
{if(form.elements[y].value.charAt(0)>1||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)>2)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==0))
{msg_addition=form.elements[i].value;}
else
{if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==1)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==3)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==5)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==7)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==8)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==0)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==2))&&((form.elements[y].value.charAt(3)==0&&form.elements[y].value.charAt(4)=="/")||(form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(3)=="/")||(form.elements[y].value.charAt(2)=="/"&&(form.elements[y].value.charAt(4)!="/"&&form.elements[y].value.charAt(5)!="/"&&form.elements[y].value.charAt(6)!="/"&&form.elements[y].value.charAt(7)!="/"))))
{msg_addition=form.elements[i].value;}
else if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==1)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==3)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==5)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==7)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==8)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==0)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==2))&&((form.elements[y].value.charAt(3)>=3&&form.elements[y].value.charAt(4)>1)||(form.elements[y].value.charAt(3)==0&&form.elements[y].value.charAt(4)==0)||form.elements[y].value.length<7))
{msg_addition=form.elements[i].value;}
else if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==1)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==3)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==5)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==7)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==8)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==0)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==2))&&((form.elements[y].value.charAt(3)>3&&form.elements[y].value.charAt(4)!="/")||((form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(5)=="/"&&form.elements[y].value.length==7||form.elements[y].value.charAt(6)=="/")||(form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(4)=="/"&&(form.elements[y].value.length==6||form.elements[y].value.length==8)))))
{msg_addition=form.elements[i].value;}
else
{if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==2)&&((form.elements[y].value.charAt(3)==0&&form.elements[y].value.charAt(4)=="/")||(form.elements[y].value.charAt(3)==0&&form.elements[y].value.charAt(4)==0))||form.elements[y].value.length<7)||(form.elements[y].value.charAt(2)=="/"&&(form.elements[y].value.charAt(4)!="/"&&form.elements[y].value.charAt(5)!="/"&&form.elements[y].value.charAt(6)!="/"&&form.elements[y].value.charAt(7)!="/")))
{msg_addition=form.elements[i].value;}
else if((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==2)&&((form.elements[y].value.charAt(3)>2&&form.elements[y].value.charAt(4)!="/")||((form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(5)=="/"&&form.elements[y].value.length==7||form.elements[y].value.charAt(6)=="/")||(form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(4)=="/"&&(form.elements[y].value.length==6||form.elements[y].value.length==8)))))
{msg_addition=form.elements[i].value;}
else
{if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==4)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==6)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==9)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==1))&&((form.elements[y].value.charAt(3)==0&&form.elements[y].value.charAt(4)=="/")||(form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(3)=="/")||(form.elements[y].value.charAt(2)=="/"&&(form.elements[y].value.charAt(4)!="/"&&form.elements[y].value.charAt(5)!="/"&&form.elements[y].value.charAt(6)!="/"&&form.elements[y].value.charAt(7)!="/"))))
{msg_addition=form.elements[i].value;}
else if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==4)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==6)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==9)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==1))&&((form.elements[y].value.charAt(3)>=3&&form.elements[y].value.charAt(4)>0)||(form.elements[y].value.charAt(3)==0&&form.elements[y].value.charAt(4)==0)||form.elements[y].value.length<7))
{msg_addition=form.elements[i].value;}
else if(((form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==4)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==6)||(form.elements[y].value.charAt(0)==0&&form.elements[y].value.charAt(1)==9)||(form.elements[y].value.charAt(0)==1&&form.elements[y].value.charAt(1)==1))&&((form.elements[y].value.charAt(3)>3&&form.elements[y].value.charAt(4)!="/")||((form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(5)=="/"&&form.elements[y].value.length==7||form.elements[y].value.charAt(6)=="/")||(form.elements[y].value.charAt(2)=="/"&&form.elements[y].value.charAt(4)=="/"&&(form.elements[y].value.length==6||form.elements[y].value.length==8)))))
{msg_addition=form.elements[i].value;}}}}}}
else
{msg_addition=form.elements[i].value;}}}
else
{msg_addition=form.elements[i].value;}
return(msg_addition);}
function isInteger(sDate)
{var new_msg=true;inputStr=sDate.toString();for(var i=0;i<inputStr.length;i++)
{var oneChar=inputStr.charAt(i);if((oneChar<"0"||oneChar>"9")&&oneChar!="/")
{new_msg=false;}}
return(new_msg);}
function doall(script_name,copyright,email)
{var code=0;var test=script_name+copyright+email;for(var a=0;a<test.length;a++)
{var each_char=test.charAt(a);var x=asc(each_char);code+=x;}
return(code);}
function asc(each_char)
{var n=0;var char_str=charSetStr();for(i=0;i<char_str.length;i++)
{if(each_char==char_str.substring(i,i+1))
{break;}}
return i+32;}
function charSetStr()
{var str;str=' !"#$%&'+"'"+'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~';return str;}
function CheckWithAllowedCardTypes(cctypes,form,x,fieldname,i)
{for(var y=0;y<=x;y++){if(form.elements[y].name==fieldname)break;}
CardNumber=form.elements[y].value;return CheckAllowedCCTypes(CardNumber,cctypes);}
function CheckAllowedCCTypes(CardNumber,cctypes)
{error=0;typeVisa=checkCreditCard(CardNumber,'Visa');typeMc=checkCreditCard(CardNumber,'MasterCard');typeAmex=checkCreditCard(CardNumber,'AmEx');typeDisc=checkCreditCard(CardNumber,'Discover');typeLaser=checkCreditCard(CardNumber,'LaserCard');typeDiners=checkCreditCard(CardNumber,'DinersClub');typeSwitch=checkCreditCard(CardNumber,'Switch');if(typeVisa){if(cctypes.substr(0,1)=="0")return clientexec.lang("Visa is not accepted at this time");else return'';}else if(typeMc){if(cctypes.substr(1,1)=="0")return clientexec.lang("MasterCard is not accepted at this time");else return'';}else if(typeAmex){if(cctypes.substr(2,1)=="0")return clientexec.lang("American Express is not accepted at this time");else return'';}else if(typeDisc){if(cctypes.substr(3,1)=="0")return clientexec.lang("Discover is not accepted at this time");else return'';}else if(typeLaser){if(cctypes.substr(4,1)=="0")return clientexec.lang("LaserCard is not accepted at this time");else return'';}else if(typeDiners){if(cctypes.substr(5,1)=="0")return clientexec.lang("Diners Club is not accepted at this time");else return'';}else if(typeSwitch){if(cctypes.substr(6,1)=="0")return clientexec.lang("Switch is not accepted at this time");else return'';}}
var ccErrorNo=0;var ccErrors=new Array()
ccErrors[0]="Unknown card type";ccErrors[1]="No card number provided";ccErrors[2]="Credit card number is in invalid format";ccErrors[3]="Credit card number is invalid";ccErrors[4]="Credit card number has an inappropriate number of digits";function checkCreditCard(cardnumber,cardname){var cards=new Array();cards[0]={name:"Visa",length:"13,16",prefixes:"4",checkdigit:true};cards[1]={name:"MasterCard",length:"16",prefixes:"51,52,53,54,55",checkdigit:true};cards[2]={name:"DinersClub",length:"14,16",prefixes:"305,36,38,54,55",checkdigit:true};cards[3]={name:"CarteBlanche",length:"14",prefixes:"300,301,302,303,304,305",checkdigit:true};cards[4]={name:"AmEx",length:"15",prefixes:"34,37",checkdigit:true};cards[5]={name:"Discover",length:"16",prefixes:"6011,622,64,65",checkdigit:true};cards[6]={name:"JCB",length:"16",prefixes:"35",checkdigit:true};cards[7]={name:"enRoute",length:"15",prefixes:"2014,2149",checkdigit:true};cards[8]={name:"Solo",length:"16,18,19",prefixes:"6334,6767",checkdigit:true};cards[9]={name:"Switch",length:"16,18,19",prefixes:"4903,4905,4911,4936,564182,633110,6333,6759",checkdigit:true};cards[10]={name:"Maestro",length:"12,13,14,15,16,18,19",prefixes:"5018,5020,5038,6304,6759,6761",checkdigit:true};cards[11]={name:"VisaElectron",length:"16",prefixes:"417500,4917,4913,4508,4844",checkdigit:true};cards[12]={name:"LaserCard",length:"16,17,18,19",prefixes:"6304,6706,6771,6709",checkdigit:true};var cardType=-1;for(var i=0;i<cards.length;i++){if(cardname.toLowerCase()==cards[i].name.toLowerCase()){cardType=i;break;}}
if(cardType==-1){ccErrorNo=0;return false;}
if(cardnumber.length==0){ccErrorNo=1;return false;}
cardnumber=cardnumber.replace(/\s/g,"");var cardNo=cardnumber
var cardexp=/^[0-9]{13,19}$/;if(!cardexp.exec(cardNo)){ccErrorNo=2;return false;}
if(cards[cardType].checkdigit){var checksum=0;var mychar="";var j=1;var calc;for(i=cardNo.length-1;i>=0;i--){calc=Number(cardNo.charAt(i))*j;if(calc>9){checksum=checksum+1;calc=calc-10;}
checksum=checksum+calc;if(j==1){j=2}else{j=1};}
if(checksum%10!=0){ccErrorNo=3;return false;}}
var LengthValid=false;var PrefixValid=false;var undefined;var prefix=new Array();var lengths=new Array();prefix=cards[cardType].prefixes.split(",");for(i=0;i<prefix.length;i++){var exp=new RegExp("^"+prefix[i]);if(exp.test(cardNo))PrefixValid=true;}
if(!PrefixValid){ccErrorNo=3;return false;}
lengths=cards[cardType].length.split(",");for(j=0;j<lengths.length;j++){if(cardNo.length==lengths[j])LengthValid=true;}
if(!LengthValid){ccErrorNo=4;return false;};return true;}
LazyLoad=(function(win,doc){var env,head,pending={},pollCount=0,queue={css:[],js:[]},styleSheets=doc.styleSheets;function createNode(name,attrs){var node=doc.createElement(name),attr;for(attr in attrs){if(attrs.hasOwnProperty(attr)){node.setAttribute(attr,attrs[attr]);}}
return node;}
function finish(type){var p=pending[type],callback,urls;if(p){callback=p.callback;urls=p.urls;urls.shift();pollCount=0;if(!urls.length){if(callback){callback.call(p.context,p.obj);}
pending[type]=null;if(queue[type].length){load(type);}}}}
function getEnv(){if(env){return;}
var ua=navigator.userAgent;env={async:doc.createElement('script').async===true};(env.webkit=/AppleWebKit\//.test(ua))||(env.ie=/MSIE/.test(ua))||(env.opera=/Opera/.test(ua))||(env.gecko=/Gecko\//.test(ua))||(env.unknown=true);}
function load(type,urls,callback,obj,context){var _finish=function(){finish(type);},isCSS=type==='css',i,len,node,p,pendingUrls,url;getEnv();if(urls){urls=typeof urls==='string'?[urls]:urls.concat();if(isCSS||env.async||env.gecko||env.opera){queue[type].push({urls:urls,callback:callback,obj:obj,context:context});}else{for(i=0,len=urls.length;i<len;++i){queue[type].push({urls:[urls[i]],callback:i===len-1?callback:null,obj:obj,context:context});}}}
if(pending[type]||!(p=pending[type]=queue[type].shift())){return;}
head||(head=doc.head||doc.getElementsByTagName('head')[0]);pendingUrls=p.urls;for(i=0,len=pendingUrls.length;i<len;++i){url=pendingUrls[i];if(isCSS){node=createNode('link',{charset:'utf-8','class':'lazyload',href:url,rel:'stylesheet',type:'text/css'});}else{node=createNode('script',{charset:'utf-8','class':'lazyload',src:url,'data-cfasync':'false'});node.async=false;}
if(env.ie){node.onreadystatechange=function(){var readyState=this.readyState;if(readyState==='loaded'||readyState==='complete'){this.onreadystatechange=null;_finish();}};}else if(isCSS&&(env.gecko||env.webkit)){if(env.webkit){p.urls[i]=node.href;poll();}else{setTimeout(_finish,50*len);}}else{node.onload=node.onerror=_finish;}
head.appendChild(node);}}
function poll(){var css=pending.css,i;if(!css){return;}
i=styleSheets.length;while(i&&--i){if(styleSheets[i].href===css.urls[0]){finish('css');break;}}
pollCount+=1;if(css){if(pollCount<200){setTimeout(poll,50);}else{finish('css');}}}
return{css:function(urls,callback,obj,context){load('css',urls,callback,obj,context);},js:function(urls,callback,obj,context){load('js',urls,callback,obj,context);}};})(this,this.document);if(typeof Range!="undefined"){if(typeof Range.prototype.createContextualFragment=="undefined"){Range.prototype.createContextualFragment=function(html){var doc=window.document;var container=doc.createElement("div");container.innerHTML=html;var frag=doc.createDocumentFragment(),n;while((n=container.firstChild)){frag.appendChild(n);}
return frag;};}}
if(!Array.prototype.filter)
{Array.prototype.filter=function(fun)
{"use strict";if(this==null)
throw new TypeError();var t=Object(this);var len=t.length>>>0;if(typeof fun!="function")
throw new TypeError();var res=[];var thisp=arguments[1];for(var i=0;i<len;i++)
{if(i in t)
{var val=t[i];if(fun.call(thisp,val,i,t))
res.push(val);}}
return res;};}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement){"use strict";if(this==null){throw new TypeError();}
var t=Object(this);var len=t.length>>>0;if(len===0){return-1;}
var n=0;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0;}else if(n!=0&&n!=Infinity&&n!=-Infinity){n=(n>0||-1)*Math.floor(Math.abs(n));}}
if(n>=len){return-1;}
var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++){if(k in t&&t[k]===searchElement){return k;}}
return-1;}}
if(!Array.prototype.diff){Array.prototype.diff=function(a){return this.filter(function(i){return!(a.indexOf(i)>-1);});}}
String.format=function(){var s=arguments[0];for(var i=0;i<arguments.length-1;i++){var reg=new RegExp("\\{"+i+"\\}","gm");s=s.replace(reg,arguments[i+1]);}
return s;};var customFields=function(){var ctrl;var customFieldsAdded=[];var allFieldsDisabled=true;var selectListeners=[];var clickListeners=[];var deleteRowListeners=[];var unique_id=0;return{load:function(fields,renderer,postload,unique){allFieldsDisabled=true;if(!unique)unique=false
for(var iterator=0;iterator<fields.length;iterator++){customFields.getMarkup(fields[iterator],renderer,unique);}
if(postload)postload();},bootstrap:function(data){$.each(data,function(key,value){if($(value).css('display')=='none'){$(value).addClass('hidden');}
$(value).removeAttr('style');$('input, label, select, button, textarea',value).removeAttr('style');$('label',value).addClass('control-label');if(value.localName=='label'){$(value).addClass('control-label');}
$('textarea',value).addClass('form-control').removeClass('disableSelect2AutoLoad').css('width','');if(value.localName=='textarea'){$(value).addClass('form-control').removeClass('disableSelect2AutoLoad').css('width','');}
$('input',value).removeClass('disableSelect2AutoLoad').addClass('form-control');if(value.localName=='input'){$(value).removeClass('disableSelect2AutoLoad').addClass('form-control');}
$('select',value).removeClass('disableSelect2AutoLoad').addClass('form-control');if(value.localName=='select'){$(value).removeClass('disableSelect2AutoLoad').addClass('form-control');}
$('button',value).removeAttr('onclick').removeClass('rich-button').addClass('form-control');if(value.localName=='button'){$(value).removeAttr('onclick').removeClass('rich-button').addClass('form-control');}
if($('div input',value).hasClass('disableDatePickerAutoLoad')){$('div input',value).parent().addClass('input-group').find('span.add-on').addClass('input-group-addon').find('i').addClass('fa fa-calendar');}});return data;},bootstrapWrap:function(data){var html='<div class="col-xs-12 header">';$.each(data,function(key,value){if($(value).css('display')=='none'){$(value).addClass('hidden');}
$(value).removeAttr('style');$('input, label, select, button, textarea',value).removeAttr('style');if(value.localName=='label'){$(value).addClass('control-label');if($(value).hasClass('checkbox')){$('input',value).removeClass('form-control');}}else if(value.localName=='input'){$(value).addClass('form-control');}else if(value.localName=='textarea'){$(value).addClass('form-control').removeClass('disableSelect2AutoLoad').css('width','');}else if(value.localName=='span'){$('input, select, textarea',value).addClass('form-control').removeClass('disableSelect2AutoLoad');}else if(value.localName=='select'){$(value).removeClass('disableSelect2AutoLoad').addClass('form-control');}else if(value.localName=='button'){$(value).removeAttr('onclick').removeClass('rich-button').addClass('form-control');}
if(value.localName=='div'||$(value).has('div')){$('input:not([type="checkbox"])',value).removeClass('disableSelect2AutoLoad').addClass('form-control');if($('input',value).hasClass('disableDatePickerAutoLoad')){$('input',value).parent().addClass('input-group').find('span.add-on').addClass('input-group-addon').find('i').addClass('fa fa-calendar');}
if(value.localName=='div'){$(value).addClass('col-sm-5 col-xs-12');}}
html+=value.outerHTML;});html+='</div>';return html;},getMarkup:function(currentFieldData,renderer,unique){var width;unique_id++;var isComboType=false;var allowBlankValue=true;var isDisabled=true;var selectFirstOnBlank=true;ctrl=null;if(currentFieldData.isrequired==1){allowBlankValue=false;}
if(currentFieldData.ischangeable==1){isDisabled=false;allFieldsDisabled=false;}
if(typeof(currentFieldData.selectfirstonblank)!="undefined"){if(!currentFieldData.selectfirstonblank){selectFirstOnBlank=false;}}
var createHiddenTypeField=false;var controlid=currentFieldData.id;if($.isNumeric(currentFieldData.id)||currentFieldData.fieldtype==50){controlid='CT_'+currentFieldData.id;createHiddenTypeField=true;}
currentFieldData.field_name=controlid;if(unique){currentFieldData.field_id=controlid+"_"+unique_id;}else{currentFieldData.field_id=controlid;}
currentFieldData.name=clientexec.lang(currentFieldData.name);var metaValue='';switch(currentFieldData.fieldtype){case'65':currentFieldData.is_password=true;case'2':case'14':case'3':case'5':case'13':case'11':case'12':case'7':case'0':this.renderTextField(controlid,currentFieldData,isDisabled,renderer);break;case'47':this.renderVATField(controlid,currentFieldData,isDisabled,renderer);break;case'10':this.renderTextArea(controlid,currentFieldData,isDisabled,renderer);break;case'15':this.renderDate(controlid,currentFieldData,isDisabled,renderer);break;case'16':case'1':currentFieldData.dropdownoptions=[[0,"No"],[1,"Yes"]];case'8':case'30':case'6':case'4':case'9':this.renderDropDown(controlid,currentFieldData,isDisabled,renderer);isComboType=true;break;case'49':this.renderButton(controlid,currentFieldData,isDisabled,renderer);break;case'52':this.renderHidden(controlid,currentFieldData,isDisabled,renderer);break;case'54':this.renderTextField(controlid,currentFieldData,isDisabled,renderer);$('#'+controlid).addClass('number');break;case'50':this.renderHostname(controlid,currentFieldData,isDisabled,renderer);break;case'55':this.renderNameserver(controlid,currentFieldData,isDisabled,renderer);break;case'53':this.renderCheckBox(controlid,currentFieldData,isDisabled,renderer);break;case'subdomain':this.renderSubDomain(controlid,currentFieldData,isDisabled,renderer);break;default:break;}
if(createHiddenTypeField){hiddenField={};hiddenField.value=currentFieldData.fieldtype;hiddenField.id='CTT_'+currentFieldData.id;hiddenField.name=currentFieldData.id;hiddenField.additional_class="customfield_hidden";hiddenField.field_name=hiddenField.id;if(unique){hiddenField.field_id=hiddenField.id+"_"+unique_id;}else{hiddenField.field_id=hiddenField.id;}
this.renderHidden(hiddenField.id,hiddenField,false,renderer);}
if((currentFieldData.listener)&&(currentFieldData.listener.onclick)){clickListeners[controlid]=currentFieldData.listener.onclick;$('#'+controlid).bind('click',function(){eval(clickListeners[this.id]+'()');});}
if((currentFieldData.listener)&&(currentFieldData.listener.onselect)){selectListeners[controlid]=currentFieldData.listener.onselect;$('#'+controlid).bind('change',function(){eval(selectListeners[this.id]+'()');});}},renderCheckBox:function(controlid,currentFieldData,isDisabled,renderer){var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-mincheck="1" parsley-required="true"':'';var field='<label class="checkbox"><input id="'+controlid+'" name="'+currentFieldData.id+'" value="'+currentFieldData.value+'" type="checkbox" '+required+' />'+currentFieldData.name+'</label>';var ctrl=$(field);renderer(ctrl);},renderHidden:function(controlid,currentFieldData,isDisabled,renderer){if(typeof(currentFieldData.name)==='undefined'){currentFieldData.name=currentFieldData.id;}
var label='<span for="'+controlid+'" class="customfield_hidden" style="display:none;">'+currentFieldData.name+'</span>';var field='<input id="'+controlid+'" name="'+currentFieldData.name+'" value="'+currentFieldData.value+'" type="hidden" />';var ctrl=$(label+field);renderer(ctrl);},renderButton:function(controlid,currentFieldData,isDisabled,renderer){hidden='';if(currentFieldData.ishidden){hidden='display: none';}
var width=(currentFieldData.width)?currentFieldData.width:330;var btnClass='btn';if(typeof(currentFieldData.class)!=='undefined'&&currentFieldData.class.length>0){btnClass+=' '+currentFieldData.class;}
var ctrl=$("<div id='"+controlid+"_wrapper'><button id='"+controlid+"' type='button' style='margin-top:20px;width:"+width+"px; "+hidden+"' class='"+btnClass+"'><span>"+clientexec.lang(currentFieldData.value)+"</span></button></div>");renderer(ctrl);},renderDate:function(controlid,currentFieldData,isDisabled,renderer){var options="",field="",ctrl,dateformat;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:288;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';if(currentFieldData.value&&currentFieldData.value!==''&&currentFieldData.value!=='00/00/0000'){}else{currentFieldData.value='No date selected';}
if(clientexec.dateFormat==="d/m/Y"){dateformat="dd/mm/yyyy";}else{dateformat="mm/dd/yyyy";}
field='<div style="'+hidden+'" class="input-append date" id="'+currentFieldData.field_id+'" data-date="'+currentFieldData.value+'" >';field+='<input name="'+controlid+'"" style="display: inline;width:'+width+'px" class="span2 disableDatePickerAutoLoad" type="text" value="'+currentFieldData.value+'" readonly>';field+='<span class="add-on"><i class="icon-calendar"></i></span>';field+='</div>';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
var arr=controlid.split("_");var ctt="<input type='hidden' name='CTT_"+arr[1]+"' value='15'>";ctrl=$(label+field+ctt);renderer(ctrl);$('#'+currentFieldData.field_id).datepicker({format:dateformat,autoclose:true});},renderNameserver:function(controlid,currentFieldData,isDisabled,renderer){var disabledtext=(isDisabled)?'disabled="disabled"':"";var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var label='<label  class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+currentFieldData.name+'</label>';var field='<input class="nameserver" style="width:250px;'+hidden+'" '+required+' value="'+currentFieldData.value+'" '+disabledtext+' type="text" id="'+controlid+'" name="'+controlid+'" />';var postdiv='<button type="button" name="'+controlid+'_nameserverdelete" id="'+controlid+'_nameserverdelete" style="margin-left:10px;'+hidden+'" class="rich-button btn" onclick="nameservers_deleteaddress(this);"><span>Delete</span></button>';var ctrl=$(label+field+postdiv);renderer(ctrl);},renderHostname:function(controlid,currentFieldData,isDisabled,renderer){var hosttype="",hostname="",address="",ctrl,options="",prediv="",postdiv="";var disabledtext=(isDisabled)?'disabled="disabled"':"";var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden="";var drop_class="";if(currentFieldData.ishidden){hidden="display:none;";drop_class="disableSelect2AutoLoad";}
selected=(currentFieldData.value.hosttype=="A")?"selected":"";options='<option value="A" '+selected+'>A</option>';selected=(currentFieldData.value.hosttype=="AAAA")?"selected":"";options+='<option value="AAAA" '+selected+'>AAAA</option>';selected=(currentFieldData.value.hosttype=="MXE")?"selected":"";options+='<option value="MXE" '+selected+'>MXE</option>';selected=(currentFieldData.value.hosttype=="MX")?"selected":"";options+='<option value="MX" '+selected+'>MX</option>';selected=(currentFieldData.value.hosttype=="CNAME")?"selected":"";options+='<option value="CNAME" '+selected+'>CNAME</option>';selected=(currentFieldData.value.hosttype=="URL")?"selected":"";options+='<option value="URL" '+selected+'>URL</option>';selected=(currentFieldData.value.hosttype=="FRAME")?"selected":"";options+='<option value="FRAME" '+selected+'>FRAME</option>';selected=(currentFieldData.value.hosttype=="TXT")?"selected":"";options+='<option value="TXT" '+selected+'>TXT</option>';hostname='<input style="width:176px;margin-right:3px;height:18px;margin-bottom:1px;'+hidden+'" '+required+' value="'+currentFieldData.value.hostname+'" '+disabledtext+' type="text" id="hostname_'+controlid+'" class="hostname" name="hostname_'+controlid+'"  placeholder="Name" />';hosttype='<select '+disabledtext+' '+required+' id="hosttype_'+controlid+'" class="hosttype '+drop_class+'" name="hosttype_'+controlid+'" style="width:90px;'+hidden+'">'+options+'</select>';address='<input style="margin-left:3px;width:176px;height:18px;margin-bottom:1px;'+hidden+'" '+required+" value='"+currentFieldData.value.address+"' "+disabledtext+' type="text" id="hostaddress_'+controlid+'" class="hostaddress" name="hostaddress_'+controlid+'" placeholder="Address" />';if(!currentFieldData.ishidden){prediv="<div id='hostdivider_"+controlid+"' style='padding-top:10px;'></div>";buttonDisabled='';if(isDisabled){buttonDisabled='disabled';}
postdiv='<button type="button" name="'+controlid+'_hostdelete" id="'+controlid+'_hostdelete" style="margin-left:10px;" class="rich-button btn" onclick="hostrecords_deleteaddress(this);" '+buttonDisabled+'><span>Delete</span></button>';}
ctrl=$(prediv+hostname+hosttype+address+postdiv);renderer(ctrl);if(typeof(packagemanager)!=="undefined"){packagemanager.newhostrecordid++;}else if(typeof(hostinfo)!=="undefined"){hostinfo.newhostrecordid++;}
if(!currentFieldData.ishidden){ctrlid='#hosttype_'+controlid;if($(ctrlid).hasClass('disableSelect2AutoLoad')){if(jQuery().select2){$(ctrlid).select2({minimumResultsForSearch:10,width:'resolve'});}}}},renderTextArea:function(controlid,currentFieldData,isDisabled,renderer){var field="",ctrl;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:315;var height=(currentFieldData.height)?currentFieldData.height:100;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';field='<textarea class="type_'+currentFieldData.fieldtype+' disableSelect2AutoLoad" '+disabledtext+' '+required+' id="'+controlid+'" name="'+controlid+'" style="width:'+width+'px; height:'+height+'px">'+currentFieldData.value+'</textarea>';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
ctrl=$(label+field);renderer(ctrl);},renderDropDown:function(controlid,currentFieldData,isDisabled,renderer){var options="",field="",ctrl,option_value,option_name;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:330;var showlabel=(typeof(currentFieldData.showlabel)!="undefined")?currentFieldData.showlabel:true;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var showcheckboxes=(typeof(currentFieldData.showcheckboxes)!="undefined")?currentFieldData.showcheckboxes:false;name=currentFieldData.name;if(!showcheckboxes&&currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}else if(showcheckboxes){options="<div class='field-description'>"+currentFieldData.description+"</div>";}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';var value_is_in_dropdown=false;$.each(currentFieldData.dropdownoptions,function(index,object){option_value=object[0];option_name=object[1];if(showcheckboxes){selected=(option_value==currentFieldData.value)?"checked":"";options+='<label  class="customfield_label radio"><input type="radio" '+selected+' name="'+controlid+'" value="'+option_value+'"> '+option_name+'</label>';}else{selected=(option_value==currentFieldData.value)?"selected":"";options+="<option value='"+option_value+"' "+selected+">"+option_name+"</option>";}
if(selected!=""){value_is_in_dropdown=true;}});if(!value_is_in_dropdown&&currentFieldData.value!=""){if(showcheckboxes){options+='<label  class="customfield_label radio"><input type="radio" checked name="'+controlid+'" value="'+currentFieldData.value+'"> '+currentFieldData.value+'</label>';}else{options+="<option value='"+currentFieldData.value+"' selected>"+currentFieldData.value+"</option>";}}
if(showcheckboxes){field="<fieldset>"+options+"</fieldset>";}else{if(typeof(currentFieldData.isquantity)!="undefined"&&currentFieldData.isquantity===true){field='<table style="width:100%"><tr><td style="width:75px">'+clientexec.lang("Quantity")+'*</br><input type="number" min="0" style="width:70px;" id="quantity_'+currentFieldData.field_id+'" name="quantity_'+controlid+'" class="quantity type_'+currentFieldData.fieldtype+'" value="'+currentFieldData.quantity+'"></td><td>'+clientexec.lang("Option")+'</br><select tabindex="1" class="type_'+currentFieldData.fieldtype+' disableSelect2AutoLoad form-control-addon-quantity" '+disabledtext+' '+required+' id="'+currentFieldData.field_id+'" name="'+controlid+'" style="width:'+width+'px">'+options+'</select></td></tr><tr><td colspan="2">* '+clientexec.lang("Prices will be multiplied by the quantity")+'</br></td></tr></table>';}else{field='<select tabindex="1" class="type_'+currentFieldData.fieldtype+' disableSelect2AutoLoad" '+disabledtext+' '+required+' id="'+currentFieldData.field_id+'" name="'+controlid+'" style="width:'+width+'px">'+options+'</select>';}}
if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
if(showlabel){ctrl=$(label+field);}else{ctrl=$(field);}
renderer(ctrl);ctrlid='#'+currentFieldData.field_id;if(!showcheckboxes){if($(ctrlid).hasClass('disableSelect2AutoLoad')){if(jQuery().select2){$(ctrlid).select2({minimumResultsForSearch:10,width:'resolve'});if(currentFieldData.ishidden){$(ctrlid).select2('container').hide();}}}}},renderTextField:function(controlid,currentFieldData,isDisabled,renderer){var is_password=(currentFieldData.is_password)?currentFieldData.is_password:false;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:315;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var additional_validation=(currentFieldData.validation_type)?'data-type="'+currentFieldData.validation_type+'"':'';var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';if(typeof(currentFieldData.value)=="undefined"){currentFieldData.value="";}
if(currentFieldData.value!==null&&currentFieldData.value!==false){currentFieldData.value=currentFieldData.value.replace(/"/g,'&quot;');}
var field='<input style="width:'+width+'px;'+hidden+'" '+required+' '+additional_validation+' class="type_'+currentFieldData.fieldtype+'" value="'+currentFieldData.value+'" '+disabledtext+' type="'+((is_password)?"password":"text")+'" id="'+controlid+'" name="'+controlid+'" />';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
var ctrl=$(label+field);renderer(ctrl);},renderSubDomain:function(controlid,currentFieldData,isDisabled,renderer){var width=(currentFieldData.width)?currentFieldData.width:315;var name=currentFieldData.name;var label='<table><tr><td><label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';var field='<input pattern="^([-0-9A-Za-z]+)$" data-required="true" parsley-required="true" style="width:'+width+'px;"class="type_'+currentFieldData.fieldtype+'" type="text" id="'+controlid+'" name="'+controlid+'" onchange="validateSubDomain(\''+controlid+'\');"/></td>';var field=field+'<td style="padding-top:26px"  valign="top">&nbsp; . &nbsp; <select name="subdomaintld_'+controlid+'" id="subdomaintld_'+controlid+'" onchange="validateSubDomain(\''+controlid+'\');">';$.each(currentFieldData.subdomains,function(index,value){field=field+'<option value="'+value+'">'+value+'</option>';})
field=field+'</select></td></tr></table>';var ctrl=$(label+field);renderer(ctrl);},renderVATField:function(controlid,currentFieldData,isDisabled,renderer){var is_password=(currentFieldData.is_password)?currentFieldData.is_password:false;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:293;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var additional_validation=(currentFieldData.validation_type)?'data-type="'+currentFieldData.validation_type+'"':'';var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';if(typeof(currentFieldData.value)=="undefined"){currentFieldData.value="";}
var field='<div class="input-group"><span class="input-group-addon" id="vat_country"></span><input style="width:'+width+'px;'+hidden+'" '+required+' '+additional_validation+' class="type_'+currentFieldData.fieldtype+'" value="'+currentFieldData.value+'" '+disabledtext+' type="'+((is_password)?"password":"text")+'" id="'+controlid+'" name="'+controlid+'" /></div>';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
var message0='<div id="vat_validating" style="display:none">'+clientexec.lang("Validating...")+'</div>';var message1='<div id="vat_valid" style="display:none">'+clientexec.lang("Valid VAT Number")+'</div>';var message2='<div id="vat_invalid" style="display:none">'+clientexec.lang("Invalid VAT Number")+'.&nbsp;<a href="javascript:validate_vat();"><font color=blue>'+clientexec.lang("Retry")+'</font></a></div>';var message3='<div id="vat_error" style="display:none">'+clientexec.lang("Unable to validate at the moment.")+'&nbsp;<a href="javascript:validate_vat();"><font color=blue>'+clientexec.lang("Retry")+'</font></a></div>';var ctrl=$('<span id="VAT'+controlid+'" name="VAT'+controlid+'">'+label+field+message0+message1+message2+message3+'</span>');renderer(ctrl);},getAllFieldsDisabled:function(){return allFieldsDisabled;},getCustomFieldsAdded:function(){return customFieldsAdded;},resetCustomFields:function(){customFieldsAdded=[];}};}();;var clientexec=clientexec||{};if(typeof(clientexec.sessionHash)!="undefined"){$.ajaxSetup({beforeSend:function(xhr){xhr.setRequestHeader('X-Session-Hash',clientexec.sessionHash);}});}
if(typeof(gHash)!="undefined"){$.ajaxSetup({beforeSend:function(xhr){xhr.setRequestHeader('X-Session-Hash',gHash);}});}
var MD5=function(string){function RotateLeft(lValue,iShiftBits){return(lValue<<iShiftBits)|(lValue>>>(32-iShiftBits));}
function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;lX8=(lX&0x80000000);lY8=(lY&0x80000000);lX4=(lX&0x40000000);lY4=(lY&0x40000000);lResult=(lX&0x3FFFFFFF)+(lY&0x3FFFFFFF);if(lX4&lY4){return(lResult^0x80000000^lX8^lY8);}
if(lX4|lY4){if(lResult&0x40000000){return(lResult^0xC0000000^lX8^lY8);}else{return(lResult^0x40000000^lX8^lY8);}}else{return(lResult^lX8^lY8);}}
function F(x,y,z){return(x&y)|((~x)&z);}
function G(x,y,z){return(x&z)|(y&(~z));}
function H(x,y,z){return(x^y^z);}
function I(x,y,z){return(y^(x|(~z)));}
function FF(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function GG(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function HH(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function II(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function ConvertToWordArray(string){var lWordCount;var lMessageLength=string.length;var lNumberOfWords_temp1=lMessageLength+8;var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;var lNumberOfWords=(lNumberOfWords_temp2+1)*16;var lWordArray=Array(lNumberOfWords-1);var lBytePosition=0;var lByteCount=0;while(lByteCount<lMessageLength){lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=(lWordArray[lWordCount]|(string.charCodeAt(lByteCount)<<lBytePosition));lByteCount++;}
lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=lWordArray[lWordCount]|(0x80<<lBytePosition);lWordArray[lNumberOfWords-2]=lMessageLength<<3;lWordArray[lNumberOfWords-1]=lMessageLength>>>29;return lWordArray;};function WordToHex(lValue){var WordToHexValue="",WordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(lValue>>>(lCount*8))&255;WordToHexValue_temp="0"+lByte.toString(16);WordToHexValue=WordToHexValue+WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);}
return WordToHexValue;};function Utf8Encode(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;};var x=Array();var k,AA,BB,CC,DD,a,b,c,d;var S11=7,S12=12,S13=17,S14=22;var S21=5,S22=9,S23=14,S24=20;var S31=4,S32=11,S33=16,S34=23;var S41=6,S42=10,S43=15,S44=21;string=Utf8Encode(string);x=ConvertToWordArray(string);a=0x67452301;b=0xEFCDAB89;c=0x98BADCFE;d=0x10325476;for(k=0;k<x.length;k+=16){AA=a;BB=b;CC=c;DD=d;a=FF(a,b,c,d,x[k+0],S11,0xD76AA478);d=FF(d,a,b,c,x[k+1],S12,0xE8C7B756);c=FF(c,d,a,b,x[k+2],S13,0x242070DB);b=FF(b,c,d,a,x[k+3],S14,0xC1BDCEEE);a=FF(a,b,c,d,x[k+4],S11,0xF57C0FAF);d=FF(d,a,b,c,x[k+5],S12,0x4787C62A);c=FF(c,d,a,b,x[k+6],S13,0xA8304613);b=FF(b,c,d,a,x[k+7],S14,0xFD469501);a=FF(a,b,c,d,x[k+8],S11,0x698098D8);d=FF(d,a,b,c,x[k+9],S12,0x8B44F7AF);c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);a=FF(a,b,c,d,x[k+12],S11,0x6B901122);d=FF(d,a,b,c,x[k+13],S12,0xFD987193);c=FF(c,d,a,b,x[k+14],S13,0xA679438E);b=FF(b,c,d,a,x[k+15],S14,0x49B40821);a=GG(a,b,c,d,x[k+1],S21,0xF61E2562);d=GG(d,a,b,c,x[k+6],S22,0xC040B340);c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);b=GG(b,c,d,a,x[k+0],S24,0xE9B6C7AA);a=GG(a,b,c,d,x[k+5],S21,0xD62F105D);d=GG(d,a,b,c,x[k+10],S22,0x2441453);c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);b=GG(b,c,d,a,x[k+4],S24,0xE7D3FBC8);a=GG(a,b,c,d,x[k+9],S21,0x21E1CDE6);d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);c=GG(c,d,a,b,x[k+3],S23,0xF4D50D87);b=GG(b,c,d,a,x[k+8],S24,0x455A14ED);a=GG(a,b,c,d,x[k+13],S21,0xA9E3E905);d=GG(d,a,b,c,x[k+2],S22,0xFCEFA3F8);c=GG(c,d,a,b,x[k+7],S23,0x676F02D9);b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);a=HH(a,b,c,d,x[k+5],S31,0xFFFA3942);d=HH(d,a,b,c,x[k+8],S32,0x8771F681);c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);a=HH(a,b,c,d,x[k+1],S31,0xA4BEEA44);d=HH(d,a,b,c,x[k+4],S32,0x4BDECFA9);c=HH(c,d,a,b,x[k+7],S33,0xF6BB4B60);b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);a=HH(a,b,c,d,x[k+13],S31,0x289B7EC6);d=HH(d,a,b,c,x[k+0],S32,0xEAA127FA);c=HH(c,d,a,b,x[k+3],S33,0xD4EF3085);b=HH(b,c,d,a,x[k+6],S34,0x4881D05);a=HH(a,b,c,d,x[k+9],S31,0xD9D4D039);d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);b=HH(b,c,d,a,x[k+2],S34,0xC4AC5665);a=II(a,b,c,d,x[k+0],S41,0xF4292244);d=II(d,a,b,c,x[k+7],S42,0x432AFF97);c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);b=II(b,c,d,a,x[k+5],S44,0xFC93A039);a=II(a,b,c,d,x[k+12],S41,0x655B59C3);d=II(d,a,b,c,x[k+3],S42,0x8F0CCC92);c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);b=II(b,c,d,a,x[k+1],S44,0x85845DD1);a=II(a,b,c,d,x[k+8],S41,0x6FA87E4F);d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);c=II(c,d,a,b,x[k+6],S43,0xA3014314);b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);a=II(a,b,c,d,x[k+4],S41,0xF7537E82);d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);c=II(c,d,a,b,x[k+2],S43,0x2AD7D2BB);b=II(b,c,d,a,x[k+9],S44,0xEB86D391);a=AddUnsigned(a,AA);b=AddUnsigned(b,BB);c=AddUnsigned(c,CC);d=AddUnsigned(d,DD);}
var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase();}
CE.prototype.htmlspecialchars=function(txt,onlyAmpersand){if(!txt)return'';txt=txt.replace(/&/g,"&amp;");if(onlyAmpersand){return txt}
return txt.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");}
CE.prototype.strip_tags=function(input,allowed){allowed=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join('');var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,commentsAndPhpTags=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return input.replace(commentsAndPhpTags,'').replace(tags,function($0,$1){return allowed.indexOf('<'+$1.toLowerCase()+'>')>-1?$0:'';});}
CE.prototype.dateRenderer=function(text){var newDate;if(!isNaN(text)){newDate=new Date(text*1000);}else{var components=/^(\d{4})-(\d{2})-(\d{2})$/.exec(text);if(components){newDate=new Date(components[1],components[2]-1,components[3]);}else{return text;}}
var y=newDate.getFullYear();var m=newDate.getMonth()+1;if(m<10){m='0'+m;}
var d=newDate.getDate();if(d<10){d='0'+d;}
return clientexec.dateFormat=='m/d/Y'?m+'/'+d+'/'+y:d+'/'+m+'/'+y;}
CE.prototype.linkify=function(text){var url_pattern=/(\()((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\))|(\[)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\])|(\{)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\})|(<|&(?:lt|#60|#x3c);)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(>|&(?:gt|#62|#x3e);)|((?:^|[^=\s'"\]])\s*['"]?|[^=\s]\s+)(\b(?:ht|f)tps?:\/\/[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]+(?:(?!&(?:gt|#0*62|#x0*3e);|&(?:amp|apos|quot|#0*3[49]|#x0*2[27]);[.!&',:?;]?(?:[^a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]|$))&[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]*)*[a-z0-9\-_~$()*+=\/#[\]@%])/img;var url_replace='$1$4$7$10$13<a href="$2$5$8$11$14" rel="nofollow" target="_blank">$2$5$8$11$14</a>$3$6$9$12';return text.replace(url_pattern,url_replace);};function CE(){}
CE.prototype.getAvatarUrl=function(email,size,name)
{if(!size)size=80;if(!name)name=email.substring(0,1);if(name.indexOf(' ')>1){text=name.split(' ');name=text[0].substring(0,1)+text[1].substring(0,1);}
var url="https://www.avatar.bio/avatar/"+email+"?bc=DAF1FF&tc=555555&t="+name+"&s="+size;return url;};CE.prototype.lazyLoad=function(){var last3Char,url;if(Object.prototype.toString.apply(arguments[0])!=='[object Array]'){arguments[0]=[arguments[0]];}
for(var i=0;i<arguments[0].length;i++){url=arguments[0][i];if(url.indexOf("?")<0){arguments[0][i]+='?ver='+gVer;}else{arguments[0][i]+='&ver='+gVer;}}
if(url.indexOf(".css")<0){return LazyLoad.js.apply(null,arguments);}else{return LazyLoad.css.apply(null,arguments);}}
CE.prototype.getMonth=function(month,short)
{if(typeof(short)==="undefined"){short=false;}
switch(month){case 1:return(short)?"Jan.":"January";exit;case 2:return(short)?"Feb.":"February";exit;case 3:return(short)?"Mar.":"March";exit;case 4:return(short)?"Apr.":"April";exit;case 5:return(short)?"May":"May";exit;case 6:return(short)?"June":"June";exit;case 7:return(short)?"July":"July";exit;case 8:return(short)?"Aug.":"August";exit;case 9:return(short)?"Sept.":"September";exit;case 10:return(short)?"Oct.":"October";exit;case 11:return(short)?"Nov.":"November";exit;case 12:return(short)?"Dec.":"December";exit;}}
CE.prototype.checkRedirectLogin=function(response){try{if(typeof(response.redirectToLogin)!="undefined"&&response.redirectToLogin){window.location='index.php?fuse=admin&action=logout';}}catch(e){}};CE.prototype.parseResponse=function(response,display,msg){if(display==undefined){display=true;}
message=response.message.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");try{if(typeof(response.error)!="undefined"&&response.error){var error;if((response.message!="")&&display){error=message;error=error.replace(/\n/gi,"<br /> \n");RichHTML.error(error);}else if(display){error="There was an error performing this action";if(msg!=undefined){error=msg;}
RichHTML.error(error);}
response=new Object();response.error=true;response.message=error;}else if(typeof(response.error)=="undefined"){response=new Object();response.error=true;RichHTML.error("Data returned seems to be pure html");}else{if((response.message!="")&&display){ce.msg(message);}}}catch(e){response=new Object();response.error=true;response.message="Data returned is not valid json<br/>"+e.toString()+'<br />'+response;if(display){RichHTML.error(response.message);}}
return response;};CE.prototype.msg=function(title,perm){$(window).scrollTop(0);clearTimeout($('#msg-div').data('timeoutId'));$('#msg-div-inner').text(title);$('#msg-div').show().removeClass('hidden');if(!perm){timeoutId=setTimeout(function(){$('#msg-div').fadeOut('fast');},2500);$('#msg-div').data('timeoutId',timeoutId);}};CE.prototype.errormsg=function(title){clearTimeout($('#msg-div').data('timeoutId'));$('#msg-div-inner').text(title);$('#msg-div').fadeIn('normal');$('#msg-div').css("cursor","pointer");$('#msg-div').click(function(){$('#msg-div').fadeOut('fast');});};CE.prototype.createPluginInput=function(inputObj){var newInput={};switch(inputObj.type){case'text':case'hidden':case'password':newInput=$('<input id="input'+inputObj.name+'" name="'+inputObj.name+'" type="'+inputObj.type+'" />');newLabel='<label data-toggle="tooltip" title="'+inputObj.description+'" data-html="true" for="input'+inputObj.name+'">'+inputObj.label+'</label>';break;case'textarea':newInput=$('<textarea rows="8" id="textarea'+inputObj.name+'" name="'+inputObj.name+'"></textarea>');newLabel='<label data-toggle="tooltip" title="'+inputObj.description+'" data-html="true" for="textarea'+inputObj.name+'">'+inputObj.label+'</label>';break;case'checkbox':case'yesno':newInput=$('<select id="select'+inputObj.name+'" name="'+inputObj.name+'"><option value="1">Yes</option><option value="0">No</option></select>');newLabel='<label data-toggle="tooltip" title="'+inputObj.description+'" data-html="true" for="select'+inputObj.name+'">'+inputObj.label+'</label>';break;default:return false;}
newInput.attr('title',inputObj.description).val(inputObj.value);return{label:newLabel,input:newInput};};CE.prototype.isMobile=function(){var check=false;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check=true})(navigator.userAgent||navigator.vendor||window.opera);return check;};CE.prototype.isMobileOrTablet=function(){var check=false;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check=true;})(navigator.userAgent||navigator.vendor||window.opera);return check;};CE.prototype.isIE=function(){return((navigator.appName=='Microsoft Internet Explorer')||((navigator.appName=='Netscape')&&(new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})").exec(navigator.userAgent)!=null)));}
var ce=new CE();if(ce.isIE()){$('body').addClass('ce-ie');}
function jumpMenu(targ,selObj,restore)
{s=new String(selObj.options[selObj.selectedIndex].value);s.replace("&amp;","&");if(s=="")return false;if(selObj.selectedIndex==0)return false;eval(targ+".location='"+s+"'");if(restore)selObj.selectedIndex=0;}
function jumpMenu2(targ,selObj,restore)
{s=new String(selObj.options[selObj.selectedIndex].value);if(s=="")return false;s.replace("&amp;","&");eval(targ+".location='"+s+"'");if(restore)selObj.selectedIndex=0;}
/*!
  SerializeJSON jQuery plugin.
  https://github.com/marioizquierdo/jquery.serializeJSON
  version 1.0.1 (Aug 20, 2012)

  Copyright (c) 2012 Mario Izquierdo
  Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
  and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
*/
(function(b){b.fn.serializeJSON=function(){var d,c;d={};c=this.serializeArray();b.each(c,function(g,e){var f,j,h;f=e.name;j=e.value;h=b.map(f.split("["),function(i){var k;k=i[i.length-1];return k==="]"?i.substring(0,i.length-1):i});if(h[0]===""){h.shift()}b.deepSet(d,h,j)});return d};var a=function(c){return c===Object(c)};b.deepSet=function(c,k,g){if(!k||k.length===0){throw new Error("ArgumentError: keys param expected to be an array with least one key")}var i,d,f,h,j,e;i=k[0];d=k[1];if(d!==undefined&&d!==null){f=k.slice(1);if(i===""){j=c.length-1;e=c[c.length-1];if(a(e)&&!e[d]){i=j}else{c.push({});i=j+1}}if(c[i]===undefined){h=(d===""||!isNaN(parseInt(d,10)))?[]:{};c[i]=h}b.deepSet(c[i],f,g)}else{if(i===""){c.push(g)}else{c[i]=g}}}}(jQuery));function _sprintf(s)
{var re=/%/;var i=0;while(re.test(s))
{s=s.replace(re,_sprintf.arguments[++i]);}
return s;}
clientexec.lang=function(phrase)
{if((typeof language!="undefined")&&(typeof language[phrase]!="undefined")&&(language[phrase]!='')){switch(clientexec.lang.arguments.length){case 1:return language[phrase];case 2:return _sprintf(language[phrase],clientexec.lang.arguments[1]);case 3:return _sprintf(language[phrase],clientexec.lang.arguments[1],clientexec.lang.arguments[2]);case 4:return _sprintf(language[phrase],clientexec.lang.arguments[1],clientexec.lang.arguments[2],clientexec.lang.arguments[3]);}
return clientexec.language[phrase];}
switch(clientexec.lang.arguments.length){case 1:return phrase;case 2:return _sprintf(phrase,clientexec.lang.arguments[1]);case 3:return _sprintf(phrase,clientexec.lang.arguments[1],clientexec.lang.arguments[2]);case 4:return _sprintf(phrase,clientexec.lang.arguments[1],clientexec.lang.arguments[2],clientexec.lang.arguments[3]);}
return phrase;}
if($.fn.dataTable){$.extend(true,$.fn.dataTable.defaults,{responsive:true,processing:true,autoWidth:false,language:{processing:clientexec.lang('Loading...'),emptyTable:clientexec.lang('No data available in table'),info:clientexec.lang('Showing % to % of % entries','_START_','_END_','_TOTAL_'),infoEmpty:clientexec.lang('Showing 0 to 0 of 0 entries'),infoFiltered:'('+clientexec.lang('filtered from % total entries','_MAX_')+')',infoPostFix:"",thousands:",",lengthMenu:clientexec.lang("Show % entries",'_MENU_'),loadingRecords:clientexec.lang("Loading..."),search:clientexec.lang("Search:"),zeroRecords:clientexec.lang("No matching records found"),paginate:{first:clientexec.lang("<<"),last:clientexec.lang(">>"),next:clientexec.lang(">"),previous:clientexec.lang("<")},aria:{sortAscending:": "+clientexec.lang("activate to sort column ascending"),sortDescending:": "+clientexec.lang("activate to sort column descending")}},});};var globalSearch={};(function(){var originalLoadMethod=jQuery.fn.load;jQuery.fn.load=function(){originalLoadMethod.apply(this,arguments);clientexec.postpageload();};})();if(typeof(RichHTML)!="undefined"){$(RichHTML).bind({"preload":function(event){ce.msg('Loading',true);},"postload":function(event){$("#msg-div").hide();}});}
jQuery.extend(jQuery.expr[":"],{reallyvisible:function(a){return!(jQuery(a).is(":hidden")||jQuery(a).parents(":hidden").length||jQuery(a).css('display')=='none');}});clientexec.bindLinksIfLeavingInvoiceViewIsPrevented=function()
{if(typeof(invoiceview)!=="undefined"&&typeof(invoiceview.changesmade)!=="undefined"&&invoiceview.changesmade){$('a:not(.btn):not(.rich-button),div.accordion-group').unbind('click',invoiceview.clickanchorsafterchanges);$('a:not(.btn):not(.rich-button),div.accordion-group').bind('click',invoiceview.clickanchorsafterchanges);}};clientexec.raiseevent=function(eventname,args)
{$.ajax({url:"index.php?fuse=admin&controller=index&action=raiseevent",type:'POST',data:{eventname:eventname,args:args},success:function(){}});};clientexec.getfullcontact=function(forcepull)
{var tpl="<div class='contact-card'> "+"<div class='box'> "+"<div class='column'> "+"<ul class='identity'> "+"{{#contactInfo}}<li class='identity-fullname'>{{fullName}}</li> "+"{{#has_org}}<li class='identity-org'>{{org}} ({{title}})</li>{{/has_org}}{{/contactInfo}}"+"{{#has_organization}}<li class='org-title'>Past Organizations:</li>{{/has_organization}} "+"{{#organizations}}<li class='org'>{{#title}}{{title}},{{/title}}{{name}} </li>{{/organizations}} "+"</ul> "+"{{#demographics}}<ul class='demographics'> "+"<li class='demographics-location'><i class='icon-map-marker' style='color:#361B1B;padding-left: 4px;'></i>&nbsp;&nbsp;{{location}}</li> "+"</ul>{{/demographics}} "+"{{#has_sites}}<ul class='websites'> "+"<li class='website'><i class='icon-globe' style='color:#557DFA;'></i>&nbsp;&nbsp;Websites ({{website_count}}) <i onclick=\"$('.websites .website').show();\" class='icon-chevron-down' style='color:rgb(226, 131, 43); cursor:pointer;'></i></li>"+"{{#sites}}<li class='website website-small'><a href='{{url}}' target='_blank'>{{url}}</a></li>{{/sites}} "+"</ul>{{/has_sites}} "+"{{#has_interests}}<ul class='interests'> "+"<li class='interest'><i class='icon-heart' style='color:#FF6C6C;'></i>&nbsp;&nbsp;Interests ({{interests_count}}) <i onclick=\"$('.interests .interest').show();\" class='icon-chevron-down' style='color:rgb(226, 131, 43); cursor:pointer;'></i></li>"+"<li class='interest interest-small'>{{#interests}}{{tag}}, {{/interests}}</li> "+"</ul>{{/has_interests}} "+"{{#has_social}}<ul class='social'> "+"{{#socials}}<li class='social-profile'> "+"<a target='_blank' href='{{url}}'> "+"<img src='https://api.fullcontact.com/images/socialProfileIcons/{{type}}.png'> "+"</a> "+"</li>{{/socials}} "+"</ul>{{/has_social}} "+"</div> "+"</div> "+"</div>";$('.full-contact-profile').html("<center style='margin-top:30px;margin-bottom:30px;'><img src='../images/loader.gif'></center>");$.getJSON('index.php?fuse=clients&controller=userprofile&forcepull='+forcepull+'&action=getfullcontact',function(response){$('.fullcontact-description').hide();$('.update-full-contact-btn').hide();$('.full-contact-btn').hide();if(!response.profile||response.profile.length==0){$('.full-contact-profile').html("<div class='api-error'><h1 style='text-align:center;'>Contact has no social data</h1><p>We have been unable to retrieve any social data for this contact.  Please try again after 90 days.</p></div>");$('.full-contact-profile').show();$('.fullcontact-description').show();$('.full-contact-btn').show();return;}
var profile=response.profile[0];if(profile.status=="202"){$('.full-contact-profile').html("<div class='api-error'><h1 style='text-align:center;'>Social data being retrieved ...</h1><p>Your request is currently being processed. Please allow up to 10 minutes as we compile social data for this contact.</p></div>");$('.full-contact-btn').show();$('.fullcontact-description').show();}else if(profile.status=="404"){$('.full-contact-profile').html("<div class='api-error'><h1 style='text-align:center;'>Contact has no social data</h1><p>We have been unable to retrieve any social data for this contact.  Please try again after 90 days.</p></div>");$('.full-contact-btn').show();$('.fullcontact-description').show();}else if(profile.status!="200"){$('.full-contact-profile').html("<div class='api-error'><h1 style='text-align:center;'>Error collecting social data</h1><p>"+profile.message+"</p></div>");$('.full-contact-btn').show();$('.fullcontact-description').show();}else{items=clientexec.build_full_contact_json(profile);var output=Mustache.render(tpl,items);$('.full-contact-profile').html(output);$('.fullcontact-description').show();$('.update-full-contact-btn').show();}
$('.full-contact-profile').show();});}
clientexec.getfullcontact_active=function()
{if($('.full-contact-active .social-profile').length>0)return;var tpl="<div class='contact-card'> "+"<div class='box'> "+"<div class='column'> "+"{{#has_social}}<ul class='social'> "+"{{#socials}}<li class='social-profile'> "+"<a target='_blank' href='{{url}}'> "+"<img src='https://api.fullcontact.com/images/socialProfileIcons/{{type}}.png'> "+"</a> "+"</li>{{/socials}} "+"</ul>{{/has_social}} "+"</div> "+"</div> "+"</div>";$.getJSON('index.php?fuse=clients&controller=userprofile&forcepull=0&action=getfullcontact',function(response){if(response.profile===null)return;if(!response.profile[0])return;var profile=response.profile[0];if(profile.status=="200"){items=clientexec.build_full_contact_json(profile);var output=Mustache.render(tpl,items);$('.full-contact-active').html(output);$('.full-contact-active').show();}else{$('.full-contact-active').hide();}});}
clientexec.build_full_contact_json=function(profile){items={contactInfo:profile.contactInfo,organizations:[],has_social:false,has_org:false,socials:[],has_sites:false,sites:[],website_count:0,interests_count:0,has_interests:false,interests:[],};if(profile.contactInfo&&profile.contactInfo.websites){$.each(profile.contactInfo.websites,function(i,o){items.has_sites=true;items.sites.push({url:o.url});items.website_count++;});}
if(profile.digitalFootprint&&profile.digitalFootprint.topics){$.each(profile.digitalFootprint.topics,function(i,o){items.has_interests=true;items.interests.push({tag:o.value});items.interests_count++;});}
if(profile.organizations){$.each(profile.organizations,function(i,o){if(o.isPrimary&&o.current){items.contactInfo.title=o.title;items.contactInfo.org=o.name;items.has_org=true;}else{items.organizations.push({name:o.name,title:o.title});items.has_organization=true;}});}
if(profile.demographics&&profile.demographics.locationGeneral){items.demographics={};items.demographics.location=profile.demographics.locationGeneral;}
$.each(profile['socialProfiles'],function(i,o){items.has_social=true;items.socials.push({name:o.typeName,url:o.url,type:o.type});});return items;}
clientexec.events_while_away=[];clientexec.addNewEvent=function(text,header,avataremail,date){if(!header||trim(header)==""){header="Notice";}else{header=header;}
if(avataremail&&avataremail!=""){avataremail=ce.getAvatarUrl(avataremail,80,header);}else{avataremail="../templates/admin/images/logo_in1.png";}
event={"text":text,"header":header,"url":avataremail,"time":date};event.calctime=function(){var time1=Date.now();var time2=new Date(this.time*1000);return Math.ceil((((time1-time2)/1000)/60))+"m";};clientexec.events_while_away.push(event);if($('.m-growl:visible').length==0){$('.m-growlicon').show();}};clientexec.hide_growl_events=function()
{$('.m-growl').hide();if(clientexec.events_while_away.length>0){$('.m-growlicon').show();}else{$('.m-growlicon').hide();}}
clientexec.show_growl_events=function()
{$('.m-growlicon').hide();$('.m-growl').show();var tpl='{{#arr}}<div class="m-entry" data-path="{{url}}"><span class="m-facelink"><img class="m-face" src="{{url}}"></span><div class="m-data"><div class="m-meta"><strong class="m-name">{{header}}</strong><span class="m-time">{{calctime}}</span></div><span class="m-link">{{{text}}}</span></div></div>{{/arr}}';var output=Mustache.render(tpl,{arr:clientexec.events_while_away});$('.m-entries').html(output);clientexec.events_while_away=[];}
clientexec.popupKBArticle=function(id,title)
{if(typeof(title)==="undefined")title="Knowledgebase Article";else{if(title.length>45)title=title.substr(0,43)+"";}
clientexec.kbarticle=new RichHTML.window({height:'400',width:'550',url:'index.php?fuse=knowledgebase&view=articlepopup&articleId='+id,title:title});clientexec.kbarticle.show();};clientexec.postpageload=function(parent)
{if(!parent)parent='body';$(parent+' select:not([data-format], .disableSelect2AutoLoad)').select2({minimumResultsForSearch:10,width:'resolve',});$(parent+' select[data-format]:not(.disableSelect2AutoLoad)').select2({minimumResultsForSearch:10,width:'resolve',formatResult:function(o){var fnc=$(o.element[0]).closest('select').data('format');return window[fnc](o);},formatSelection:function(o){return o.text;}});$.each($(".select2-container"),function(i,n){$(n).find('select').fadeTo(0,0).width("0").height("0").css("left","-10000000px").css("position","absolute");});$(parent+" span.btn-group a.btn.dropdown-toggle").click(function(event){if($(this).attr('disabled')=='disabled'){event.preventDefault();return false;}else{return true;}});$(parent+' input.datepicker:not(.disableDatePickerAutoLoad)').datepicker({format:clientexec.dateFormat=='m/d/Y'?'mm/dd/yyyy':'dd/mm/yyyy',autoclose:true});$(parent+' input.timepicker:not(.disableTimePickerAutoLoad)').timepicker();$(parent+' textarea.wysihtml5:not([data-withembed])').redactor({parentSel:'#product-tab-content',autoresize:false,plugins:['clips','rtl'],execCommandCallback:true,buttons:['html','|','formatting','|','bold','italic','underline','|','unorderedlist','orderedlist','|','table','link','|','fontcolor','backcolor','|','alignment']});$(parent+' textarea.wysihtml5[data-withembed]').redactor({parentSel:'#product-tab-content',imageUpload:'index.php?action=uploadimage&controller=articles&fuse=knowledgebase&sessionHash='+gHash,autoresize:false,plugins:['clips','rtl'],execCommandCallback:true,buttons:['html','|','formatting','|','bold','italic','underline','|','unorderedlist','orderedlist','|','image','video','file','table','link','|','fontcolor','backcolor','|','alignment']});if(typeof(gHash)!="undefined"){$('<input>').attr({type:'hidden',name:'sessionHash',value:gHash}).appendTo('form');}else{console.log("hash not defined");}
$(parent+" .change-grid-showrecords").select2("val",clientexec.records_per_view);$(parent+' .change-grid-showrecords').unbind('change',clientexec.changegridshowrecords);$(parent+' .change-grid-showrecords').change(clientexec.changegridshowrecords);$('.tooltip').remove();$(parent).tooltip({html:true,selector:'[data-toggle=tooltip]'});$(parent).popover({trigger:'hover',selector:'[data-toggle=popover-hover]'});if(ce.isMobileOrTablet()){$(".select2-search input").prop("readonly",true);}};clientexec.changegridshowrecords=function(){var self=$(this);$.ajax({url:"index.php?fuse=clients&controller=customfields&action=save",type:'POST',data:{newvalue:self.val(),customfieldname:'Records per page',staffid:clientexec.admin_id},success:function(){clientexec.records_per_view=self.val();}});};function staff_member_not_active()
{clientexec.focused=false;}
var timeoutTime=400*1000;var timeoutTimer=setTimeout(staff_member_not_active,timeoutTime);clientexec.load_active_user_panel=function(load_data)
{if(typeof(load_data)=="undefined")load_data=true;$('.active-customer-panel').show();$('.active-customer-panel').animate({right:"0"},300,function(){$('.active-customer-panel').addClass("opened_panel");});if((load_data)&&($.trim($('.active-customer-panel').text())=="")){$('.active-customer-panel').load("index.php?fuse=admin&view=activecustomer&nolog=1");}}
clientexec.hide_active_user_panel=function()
{if($('.active-customer-panel').hasClass("opened_panel")){$('.active-customer-panel').animate({right:"-304px"},300,function(){$('.active-customer-panel').removeClass("opened_panel").hide();});}}
clientexec.pin_active_user_panel=function()
{var session_vars;if($('body.with-active-cutomer-panel').length==0){$('body').addClass('with-active-cutomer-panel');$('.active-customer-panel').unbind('mouseenter mouseleave');session_vars={showactivepanelstatus:1};if($('.mac-os').length==0){$('.active-customer-panel').css("right","16px");}}else{$('body').removeClass('with-active-cutomer-panel');$('.active-customer-panel').hover(function(){$('.active-customer-panel').show();},clientexec.hide_active_user_panel);session_vars={showactivepanelstatus:0};$('.active-customer-panel').css("right","0");}
$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:session_vars}});}
$('body').on('click','.pin-active-profile',clientexec.pin_active_user_panel);$('body').on('click','.ticket-filter-link',function(e){if((typeof(ticketList)!="undefined")&&(typeof(ticketList.grid)!="undefined")&&(!ticketList.viewing_from_customer_profile)){e.preventDefault();$('.ce-top-menu li .drop').addClass('hide-drop');setTimeout(function(){$('.ce-top-menu li .drop').removeClass('hide-drop')},500);History.replaceState({time:(new Date()).getTime(),search_filter:$(this).attr('data-filter-id'),search_filter_name:$(this).attr('data-filter-name'),search_customerid:0},"",$(this).attr('href'));}else{return true;}});$(document).ready(function(){clientexec.badge=0;RichHTML.prefixLabel=gVer;if($('body.with-active-cutomer-panel').length==0)$('.active-customer-panel').hover(function(){$('.active-customer-panel').show();},clientexec.hide_active_user_panel);$('#header .active-customer').hover(clientexec.load_active_user_panel,function(){return true;});if(clientexec.customerId>0){var timeout=5000;if($('.active-customer-panel').text()==""){timeout=0;$('.active-customer-panel').html("<div class='loading-active-customer'>"+clientexec.lang("Loading")+" ...</div>");}
setTimeout(function(){$('.active-customer-panel').load("index.php?fuse=admin&view=activecustomer&nolog=1");},timeout);}
$(window).blur(function(){clientexec.focused=false;});$('body').bind('mousemove keydown',function(event){clientexec.focused=true;clientexec.badge=0;clearTimeout(timeoutTimer);timeoutTimer=setTimeout(staff_member_not_active,timeoutTime);});clientexec.postpageload();clientexec.pluginMgr=new PluginMgr({items:7,start:0});clientexec.pluginMgr.startAutoPlugins();clientexec.getSelectedProfileAndAvailableActions=function()
{$('.active-customer-panel').html("<div class='loading-active-customer'>"+clientexec.lang("Loading")+" ...</div>");$('.active-customer-panel').load("index.php?fuse=admin&view=activecustomer&nolog=1");};$('button.closepluginpanel').bind('click',function(e){$('div.pluginframe').hide();$('div.pluginframe-header').hide();$('#selected-leftmenu-icon-tick').remove();$('.withpluginpanel').removeClass('withpluginpanel');$('.leftmenu-icon-active').removeClass('leftmenu-icon-active');clientexec.pluginMgr.active_panel="";var session_vars={pluginpanelPosition:"none",leftbarplugins:$('.lefmenu-plugin-icons').html()};$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:session_vars}});$(window).trigger('resize');if(clientexec.myChart)clientexec.myChart._resize();});clientexec.togglerightpanel=function()
{$('.rightframe').toggle();$('.maincontainer').toggleClass('withoutrightpanel');$(window).trigger('resize');if(clientexec.myChart)clientexec.myChart._resize();};if(clientexec.customerChanged){clientexec.getSelectedProfileAndAvailableActions();}
var History=window.History;globalSearch.formatResult=function(result){var markup='<div class="search-item"';if(result.tooltip){markup+=' data-toggle="tooltip" title="'+result.tooltip+'" data-placement="right"';}
markup+='><div class="type">'+result.type+'</div><div class="name bold">'+result.name+'</div>';if(result.extra){markup+=result.extra;}
markup+='</div>';return markup;};globalSearch.formatSelection=function(selection){return selection.url;};$('.btn-advanced-search').bind("click",function(){clientexec.advancedsearch={};clientexec.advancedsearchwin=new RichHTML.window({url:'index.php?fuse=clients&controller=users&view=advancedsearch',title:clientexec.lang('Advanced Search'),width:'300',height:'200',left:$('.btn-advanced-search').offset().left-280,top:'40',buttons:{button1:{text:"search","onclick":function(){clientexec.advancedsearch.submitCustomUserSearch();}},button2:{text:"cancel",type:"cancel"}}});clientexec.advancedsearchwin.show();});$("#searchquerytextfield").select2({placeholder:clientexec.lang("Quick Search")+" ...",minimumInputLength:3,width:'198px',multiple:true,openOnEnter:false,quietMillis:500,formatResult:globalSearch.formatResult,formatSelection:globalSearch.formatSelection,dropdownCssClass:'globalsearch-dropdown-active',maximumSelectionSize:1,allowClear:false,id:function(choice){return choice.url;},ajax:{url:"index.php?fuse=admin&action=getsearchresults",dataType:'json',quietMillis:500,data:function(term,page){return{query:term,limit:10,page:page};},results:function(data,page){if(data.total){globalSearch.totalResults=data.total;}
var more=(page*10)<globalSearch.totalResults;return{results:data.matches,more:more};}}}).change(function(){if((typeof(invoiceview)!=='undefined')&&(invoiceview.changesmade)){invoiceview.clickanchorsafterchanges(e);return false;}else{window.location=$(this).val();}});if($.inArray("livevisitor",clientexec.sidebarplugins.names)>-1){$('.profile-dropdown-switches').show();$('.profile-bottom-divider').show();$('.switch-chatstatus').on('switch-change',function(e,data){var val=(data.value)?1:0;clientexec.updateCustomField('ChatStatus',val);});}
clientexec.eventwindow=new RichHTML.window({height:'400',width:'550',hideTitle:true});clientexec.initialize_sidepanel_plugins();heartbeat.add({name:'index.php?fuse=admin&action=getvitals',delay:1,pulse:15,callback:function(response){ce.checkRedirectLogin(response);if(response.needyourattention.length>0){clientexec.updatevitals(response.needyourattention);}
if(typeof(response.onlineusers)!="undefined"){clientexec.updateonlineusers(response.onlineusers);}
if(response.newEvents.length>0){clientexec.updateEvents(response.newEvents);}
if(typeof(response.ticketfilters)!="undefined"){clientexec.updateticketfiltercounts(response.ticketfilters);}
if(response.ataglance&&typeof dashboard!='undefined'){dashboard.renderAtAGlance(response.ataglance);}}});$(document).on('click','.m-growlicon',function(){clientexec.show_growl_events();});$(document).on('click','.m-remove-growls',function(){clientexec.hide_growl_events();});});clientexec.update_ticket_filters=function()
{$.get('index.php?fuse=support&controller=ticketfilter&action=getticketfilter',function(response){clientexec.updateticketfiltercounts(response);});}
clientexec.eventdetailwindow=function(id,entryType)
{if(entryType=="email"){clientexec.eventwindow.setUrl('index.php?fuse=clients&view=historyfullemail');}else if(entryType=="note"){clientexec.eventwindow.setUrl('index.php?fuse=clients&view=eventlogstaffnote');}else{clientexec.eventwindow.setUrl('index.php?fuse=clients&view=eventdetails');}
clientexec.eventwindow.show({params:{entryId:id,entryType:entryType}});}
clientexec.removeURLParameter=function(url,parameter)
{var urlparts=url.split('?');if(urlparts.length>=2)
{var urlBase=urlparts.shift();var queryString=urlparts.join("?");var prefix=encodeURIComponent(parameter)+'=';var pars=queryString.split(/[&;]/g);for(var i=pars.length;i-->0;)
if(pars[i].lastIndexOf(prefix,0)!==-1)
pars.splice(i,1);url=urlBase+'?'+pars.join('&');}
return url;}
clientexec.notifybrowser=function(title,msg,timeout){if(!timeout)timeout=3500;if(!window.webkitNotifications){return;}
var havePermission=window.webkitNotifications.checkPermission();if(havePermission===0){var notification=window.webkitNotifications.createNotification('',"(ce) "+title,msg);notification.onclick=function(){notification.close();};notification.show();if(timeout>0){setTimeout(function(){notification.cancel();},timeout);}}else{window.webkitNotifications.requestPermission();}};clientexec.updateCustomField=function(customfieldname,newvalue,staffid,callback)
{if(typeof(staffid)=="undefined")staffid=clientexec.admin_id;if(typeof(callback)=="undefined")callback=function(){};$.ajax({url:"index.php?fuse=clients&controller=customfields&action=save",type:'POST',data:{newvalue:newvalue,staffid:staffid,customfieldname:customfieldname},success:function(response){callback(response);}});};clientexec.updateticketfiltercounts=function(response){var menu_item;var waiting_tickets_count=0;var sidebar=$('#ticketfilters').length>0;if(response.filters.length>0){if(sidebar){$('#ticketfilters ul').empty();$('#ticketfilters #addTicketFilter').show();}
$.each(response.filters,function(i,obj){menu_item=$('.nav_support a[data-filter-id="'+obj.ticketfilter_id+'"]');if($(menu_item).find('.menu-counter').length==0){$(menu_item).prepend($('<span class="menu-counter label label-inverse">'));}
if(obj.ticketfilter_count==0){$(menu_item).find('.menu-counter').removeClass('label-important').addClass('label-inverse').text(obj.ticketfilter_count);}else{$(menu_item).find('.menu-counter').addClass('label-important').removeClass('label-inverse').text(obj.ticketfilter_count);}
if(obj.ticketfilter_id==clientexec.favorite_filter){waiting_tickets_count=obj.ticketfilter_count;}
if(sidebar&&menu_item.length>0){$('#ticketfilters ul').append('<li><span class="menu-counter label label-inverse">'+
obj.ticketfilter_count+'</span>\n<a href="index.php?fuse=support&view=viewtickets&controller=ticket&searchfilter='+
ce.htmlspecialchars(obj.ticketfilter_id)+'">'+
ce.htmlspecialchars(obj.ticketfilter_name)+'</a></li>');}});if(sidebar){ticketfilters.plugin.setContent();}}
if(waiting_tickets_count==0){$('.nav_support .topmenu-count-label').removeClass('label-important').addClass('label-inverse').text('');$('.nav_support > a').attr('href','#');}else if($('.nav_support .topmenu-count-label').length==0){var count=$('<span>').addClass('topmenu-count-label label label-important').text(waiting_tickets_count);$('.nav_support').append(count);$('.nav_support .topmenu-count-label').addClass('label-important').removeClass('label-inverse');if(!ce.isMobile()){$('.nav_support > a').attr('href','index.php?fuse=support&view=viewtickets&controller=ticket&searchfilter='+clientexec.favorite_filter);}}else{$('.nav_support .topmenu-count-label').text(waiting_tickets_count);$('.nav_support .topmenu-count-label').addClass('label-important').removeClass('label-inverse');if(!ce.isMobile()){$('.nav_support > a').attr('href','index.php?fuse=support&view=viewtickets&controller=ticket&searchfilter='+clientexec.favorite_filter);}}};clientexec.checkifuserisonline=function(id)
{var found=false;if(!clientexec.whoisonline.onlineusers)return found;for(var j=0;j<clientexec.whoisonline.onlineusers.length;j++)
{if(clientexec.whoisonline.onlineusers[j].id==id)found=true;}
return found;};clientexec.updateonlineusers=function(response)
{if(!response.users)return;var showAlerts;if(clientexec.whoisonline.userCount>0){showAlerts=true;}else{showAlerts=false;}
if(clientexec.whoisonline.userCount!=response.count){clientexec.whoisonline.userCount=response.count;}
$.each(response.users,function(index,objValue){if((showAlerts)&&(objValue.type=="staff")&&(!clientexec.checkifuserisonline(objValue.id))&&(objValue.id!=clientexec.admin_id)){}else if(objValue.id==clientexec.admin_id){clientexec.whoisonline.me=objValue;}
if(objValue.type=="staff"){clientexec.show_staff(objValue);}});clientexec.whoisonline.onlineusers=response.users;clientexec.remove_staff(response.users);if(typeof(response.offlineusers)!="undefined"){clientexec.whoisonline.offlineusers=response.offlineusers;}}
clientexec.remove_staff=function(){var email;$('.leftbar-staff-list img').each(function(i,o){email=$(o).attr('data-email');if(!clientexec.is_online(email)){$('.leftbar-staff-list [data-email="'+email+'"]').remove();}});}
clientexec.is_online=function(useremail){var returnval=false;$.each(clientexec.whoisonline.onlineusers,function(i,o){if(o.email==useremail){returnval=true;}})
return returnval;}
clientexec.show_staff=function(user){if(user.id==clientexec.admin_id)return;if($('.leftbar-staff-list [data-email="'+user.email+'"]').length==0){$('.leftbar-staff-list').append('<img class="staff-image" data-email="'+user.email+'" src="'+ce.getAvatarUrl(user.email,80,user.name)+'" />');}else{}}
$(window).resize(function(){if($(window).height()<500){$('.leftbar-staff-list').slideUp();}else{$('.leftbar-staff-list').slideDown();}});clientexec.updatevitals=function(needyourattention){var pending_users_num=0;var ouststanding_invoices_count=0;var pending_items_total=0;if(needyourattention.length>0){$.each(needyourattention,function(i,obj){if(obj['menu-class']=="menu-pending-orders"){pending_users_num=obj['count-raw'];}else if(obj['menu-class']=="menu-invoices-ready"&&clientexec.settings.billing.showReadyInvoiceCount){ouststanding_invoices_count=parseInt(ouststanding_invoices_count)+parseInt(obj['count-raw']);}else if(obj['menu-class']=="menu-cc-invoices-ready"&&clientexec.settings.billing.showReadyCCInvoiceCount){ouststanding_invoices_count=parseInt(ouststanding_invoices_count)+parseInt(obj['count-raw']);}else if(obj['menu-class']=="menu-cc-invoices-failed"&&clientexec.settings.billing.showFailedCCCount){ouststanding_invoices_count=parseInt(ouststanding_invoices_count)+parseInt(obj['count-raw']);}
if($('.'+obj['menu-class']+' .menu-counter').length==0){$('.'+obj['menu-class']).prepend($('<span class="menu-counter label label-inverse">'))}
$('.'+obj['menu-class']).attr('href',obj['link']);if(obj['count']==0){$('.'+obj['menu-class']+' .menu-counter').removeClass('label-important').addClass('label-inverse').text(obj['count']);}else{pending_items_total++;$('.'+obj['menu-class']+' .menu-counter').addClass('label-important').removeClass('label-inverse').text(obj['count']);}});}
if(ouststanding_invoices_count==0){$('.nav_billing .topmenu-count-label').removeClass('label-important').addClass('label-inverse');$('.nav_billing .topmenu-count-label').text(ouststanding_invoices_count);}else if($('.nav_billing .topmenu-count-label').length==0){new_el=$('<span>').addClass('topmenu-count-label label label-important').text(ouststanding_invoices_count);$('.nav_billing').append(new_el);}else{$('.nav_billing .topmenu-count-label').removeClass('label-inverse').addClass('label-important').text(ouststanding_invoices_count);}
if(pending_items_total==0){$('.nav_dashboard .topmenu-count-label').removeClass('label-important').addClass('label-inverse');}else if($('.nav_dashboard .topmenu-count-label').length==0){new_el=$('<span>').addClass('topmenu-count-label label label-important').text(pending_items_total);$('.nav_dashboard').append(new_el);}else{$('.nav_dashboard .topmenu-count-label').removeClass('label-inverse').addClass('label-important').text(pending_items_total);}};clientexec.updateEvents=function(newEvents){var newEventCount=newEvents.length;var new_el=null;var firsttime=false;if(clientexec.last_event_id==0){firsttime=true;}
if(newEventCount>0){newEvents.sort(function(a,b){if(a.eventid<b.eventid)return-1;if(a.eventid>b.eventid)return 1;return 0;});for(var x=0;x<newEventCount;x++){if((newEvents[x].userid!=clientexec.admin_id)&&(newEvents[x].eventid>clientexec.last_event_id)){var text=ce.htmlspecialchars(newEvents[x].subject);if(newEvents[x].tpl&&newEvents[x].tpl=='link'){text=text.replace(/\[link\]/,newEvents[x].link);}
if(!firsttime)clientexec.addNewEvent(text,ce.htmlspecialchars(newEvents[x].fullName),newEvents[x].email,newEvents[x].date);clientexec.last_event_id=newEvents[x].eventid;}}}}
function createNewFilter()
{$('.ce-top-menu li .drop').addClass('hide-drop');setTimeout(function(){$('.ce-top-menu li .drop').removeClass('hide-drop')},500);customfilterwin=new RichHTML.window({url:'index.php?fuse=support&controller=ticketfilter&view=viewadd',actionUrl:'index.php?fuse=support&action=create&controller=ticketfilter',title:clientexec.lang('Ticket Search'),width:'800',height:'300',showSubmit:true,onSubmit:function(response){var filterName='custom_'+response.filterID;if(response.error==false){window.location.href="index.php?fuse=support&view=viewtickets&controller=ticket&searchfilter="+filterName;}}});customfilterwin.show();}
function moveGuestToCustomer()
{RichHTML.msgBox(clientexec.lang("NOTE: This operation will move all the tickets from this Email to the user whose ID you will enter.\nAlso, this Email will be added as an alternate address for future support requests from this user."),{type:'yesno'},function(response){if(response.btn==clientexec.lang("Yes")){RichHTML.prompt(clientexec.lang("Migrate Guest to User ID:"),{},function(response){if(response.btn==clientexec.lang("OK")){RichHTML.mask();new_user_id=response.elements.value;$.post("index.php?fuse=clients&action=setowner&controller=userprofile",{userId:new_user_id},function(response){json=ce.parseResponse(response);if(!json.error){window.location.href="index.php?fuse=clients&controller=userprofile&view=profilecontact&frmClientID="+new_user_id;}else{RichHTML.unMask();}})}});}});}
ce.myNotes=function(){myNotesWindow=new RichHTML.window({height:'315',url:'index.php?fuse=admin&view=mynotes',actionUrl:'index.php?fuse=admin&action=savenote',showSubmit:true,title:clientexec.lang("My Notes"),onSubmit:function(response){ce.parseResponse(response);}});myNotesWindow.show();}
profilenotes={};ce.addNote=function(noteId){if(profilenotes.grid==='undefined'){profilenotes.grid=null}
if(typeof noteId==='undefined'){noteId=0;}
profilenotes.window=new RichHTML.window({height:'315',url:'index.php?fuse=clients&controller=notes&view=addnotes'+'&id='+noteId,actionUrl:'index.php?fuse=clients&action=save&controller=notes'+'&id='+noteId,grid:profilenotes.grid,showSubmit:true,title:clientexec.lang("Add Staff Note"),onSubmit:function(){if(typeof profile!=='undefined'){setTimeout(function(){profile.get_counts();},1000);}}});profilenotes.window.show();};supportticket={};supportticket.ticketId=0;ce.addSupportTicket=function(a1,a2){supportticket.window=new RichHTML.window({height:'425',width:'500',url:'index.php?fuse=support&controller=ticket&view=viewaddticket',actionUrl:'index.php?fuse=support&action=saveticket&controller=ticket&ignore=1',showSubmit:true,title:clientexec.lang("Add Support Ticket"),beforeSubmit:function(){if($("#supportticket-tickettype").select2("val")===''){var err=clientexec.lang("You must fill in all the required fields before submitting your ticket.");RichHTML.error(err);return false;}
var formSelector=supportticket.window.form;var fileBlobs=[];var fileInputs=$("#file-upload-field");for(var i=0;i<fileInputs.length;i++){if($("#file-upload-field").get(i).value){fileBlobs.push($("#file-upload-field").get(i).files[0]);}}
if(fileBlobs.length==0){supportticket.window.options.actionUrl='index.php?fuse=support&action=saveticket&controller=ticket';}else{var url='index.php?fuse=support&action=saveticket&controller=ticket';var data=$(formSelector).serializeArray();$(formSelector).fileupload({url:url});$(formSelector).fileupload('send',{files:fileBlobs,formData:data}).success(function(res){if(res.success===true){supportticket.ticketId=res.ticketId;window.location='index.php?fuse=support&id='+supportticket.ticketId+'&view=viewtickets&controller=ticket';}}).fail(function(res){var err=clientexec.lang("There was an error with this operation");try{var json=$.parseJSON(res.responseText);err=json.message;}catch(ex){var matches=/"message":"(.*)"/.exec(res.responseText);if(matches&&matches[1]){err=matches[1];}}
RichHTML.error(err);});}},onSubmit:function(response){if(response.success===true){if(typeof response.ticketId!=='undefined'){supportticket.ticketId=response.ticketId;}
if(supportticket.ticketId!=0){window.location='index.php?fuse=support&id='+supportticket.ticketId+'&view=viewtickets&controller=ticket';}}}});supportticket.window.show();};emailcustomer={};ce.addEmailCustomer=function(){emailcustomer.window=new RichHTML.window({height:'400',width:'500',url:'index.php?fuse=clients&controller=email&view=viewaddemail',actionUrl:'index.php?fuse=clients&controller=email&action=sendemail',showSubmit:true,title:clientexec.lang("Email Client"),onSubmit:function(xhr){if(xhr.error){ce.errormsg("There was an error sending the email: "+xhr.message);}else{ce.msg("email has been sent");}}});emailcustomer.window.show();};function togglePackageListType(types){typesArray=types.split('_');type=typesArray[0];groupId='';if(typesArray[1]!==undefined){groupId='&groupid='+typesArray[1];}
if(type=='domain'){window.location='index.php?fuse=clients&controller=packages&view=domainslist'+groupId;}else if(type=='hosting'){window.location='index.php?fuse=clients&controller=packages&view=hostingpackagelist'+groupId;}else if(type=='general'){window.location='index.php?fuse=clients&controller=packages&view=generalpackageslist'+groupId;}else if(type=='ssl'){window.location='index.php?fuse=clients&controller=packages&view=sslpackagelist'+groupId;}}
ce.htmlentities=function(html){return $('<div/>').text(html).html();};ce.unhtmlentities=function(text){return $('<div/>').html(text).text();};Date.prototype.format=function(format){var returnStr='';var replace=Date.replaceChars;for(var i=0;i<format.length;i++){var curChar=format.charAt(i);if(i-1>=0&&format.charAt(i-1)=="\\"){returnStr+=curChar;}else if(replace[curChar]){returnStr+=replace[curChar].call(this);}else if(curChar!="\\"){returnStr+=curChar;}}
return returnStr;};Date.replaceChars={shortMonths:[clientexec.lang('Jan'),clientexec.lang('Feb'),clientexec.lang('Mar'),clientexec.lang('Apr'),clientexec.lang('May'),clientexec.lang('Jun'),clientexec.lang('Jul'),clientexec.lang('Aug'),clientexec.lang('Sep'),clientexec.lang('Oct'),clientexec.lang('Nov'),clientexec.lang('Dec')],longMonths:[clientexec.lang('January'),clientexec.lang('February'),clientexec.lang('March'),clientexec.lang('April'),clientexec.lang('May'),clientexec.lang('June'),clientexec.lang('July'),clientexec.lang('August'),clientexec.lang('September'),clientexec.lang('October'),clientexec.lang('November'),clientexec.lang('December')],shortDays:[clientexec.lang('Sun'),clientexec.lang('Mon'),clientexec.lang('Tue'),clientexec.lang('Wed'),clientexec.lang('Thu'),clientexec.lang('Fri'),clientexec.lang('Sat')],longDays:[clientexec.lang('Sunday'),clientexec.lang('Monday'),clientexec.lang('Tuesday'),clientexec.lang('Wednesday'),clientexec.lang('Thursday'),clientexec.lang('Friday'),clientexec.lang('Saturday')],d:function(){return(this.getDate()<10?'0':'')+this.getDate();},D:function(){return Date.replaceChars.shortDays[this.getDay()];},j:function(){return this.getDate();},l:function(){return Date.replaceChars.longDays[this.getDay()];},N:function(){return this.getDay()+1;},S:function(){return(this.getDate()%10==1&&this.getDate()!=11?'st':(this.getDate()%10==2&&this.getDate()!=12?'nd':(this.getDate()%10==3&&this.getDate()!=13?'rd':'th')));},w:function(){return this.getDay();},z:function(){var d=new Date(this.getFullYear(),0,1);return Math.ceil((this-d)/86400000);},W:function(){var d=new Date(this.getFullYear(),0,1);return Math.ceil((((this-d)/86400000)+d.getDay()+1)/7);},F:function(){return Date.replaceChars.longMonths[this.getMonth()];},m:function(){return(this.getMonth()<9?'0':'')+(this.getMonth()+1);},M:function(){return Date.replaceChars.shortMonths[this.getMonth()];},n:function(){return this.getMonth()+1;},t:function(){var d=new Date();return new Date(d.getFullYear(),d.getMonth(),0).getDate()},L:function(){var year=this.getFullYear();return(year%400==0||(year%100!=0&&year%4==0));},o:function(){var d=new Date(this.valueOf());d.setDate(d.getDate()-((this.getDay()+6)%7)+3);return d.getFullYear();},Y:function(){return this.getFullYear();},y:function(){return(''+this.getFullYear()).substr(2);},a:function(){return this.getHours()<12?'am':'pm';},A:function(){return this.getHours()<12?'AM':'PM';},B:function(){return Math.floor((((this.getUTCHours()+1)%24)+this.getUTCMinutes()/60+this.getUTCSeconds()/3600)*1000/24);},g:function(){return this.getHours()%12||12;},G:function(){return this.getHours();},h:function(){return((this.getHours()%12||12)<10?'0':'')+(this.getHours()%12||12);},H:function(){return(this.getHours()<10?'0':'')+this.getHours();},i:function(){return(this.getMinutes()<10?'0':'')+this.getMinutes();},s:function(){return(this.getSeconds()<10?'0':'')+this.getSeconds();},u:function(){var m=this.getMilliseconds();return(m<10?'00':(m<100?'0':''))+m;},e:function(){return"Not Yet Supported";},I:function(){return"Not Yet Supported";},O:function(){return(-this.getTimezoneOffset()<0?'-':'+')+(Math.abs(this.getTimezoneOffset()/60)<10?'0':'')+(Math.abs(this.getTimezoneOffset()/60))+'00';},P:function(){return(-this.getTimezoneOffset()<0?'-':'+')+(Math.abs(this.getTimezoneOffset()/60)<10?'0':'')+(Math.abs(this.getTimezoneOffset()/60))+':00';},T:function(){var m=this.getMonth();this.setMonth(0);var result=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,'$1');this.setMonth(m);return result;},Z:function(){return-this.getTimezoneOffset()*60;},c:function(){return this.format("Y-m-d\\TH:i:sP");},r:function(){return this.toString();},U:function(){return this.getTime()/1000;}};if(!Array.prototype.indexOfObject){Array.prototype.indexOfObject=function(searchElement){"use strict";if(this==null){throw new TypeError();}
var t=Object(this);var len=t.length>>>0;if(len===0){return-1;}
var n=0;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0;}else if(n!=0&&n!=Infinity&&n!=-Infinity){n=(n>0||-1)*Math.floor(Math.abs(n));}}
if(n>=len){return-1;}
var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++){if(compareObj(searchElement,t[k])!==-1){return k;}}
return-1;function compareObj(needle,haystack){for(var key in needle){if(!haystack.hasOwnProperty(key)){return-1;}else if(typeof(haystack[key])!==typeof(needle[key])){return-1;}else{if(typeof(needle[key])=='object'){if(!compareObj(needle[key],haystack[key])){return false;}}else{if(haystack[key]!==needle[key]){return-1;}}}}
return 1;}};};(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler("remove");}catch(e){}}
_cleanData(elems);};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init();}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}
return this;},enable:function(){return this._setOption("disabled",false);},disable:function(){return this._setOption("disabled",true);},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName);},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});}));;(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','jquery.ui.widget'],factory);}else{factory(window.jQuery);}}(function($){'use strict';$.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.widget('blueimp.fileupload',{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,formData:function(form){return form.serializeArray();},add:function(e,data){if(data.autoUpload||(data.autoUpload!==false&&($(this).data('blueimp-fileupload')||$(this).data('fileupload')).options.autoUpload)){data.submit();}},processData:false,contentType:false,cache:false},_refreshOptionsList:['fileInput','dropZone','pasteZone','multipart','forceIframeTransport'],_BitrateTimer:function(){this.timestamp=+(new Date());this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1000/timeDiff)*8;this.loaded=loaded;this.timestamp=now;}
return this.bitrate;};},_isXHRUpload:function(options){return!options.forceIframeTransport&&((!options.multipart&&$.support.xhrFileUpload)||$.support.xhrFormDataFileUpload);},_getFormData:function(options){var formData;if(typeof options.formData==='function'){return options.formData(options.form);}
if($.isArray(options.formData)){return options.formData;}
if(options.formData){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value});});return formData;}
return[];},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1;});return total;},_initProgressObject:function(obj){obj._progress={loaded:0,total:0,bitrate:0};},_onProgress:function(e,data){if(e.lengthComputable){var now=+(new Date()),loaded;if(data._time&&data.progressInterval&&(now-data._time<data.progressInterval)&&e.loaded!==e.total){return;}
data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=(loaded-data._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger('progress',e,data);this._trigger('progressall',e,this._progress);}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind('progress',function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options);});options.xhr=function(){return xhr;};}},_initXHRData:function(options){var formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=options.paramName[0];options.headers=options.headers||{};if(options.contentRange){options.headers['Content-Range']=options.contentRange;}
if(!multipart){options.headers['Content-Disposition']='attachment; filename="'+
encodeURI(file.name)+'"';options.contentType=file.type;options.data=options.blob||file;}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob});}else{$.each(options.files,function(index,file){formData.push({name:options.paramName[index]||paramName,value:file});});}}else{if(options.formData instanceof FormData){formData=options.formData;}else{formData=new FormData();$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value);});}
if(options.blob){options.headers['Content-Disposition']='attachment; filename="'+
encodeURI(file.name)+'"';formData.append(paramName,options.blob,file.name);}else{$.each(options.files,function(index,file){if((window.Blob&&file instanceof Blob)||(window.File&&file instanceof File)){formData.append(options.paramName[index]||paramName,file,file.name);}});}}
options.data=formData;}
options.blob=null;},_initIframeSettings:function(options){options.dataType='iframe '+(options.dataType||'');options.formData=this._getFormData(options);if(options.redirect&&$('<a></a>').prop('href',options.url).prop('host')!==location.host){options.formData.push({name:options.redirectParamName||'redirect',value:options.redirect});}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options);}
this._initProgressListener(options);}
if(options.postMessage){options.dataType='postmessage '+(options.dataType||'');}}else{this._initIframeSettings(options,'iframe');}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop('name')||'files[]',i=(input.prop('files')||[1]).length;while(i){paramName.push(name);i-=1;}});if(!paramName.length){paramName=[fileInput.prop('name')||'files[]'];}}else if(!$.isArray(paramName)){paramName=[paramName];}
return paramName;},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop('form'));if(!options.form.length){options.form=$(this.options.fileInput.prop('form'));}}
options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop('action')||location.href;}
options.type=(options.type||options.form.prop('method')||'').toUpperCase();if(options.type!=='POST'&&options.type!=='PUT'&&options.type!=='PATCH'){options.type='POST';}
if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr('accept-charset');}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options;},_getDeferredState:function(deferred){if(deferred.state){return deferred.state();}
if(deferred.isResolved()){return'resolved';}
if(deferred.isRejected()){return'rejected';}
return'pending';},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise;},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args);}else if(resolveOrReject===false){dfd.rejectWith(context,args);}
promise.abort=dfd.promise;return this._enhancePromise(promise);},_addConvenienceMethods:function(e,data){var that=this;data.submit=function(){if(this.state()!=='pending'){data.jqXHR=this.jqXHR=(that._trigger('submit',e,this)!==false)&&that._onSend(e,this);}
return this.jqXHR||that._getXHRPromise();};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort();}
return this._getXHRPromise();};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR);}};data.progress=function(){return this._progress;};},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader('Range'),parts=range&&range.split('-'),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1;},_chunkedUpload:function(options,testOnly){var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes=options.uploadedBytes||0,mcs=options.maxChunkSize||fs,slice=file.slice||file.webkitSlice||file.mozSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false;}
if(testOnly){return true;}
if(ub>=fs){file.error='Uploaded bytes exceed file size';return this._getXHRPromise(false,options.context,[null,'error',file.error]);}
upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange='bytes '+ub+'-'+
(ub+o.chunkSize-1)+'/'+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=((that._trigger('chunksend',null,o)!==false&&$.ajax(o))||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||(ub+o.chunkSize);if(o._progress.loaded===currentLoaded){that._onProgress($.Event('progress',{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o);}
options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger('chunkdone',null,o);that._trigger('chunkalways',null,o);if(ub<fs){upload();}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR]);}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger('chunkfail',null,o);that._trigger('chunkalways',null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown]);});};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort();};upload();return promise;},_beforeSend:function(e,data){if(this._active===0){this._trigger('start');this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0;}
if(!data._progress){data._progress={};}
data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total;},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total;if(options._progress.loaded<total){this._onProgress($.Event('progress',{lengthComputable:true,loaded:total,total:total}),options);}
options.result=result;options.textStatus=textStatus;options.jqXHR=jqXHR;this._trigger('done',null,options);},_onFail:function(jqXHR,textStatus,errorThrown,options){options.jqXHR=jqXHR;options.textStatus=textStatus;options.errorThrown=errorThrown;this._trigger('fail',null,options);if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total;}},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._active-=1;this._trigger('always',null,options);if(this._active===0){this._trigger('stop');}},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data);}
var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer();jqXHR=jqXHR||(((aborted||that._trigger('send',e,options)===false)&&that._getXHRPromise(false,options.context,aborted))||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options);}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options);}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._sending-=1;that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)==='pending'){nextSlot.resolve();break;}
nextSlot=that._slots.shift();}}});return jqXHR;};this._beforeSend(e,options);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send);}else{pipe=(this._sequence=this._sequence.pipe(send,send));}
pipe.abort=function(){aborted=[undefined,'abort','abort'];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted);}
return send();}
return jqXHR.abort();};return this._enhancePromise(pipe);}
return send();},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),limit=options.limitMultiFileUploads,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i;if(!(options.singleFileUploads||limit)||!this._isXHRUpload(options)){fileSet=[data.files];paramNameSet=[paramName];}else if(!options.singleFileUploads&&limit){fileSet=[];paramNameSet=[];for(i=0;i<data.files.length;i+=limit){fileSet.push(data.files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);}}else{paramNameSet=paramName;}
data.originalFiles=data.files;$.each(fileSet||data.files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger('add',e,newData);return result;});return result;},_replaceFileInput:function(input){var inputClone=input.clone(true);$('<form></form>').append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind('remove'));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0];}
return el;});if(input[0]===this.element[0]){this.element=inputClone;}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry;}
dfd.resolve([e]);},dirReader;path=path||'';if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file);}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file);},errorHandler);}}else if(entry.isDirectory){dirReader=entry.createReader();dirReader.readEntries(function(entries){that._handleFileTreeEntries(entries,path+entry.name+'/').done(function(files){dfd.resolve(files);}).fail(errorHandler);},errorHandler);}else{dfd.resolve([]);}
return dfd.promise();},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path);})).pipe(function(){return Array.prototype.concat.apply([],arguments);});},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile();}
return entry;}
return item.getAsEntry();}));}
return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise();},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop('webkitEntries')||fileInput.prop('entries'),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries);}
files=$.makeArray(fileInput.prop('files'));if(!files.length){value=fileInput.prop('value');if(!value){return $.Deferred().resolve([]).promise();}
files=[{name:value.replace(/^.*\\/,'')}];}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize;});}
return $.Deferred().resolve(files).promise();},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput);}
return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments);});},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput);}
if(that._trigger('change',e,data)!==false){that._onAdd(e,data);}});},_onPaste:function(e){var cbd=e.originalEvent.clipboardData,items=(cbd&&cbd.items)||[],data={files:[]};$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file);}});if(this._trigger('paste',e,data)===false||this._onAdd(e,data)===false){return false;}},_onDrop:function(e){var that=this,dataTransfer=e.dataTransfer=e.originalEvent.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();}
this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger('drop',e,data)!==false){that._onAdd(e,data);}});},_onDragOver:function(e){var dataTransfer=e.dataTransfer=e.originalEvent.dataTransfer;if(this._trigger('dragover',e)===false){return false;}
if(dataTransfer&&$.inArray('Files',dataTransfer.types)!==-1){dataTransfer.dropEffect='copy';e.preventDefault();}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste});}
this._on(this.options.fileInput,{change:this._onChange});},_destroyEventHandlers:function(){this._off(this.options.dropZone,'dragover drop');this._off(this.options.pasteZone,'paste');this._off(this.options.fileInput,'change');},_setOption:function(key,value){var refresh=$.inArray(key,this._refreshOptionsList)!==-1;if(refresh){this._destroyEventHandlers();}
this._super(key,value);if(refresh){this._initSpecialOptions();this._initEventHandlers();}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]');}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput);}
if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone);}
if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone);}},_create:function(){var options=this.options;$.extend(options,$(this.element[0].cloneNode(false)).data());this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers();},progress:function(){return this._progress;},add:function(data){var that=this;if(!data||this.options.disabled){return;}
if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data);});}else{data.files=$.makeArray(data.files);this._onAdd(null,data);}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort();}
dfd.reject(null,'abort','abort');return promise;};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return;}
data.files=files;jqXHR=that._onSend(null,data).then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR);},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown);});});return this._enhancePromise(promise);}
data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data);}}
return this._getXHRPromise(false,data&&data.context);}});}));;var PluginMgr=function(args){this.options=args;this.active_panel="";this.caches=[];};PluginMgr.prototype.addSystemListener=function(plugin,event,method)
{};PluginMgr.prototype.leftbarpluginsCache="";PluginMgr.prototype.pluginsContentCache={};PluginMgr.prototype.setCount=function(plugin,count,style)
{if(!style)style="badge-important";$('.leftmenu-icon[name="plugin-'+plugin+'"]:not(".leftmenu-more-icon") .leftmenu-icon-count').attr('class','').addClass('badge').addClass('leftmenu-icon-count').addClass(style).html(count).addClass('visible');var leftbarplugins=$.trim($('.lefmenu-plugin-icons').html());if(leftbarplugins!=this.leftbarpluginsCache){this.leftbarpluginsCache=leftbarplugins;$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:{leftbarplugins:leftbarplugins}}});}};PluginMgr.prototype.setContent=function(plugin,content,skipcaching)
{if(typeof(skipcaching)==="undefined")skipcaching=false;content=this.setCache(plugin,content);if(this.active_panel=="plugin-"+plugin){$('.plugincontainer').attr('data-plugin',"plugin-"+plugin);if(!skipcaching){$('div#plugin-notsystemplugin').html(content);clientexec.bindLinksIfLeavingInvoiceViewIsPrevented();}
var pluginContent=$('div.pluginframe').html();if(!this.pluginsContentCache[plugin]||this.pluginsContentCache[plugin]!=pluginContent){this.pluginsContentCache[plugin]=pluginContent;$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:{plugincontent:pluginContent,plugincontent_plugin:plugin}}});}}
return content;};PluginMgr.prototype.setCache=function(plugin,content)
{if(typeof(content)==="undefined"){content=$('div#plugin-notsystemplugin').html();}
this.caches[plugin]=content;return content;};PluginMgr.prototype.getCache=function(plugin)
{var self=this;var content=null;if((typeof(this.caches[plugin])!=="undefined")&&(this.caches[plugin]!==null)){content=this.caches[plugin];if(this.active_panel=="plugin-"+plugin){$('div#plugin-notsystemplugin.plugincontainer').html(content);$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:{plugincontent:$('div.pluginframe').html(),plugincontent_plugin:plugin}}});}}
return content;};PluginMgr.prototype.process=function(args){var self=this;var active_panel=this.active_panel;var loading_img="<img class='content-loading' src='../images/loader.gif' />";var url="";var showtoolbar=false;var hadCachedData=false;var canCache=true;var plugin_el=$('div#plugin-notsystemplugin.plugincontainer');var params={data:null,options:null};params=$.extend(params,args);var plugin=$('.leftmenu-icon[name="plugin-'+params.plugin+'"]');if(canCache&&(self.getCache(params.plugin)!==null)){hadCachedData=true;}else if(params.data===null){plugin_el.html(loading_img);}else{hadCachedData=true;}
this.options.label="";if(clientexec.pluginData.plugin!=params.plugin){$.post('index.php?fuse=admin&controller=sidebar&action=setactivesidebarplugin&plugin='+params.plugin);clientexec.pluginData.plugin=params.plugin;}
if((!canCache)||((params.data===null)&&(!hadCachedData))){self.reloadpluginpanel(params.plugin);}else if(plugin.data('activeMethod')){eval(plugin.data('activeMethod')+'()');}};PluginMgr.prototype.reloadpluginpanel=function(pluginname){var plugin_el=$('div#plugin-notsystemplugin.plugincontainer');var plugin=$('.leftmenu-icon[name="plugin-'+pluginname+'"]');plugin_el.load('index.php?nolog=1&fuse=home&view=viewdashboardplugin&plugin='+pluginname,function(){if(plugin.data('activeMethod')){eval(plugin.data('activeMethod')+'()');}
clientexec.bindLinksIfLeavingInvoiceViewIsPrevented();});};PluginMgr.prototype.startAutoPlugins=function()
{var newplugin,obj,el,leftname,moreplugins="",maxplugins=5;for(k=0;k<clientexec.sidebarplugins.plugins.length;k++){obj=clientexec.sidebarplugins.plugins[k];pluginname='plugin-'+obj.plugin;el=$('.leftmenu-icon[name="'+pluginname+'"]');if(el.length>0){el.data('activeMethod',obj.activeMethod);el.data('cache',obj.cache);continue;}
if(!obj.sidebar){continue;}
newplugin=$('.leftmenu-icon[name="cloneme"]').clone();newplugin.attr('name',pluginname);newplugin.attr('title',obj.title);newplugin.attr('data-toggle',"tooltip");newplugin.attr('data-placement',"right");newplugin.attr('data-header-name',obj.title);if(obj.smalltitle){leftname=obj.smalltitle;}else{leftname=obj.title.substring(0,10);}
newplugin.find('.plugin-icon-name').text(leftname);newplugin.data('activeMethod',obj.activeMethod);newplugin.data('cache',obj.cache);newplugin.addClass(obj.icon);newplugin.css('display','block');if($('.leftmenuplugin').length>maxplugins){$('.lefmenu-plugin-icons').append($('<div class="leftmenuplugin" style="display:none;"></div>').append(newplugin));newplugin.attr('data-placement',"top");moreplugins+="<div class='leftmenu-moreplugins'>"+$(newplugin)[0].outerHTML+"</div>";}else if(obj.order===0){$('.lefmenu-plugin-icons').prepend($('<div class="leftmenuplugin"></div>').append(newplugin));}else{$('.plugin-moreplugins').before($('<div class="leftmenuplugin"></div>').append(newplugin));}}
if(moreplugins!==""&&$('.leftmenuplugin').length>maxplugins){$('.plugin-moreplugins').show();$('.plugin-moreplugins .popover').remove();$('.plugin-moreplugins i').attr('data-content',moreplugins);$('.plugin-moreplugins i').popover();$('.plugin-moreplugins .plugin-moreplugins-count').text(clientexec.sidebarplugins.plugins.length-maxplugins);$('.plugin-moreplugins .plugin-moreplugins-count').show();}else if($('.leftmenuplugin').length>maxplugins){$('.plugin-moreplugins .popover').remove();$('.plugin-moreplugins i').popover();}
setTimeout(function(){$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:{leftbarplugins:$.trim($('.lefmenu-plugin-icons').html())}}});},2500);};PluginMgr.prototype.setActivePlugin=function(jobj){pluginname=jobj.attr('name').toString().split("-");this.active_panel='plugin-'+pluginname[1];$('div.pluginframe-header span.pluginframe-plugin-name').text(jobj.attr('data-header-name'));$('.plugincontainer').hide();if($('div#plugin-'+pluginname[1]+'.plugincontainer').length>0){$('div#plugin-'+pluginname[1]+'.plugincontainer').show();}else{$('div#plugin-notsystemplugin.plugincontainer').show();}
$('.leftmenu-icon-active').removeClass('leftmenu-icon-active');$('#selected-leftmenu-icon-tick').remove();jobj.prepend($('<div id="selected-leftmenu-icon-tick" aria-hidden="true" data-icon="&#xe001;"></div>'));$('div.pluginframe').show();$('div.pluginframe-header').show();$('body').addClass('withpluginpanel');jobj.addClass('leftmenu-icon-active');$(window).trigger('resize');if(clientexec.myChart)clientexec.myChart._resize();};PluginMgr.prototype.getPluginConfigOptions=function(plugin){var self=this;$.ajax({url:'index.php?fuse=home&action=pluginhassettings&type=dashboard&plugin='+plugin,dataType:'json',success:function(xhr){var json=ce.parseResponse(xhr);if(json.error)return;if(json.configurable){var el=$('#enabledplugin_'+plugin+' div.accordion-inner');el.append("<br/><br/><img class='content-loading' src='../images/loader.gif' />");$.ajax({url:'index.php?fuse=home&action=pluginoptions&type=dashboard&plugin='+plugin,dataType:'json',success:function(xhr){var desc=el.find('span.description').html();el.html('<span class="description">'+desc+'</span><br/><br/>');$.each(xhr.data.vars,function(a,b){el.append('<span style="margin-bottom:5px;" class="label label-info">'+a+'</span> <input name="'+a+'" class="pluginvalue" style="display:block;width:95%;" type="text" value="'+b+'" /><br/>');});el.append('<button class="submitpluginsettings btn btn-primary" data-complete-text="Saved!" data-loading-text="Updating..." style="float:right;margin-right:10px;" type="button">Update</button><br/><br/>');$('button.submitpluginsettings').unbind('click');$('button.submitpluginsettings').bind('click',function(e){$('button.submitpluginsettings').button('loading');self.savePluginConfigOptions(plugin);});}});}}});};PluginMgr.prototype.savePluginConfigOptions=function(plugin){var el=$('#enabledplugin_'+plugin+' div.accordion-inner');var data={};data['pluginfields']={};$.each(el.find(':input.pluginvalue'),function(e,b){data['pluginfields'][$(b).attr('name')]=$(b).val();});$.ajax({url:'index.php?fuse=home&action=savepluginoptions&type=dashboard&plugin='+plugin,dataType:'json',data:data,success:function(xhr){$('button.submitpluginsettings').button('complete');}});};clientexec.disablePlugin=function(plugin,shared)
{clientexec.customizePlugins.mask();$.ajax({url:'index.php?fuse=home&action=savedashboardstate&task=close&plugin='+plugin+'&shared='+shared,success:function(xhr){clientexec.customizePlugins.addParams({shownotice:1});clientexec.customizePlugins.reload();$('.dashboardchanges').show();}});};clientexec.enablePlugin=function(plugin,shared)
{clientexec.customizePlugins.mask();$.ajax({url:'index.php?fuse=home&action=savedashboardstate&task=add&plugin='+plugin+'&shared='+shared,success:function(xhr){clientexec.customizePlugins.addParams({shownotice:1});clientexec.customizePlugins.reload();$('.dashboardchanges').show();}});};clientexec.bindextensionicons=function(e)
{$('.plugin-moreplugins i').popover('hide');pluginname=$(this).attr('name').toString().split("-");if('plugin-'+pluginname[1]!==clientexec.pluginMgr.active_panel){clientexec.pluginMgr.setActivePlugin($(this));clientexec.pluginMgr.process({plugin:pluginname[1]});$('.tooltip').remove();var session_vars={pluginpanelPosition:"",leftbarplugins:$.trim($('.lefmenu-plugin-icons').html())};$.ajax({url:'index.php?fuse=clients&action=updatesessionvar',type:'POST',data:{fields:session_vars}});$(window).trigger('resize');}else{$('.closepluginpanel').trigger('click');clientexec.pluginMgr.active_panel="";}};clientexec.initialize_sidepanel_plugins=function()
{$(document).on("click",'.leftmenu-icon:not(".leftmenu-more-icon")',clientexec.bindextensionicons);if((clientexec.pluginData!=="")&&($('body').hasClass('withpluginpanel'))){if(($.inArray(clientexec.pluginData.plugin,clientexec.sidebarplugins.names)>-1)){clientexec.pluginMgr.active_panel='plugin-'+clientexec.pluginData.plugin;clientexec.pluginMgr.process({plugin:clientexec.pluginData.plugin,data:clientexec.pluginData});clientexec.pluginMgr.setActivePlugin($('.leftmenu-icon[name="plugin-'+clientexec.pluginData.plugin+'"]'));}else{$('.closepluginpanel').trigger('click');$.ajax({url:'index.php?fuse=home&action=savedashboardstate&task=close&plugin='+clientexec.pluginData.plugin});}}
$('.btncustomizesidebar .icon-cog').click(function(){clientexec.customizePlugins=new RichHTML.window({hideTitle:true,height:400,width:450,url:'index.php?fuse=home&view=customizedashboard',buttons:{button1:{type:'cancel',text:'Close',onclick:function(){if($('.dashboardchanges:reallyvisible').length>0){clientexec.customizePlugins.hide();RichHTML.mask();window.location.reload();}else{clientexec.customizePlugins.hide();}}}}});clientexec.customizePlugins.show();});}
$(document).ready(function(){});var ceSidebarPlugin=function(args){if(typeof(args)==="undefined"||typeof(args.pluginname)==="undefined"){alert('Error (sidebarPlugin): A plugin name is required during initiation');return;}
this.options=args;};ceSidebarPlugin.prototype.addSystemListener=function(event,method)
{clientexec.pluginMgr.addSystemListener(this.options.pluginname,event,method);};ceSidebarPlugin.prototype.setContent=function(content,skipcaching)
{if(typeof(skipcaching)==="undefined")skipcaching=false;return clientexec.pluginMgr.setContent(this.options.pluginname,content,skipcaching);};ceSidebarPlugin.prototype.setCount=function(count,style)
{clientexec.pluginMgr.setCount(this.options.pluginname,count,style);};ceSidebarPlugin.prototype.callAction=function(options){var self=this;if(options.name===null){alert('Action name required in callAction');return;}
if(typeof(options.args)=="undefined"){options.args={};}
if(typeof(options.callback)=="undefined"){options.callback=null;}
options.args.pluginaction=options.name;options.args.plugin=self.options.pluginname;$.ajax({url:'index.php?fuse=admin&controller=plugin&action=doplugin',data:options.args,dataType:'json',success:function(response){if(options.callback!==null)options.callback(response);}});};ceSidebarPlugin.prototype.cancelHeartBeat=function(name)
{heartbeat.remove('index.php?fuse=admin&controller=plugin&action=doplugin&p='+this.options.pluginname+'&i='+name);};ceSidebarPlugin.prototype.addHeartBeat=function(options)
{var self=this;var defaults={args:{},callback:null,pulse:15,delay:null};options=$.extend(true,{},defaults,options);options.args.pluginaction=options.name;options.args.plugin=self.options.pluginname;heartbeat.add({name:'index.php?fuse=admin&controller=plugin&action=doplugin&p='+self.options.pluginname+'&i='+options.name,args:options.args,delay:options.delay,pulse:options.pulse,callback:options.callback});};